<!DOCTYPE html><html><head><title>Schema</title><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><script type="text/javascript" src="/jsc/app.js"></script></head><body><article class="content"><script type="text/javascript" src="/jsc/ydn.db-dev.js"></script><div dir="ltr"><h3><a name="TOC-Native-database-schema" />Native database schema</h3>

<p>
    IndexedDB is a NoSQL database and requires no schema to pre-define. However to support query, object store must be indexed before querying. This is in fact, similar to defining query-able feed or <code>COLUMN</code> in <code>SQL TABLE</code>. For portability between IndexedDB and WebSQL, we define database schema are in JSON. Additionally the schema can be used to define relationship between stores, of which we discuss in other sections.</p>
<h4><a name="TOC-Database-schema" />Database schema</h4>
<p>
    Database schema has the following fields:
</p>
<pre>database_schema = {
    version: 1, // optional, but recommended.
    size: 5 * 1024 * 1024, // 5 MB, optional estimated database size in byte
    stores: [store_schema] // list of store schema as array
}
</pre>
<p>
Notice that the JSON format is minimal as defined in IndexedDB specification for <a href="http://www.w3.org/TR/IndexedDB/#dfn-connection" >opening database</a> and <a href="https://developer.mozilla.org/en-US/docs/IndexedDB/IDBDatabase#createObjectStore" >creating object store</a>. WebSQL also similarly defined.</p>

<h4><a name="TOC-Store-schema" />Store schema</h4>
<p>
    Store schema is defined as:
</p>
<pre>store_schema = {
    name: 'store name',
    keyPath: 'id', // optional, can also be dotted path like 'entry.id.$t'
    autoIncrement: true, // optional. use when keyPath is not specified.
    indexes: [index_schema] // optional, list of index schema as array.
}
</pre>
<p>
If <code>keyPath </code>is not defined, it will be automatically generated by the browser in IndexedDB and this wrapper will automatically generated for WebSQL.
</p>

<h4><a name="TOC-Index-schema" />Index schema</h4>
<p>
    Index schema is defined as:
</p>
<pre>index_schema = {
 name: 'field name',
 type: 'TEXT', // data type of the field, default to 'TEXT'
 unique: true
}
</pre>
<p>
It is not necessary to specify data type in IndexedDB, however WebSql <code>TABLE</code> definition requires to specify data type in
defining <code>COLUMN</code>. For IndexedDB only user, it is optional. Possible values of <code>type </code>are <code>'TEXT'</code>, <code>'REAL'</code> and <code>'INTEGER'</code>. If not specified, <code>'TEXT'</code> is assumed. Note, <code>keyPath </code>field also need to be index, if <a href="/ydn-db/using/key-range-query.html">key range query</a> is required.  </p>
<h3><a name="TOC-Schema-for-relationships" />Schema for relationships</h3>
<p>Optionally, object stores can be related by using relationships and enforced by annotating with the following keywords in the schema. See <a href="/ydn-db/using/relationships.html">relationships </a>for usage.   </p>

<table class="gridtable">
    
<thead>
    
<tr>        
  
<th>Keyword</th>
        
  
<th>Description</th>
 </tr>
</thead>
<tbody>
<tr>
  
<td><code>parent</code></td>
  
<td>parent key annotated in child store, parent-child consistency enforce</td>
</tr>
<tr>
  
<td><code>reference</code></td>
  
<td>key to refer one-to-many relationship</td>
</tr>
<tr>
  
<td><code>embedded</code></td>
  
<td>key to refer one-to-many relationship with convenient retrieval and enforce consistency </td>
</tr>
<tr>
  
<td><code>referenceList</code></td>
  
<td>key to refer many-to-many relationship</td>
</tr>
<tr>
  
<td><code>embeddedList</code></td>
  
<td>key to refer many-to-many relationship with convenient retrieval and enforce consistency </td>
</tr>
</tbody>
</table></div></article><script type="text/javascript">initDom()</script></body></html>