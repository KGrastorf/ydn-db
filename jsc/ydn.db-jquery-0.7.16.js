
                (function() {
            (function(){function aa(){return function(){}}function l(a){return function(){return this[a]}}function ba(a){return function(){return a}}var q,r=this;function ca(a){a=a.split(".");for(var b=r,c;c=a.shift();)if(null!=b[c])b=b[c];else return null;return b}
function da(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function u(a){return void 0!==a}function v(a){return"array"==da(a)}function w(a){var b=da(a);return"array"==b||"object"==b&&"number"==typeof a.length}function x(a){return"string"==typeof a}function ea(a){return"boolean"==typeof a}function y(a){return"number"==typeof a}function fa(a){return"function"==da(a)}function z(a){var b=typeof a;return"object"==b&&null!=a||"function"==b}function ga(a){return a[ha]||(a[ha]=++ia)}
var ha="closure_uid_"+(1E9*Math.random()>>>0),ia=0;function ja(a,b,c){return a.call.apply(a.bind,arguments)}function ka(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}
function la(a,b,c){la=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ja:ka;return la.apply(null,arguments)}function ma(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=Array.prototype.slice.call(arguments);b.unshift.apply(b,c);return a.apply(this,b)}}var na=Date.now||function(){return+new Date};
function A(a,b){var c=a.split("."),d=r;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)c.length||void 0===b?d=d[e]?d[e]:d[e]={}:d[e]=b}function D(a,b){function c(){}c.prototype=b.prototype;a.u=b.prototype;a.prototype=new c};function oa(a){Error.captureStackTrace?Error.captureStackTrace(this,oa):this.stack=Error().stack||"";a&&(this.message=String(a))}D(oa,Error);oa.prototype.name="CustomError";function pa(a,b){for(var c=1;c<arguments.length;c++){var d=String(arguments[c]).replace(/\$/g,"$$$$");a=a.replace(/\%s/,d)}return a}function qa(a){return/^[\s\xa0]*$/.test(a)}function ra(a,b){return a.replace(/(\r\n|\r|\n)/g,b?"<br />":"<br>")}function sa(a){if(!ua.test(a))return a;-1!=a.indexOf("&")&&(a=a.replace(va,"&amp;"));-1!=a.indexOf("<")&&(a=a.replace(wa,"&lt;"));-1!=a.indexOf(">")&&(a=a.replace(ya,"&gt;"));-1!=a.indexOf('"')&&(a=a.replace(za,"&quot;"));return a}
var va=/&/g,wa=/</g,ya=/>/g,za=/\"/g,ua=/[&<>\"]/;function Aa(a){return ra(a.replace(/  /g," &#160;"),void 0)}function Ba(a,b){for(var c=b.length,d=0;d<c;d++){var e=1==c?b:b.charAt(d);if(a.charAt(0)==e&&a.charAt(a.length-1)==e)return a.substring(1,a.length-1)}return a}var Ca={"\x00":"\\0","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\x0B":"\\x0B",'"':'\\"',"\\":"\\\\"},Da={"'":"\\'"};
function Ea(a){a=String(a);if(a.quote)return a.quote();for(var b=['"'],c=0;c<a.length;c++){var d=a.charAt(c),e=d.charCodeAt(0),f=b,g=c+1,h;if(!(h=Ca[d])){if(!(31<e&&127>e))if(d in Da)d=Da[d];else if(d in Ca)d=Da[d]=Ca[d];else{e=d;h=d.charCodeAt(0);if(31<h&&127>h)e=d;else{if(256>h){if(e="\\x",16>h||256<h)e+="0"}else e="\\u",4096>h&&(e+="0");e+=h.toString(16).toUpperCase()}d=Da[d]=e}h=d}f[g]=h}b.push('"');return b.join("")};function Fa(a,b){b.unshift(a);oa.call(this,pa.apply(null,b));b.shift()}D(Fa,oa);Fa.prototype.name="AssertionError";function Ga(a,b){throw new Fa("Failure"+(a?": "+a:""),Array.prototype.slice.call(arguments,1));};var Ha=Array.prototype,Ia=Ha.indexOf?function(a,b,c){return Ha.indexOf.call(a,b,c)}:function(a,b,c){c=null==c?0:0>c?Math.max(0,a.length+c):c;if(x(a))return x(b)&&1==b.length?a.indexOf(b,c):-1;for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},Ja=Ha.forEach?function(a,b,c){Ha.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=x(a)?a.split(""):a,f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)},Ka=Ha.map?function(a,b,c){return Ha.map.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=Array(d),f=
x(a)?a.split(""):a,g=0;g<d;g++)g in f&&(e[g]=b.call(c,f[g],g,a));return e},La=Ha.some?function(a,b,c){return Ha.some.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=x(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return!0;return!1};function Ma(a,b){var c=Pa(a,b,void 0);return 0>c?null:x(a)?a.charAt(c):a[c]}function Pa(a,b,c){for(var d=a.length,e=x(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return f;return-1}
function Qa(a){if(!v(a))for(var b=a.length-1;0<=b;b--)delete a[b];a.length=0}function Ra(a,b){var c=Ia(a,b),d;(d=0<=c)&&Ha.splice.call(a,c,1);return d}function Sa(a){var b=a.length;if(0<b){for(var c=Array(b),d=0;d<b;d++)c[d]=a[d];return c}return[]}function Ta(a,b,c){return 2>=arguments.length?Ha.slice.call(a,b):Ha.slice.call(a,b,c)}function Ua(a,b){if(!w(a)||!w(b)||a.length!=b.length)return!1;for(var c=a.length,d=Va,e=0;e<c;e++)if(!d(a[e],b[e]))return!1;return!0}function Va(a,b){return a===b};function Wa(a,b){for(var c in a)b.call(void 0,a[c],c,a)}function Xa(a,b){for(var c=w(b),d=c?b:arguments,c=c?0:1;c<d.length&&(a=a[d[c]],u(a));c++);return a}var Ya="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Za(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var f=0;f<Ya.length;f++)c=Ya[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}};var $a="StopIteration"in r?r.StopIteration:Error("StopIteration");function ab(){}ab.prototype.a=function(){throw $a;};ab.prototype.xa=function(){return this};function bb(a){if(a instanceof ab)return a;if("function"==typeof a.xa)return a.xa(!1);if(w(a)){var b=0,c=new ab;c.a=function(){for(;;){if(b>=a.length)throw $a;if(b in a)return a[b++];b++}};return c}throw Error("Not implemented");}
function cb(a,b,c){if(w(a))try{Ja(a,b,c)}catch(d){if(d!==$a)throw d;}else{a=bb(a);try{for(;;)b.call(c,a.a(),void 0,a)}catch(e){if(e!==$a)throw e;}}}function db(a){if(w(a))return Sa(a);a=bb(a);var b=[];cb(a,function(a){b.push(a)});return b};function eb(a,b){this.b={};this.a=[];var c=arguments.length;if(1<c){if(c%2)throw Error("Uneven number of arguments");for(var d=0;d<c;d+=2)fb(this,arguments[d],arguments[d+1])}else if(a){var e;if(a instanceof eb)e=a.na(),d=a.pb();else{var c=[],f=0;for(e in a)c[f++]=e;e=c;c=[];f=0;for(d in a)c[f++]=a[d];d=c}for(c=0;c<e.length;c++)fb(this,e[c],d[c])}}q=eb.prototype;q.s=0;q.qb=0;q.Pa=l("s");q.pb=function(){gb(this);for(var a=[],b=0;b<this.a.length;b++)a.push(this.b[this.a[b]]);return a};
q.na=function(){gb(this);return this.a.concat()};q.clear=function(){this.b={};this.qb=this.s=this.a.length=0};function gb(a){if(a.s!=a.a.length){for(var b=0,c=0;b<a.a.length;){var d=a.a[b];Object.prototype.hasOwnProperty.call(a.b,d)&&(a.a[c++]=d);b++}a.a.length=c}if(a.s!=a.a.length){for(var e={},c=b=0;b<a.a.length;)d=a.a[b],Object.prototype.hasOwnProperty.call(e,d)||(a.a[c++]=d,e[d]=1),b++;a.a.length=c}}
function fb(a,b,c){Object.prototype.hasOwnProperty.call(a.b,b)||(a.s++,a.a.push(b),a.qb++);a.b[b]=c}q.Na=function(){return new eb(this)};q.xa=function(a){gb(this);var b=0,c=this.a,d=this.b,e=this.qb,f=this,g=new ab;g.a=function(){for(;;){if(e!=f.qb)throw Error("The map has changed since the iterator was created");if(b>=c.length)throw $a;var g=c[b++];return a?g:d[g]}};return g};var hb,ib,jb,kb;function lb(){return r.navigator?r.navigator.userAgent:null}kb=jb=ib=hb=!1;var mb;if(mb=lb()){var nb=r.navigator;hb=0==mb.indexOf("Opera");ib=!hb&&-1!=mb.indexOf("MSIE");jb=!hb&&-1!=mb.indexOf("WebKit");kb=!hb&&!jb&&"Gecko"==nb.product}var ob=hb,pb=ib,qb=kb,rb=jb;function tb(){var a=r.document;return a?a.documentMode:void 0}var ub;
a:{var vb="",wb;if(ob&&r.opera)var xb=r.opera.version,vb="function"==typeof xb?xb():xb;else if(qb?wb=/rv\:([^\);]+)(\)|;)/:pb?wb=/MSIE\s+([^\);]+)(\)|;)/:rb&&(wb=/WebKit\/(\S+)/),wb)var yb=wb.exec(lb()),vb=yb?yb[1]:"";if(pb){var zb=tb();if(zb>parseFloat(vb)){ub=String(zb);break a}}ub=vb}var Ab={};
function Bb(a){var b;if(!(b=Ab[a])){b=0;for(var c=String(ub).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),d=String(a).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),e=Math.max(c.length,d.length),f=0;0==b&&f<e;f++){var g=c[f]||"",h=d[f]||"",k=RegExp("(\\d*)(\\D*)","g"),n=RegExp("(\\d*)(\\D*)","g");do{var m=k.exec(g)||["","",""],p=n.exec(h)||["","",""];if(0==m[0].length&&0==p[0].length)break;b=((0==m[1].length?0:parseInt(m[1],10))<(0==p[1].length?0:parseInt(p[1],10))?-1:(0==m[1].length?0:parseInt(m[1],
10))>(0==p[1].length?0:parseInt(p[1],10))?1:0)||((0==m[2].length)<(0==p[2].length)?-1:(0==m[2].length)>(0==p[2].length)?1:0)||(m[2]<p[2]?-1:m[2]>p[2]?1:0)}while(0==b)}b=Ab[a]=0<=b}return b}var Cb=r.document,Db=Cb&&pb?tb()||("CSS1Compat"==Cb.compatMode?parseInt(ub,10):5):void 0;function Eb(a){return Fb(a||arguments.callee.caller,[])}
function Fb(a,b){var c=[];if(0<=Ia(b,a))c.push("[...circular reference...]");else if(a&&50>b.length){c.push(Gb(a)+"(");for(var d=a.arguments,e=0;e<d.length;e++){0<e&&c.push(", ");var f;f=d[e];switch(typeof f){case "object":f=f?"object":"null";break;case "string":break;case "number":f=String(f);break;case "boolean":f=f?"true":"false";break;case "function":f=(f=Gb(f))?f:"[fn]";break;default:f=typeof f}40<f.length&&(f=f.substr(0,40)+"...");c.push(f)}b.push(a);c.push(")\n");try{c.push(Fb(a.caller,b))}catch(g){c.push("[exception trying to get caller]\n")}}else a?
c.push("[...long stack...]"):c.push("[end]");return c.join("")}function Gb(a){if(Hb[a])return Hb[a];a=String(a);if(!Hb[a]){var b=/function ([^\(]+)/.exec(a);Hb[a]=b?b[1]:"[Anonymous]"}return Hb[a]}var Hb={};function Kb(a,b,c,d,e){"number"==typeof e||Lb++;this.g=d||na();this.e=a;this.d=b;this.c=c;delete this.b;delete this.a}Kb.prototype.b=null;Kb.prototype.a=null;var Lb=0;function Mb(a){this.e=a}Mb.prototype.c=null;Mb.prototype.b=null;Mb.prototype.d=null;Mb.prototype.a=null;function Nb(a,b){this.name=a;this.value=b}Nb.prototype.toString=l("name");var Ob=new Nb("SHOUT",1200),Pb=new Nb("SEVERE",1E3),Qb=new Nb("WARNING",900),Rb=new Nb("INFO",800),Sb=new Nb("CONFIG",700),Tb=new Nb("FINE",500),Ub=new Nb("FINER",400),Vb=new Nb("FINEST",300),Wb=[new Nb("OFF",Infinity),Ob,Pb,Qb,Rb,Sb,Tb,Ub,Vb,new Nb("ALL",0)],Xb=null;Mb.prototype.getName=l("e");
function Yb(a){if(a.b)return a.b;if(a.c)return Yb(a.c);Ga("Root logger has no level set.");return null}Mb.prototype.log=function(a,b,c){if(a.value>=Yb(this).value)for(a=this.g(a,b,c),b="log:"+a.d,r.console&&(r.console.timeStamp?r.console.timeStamp(b):r.console.markTimeline&&r.console.markTimeline(b)),r.msWriteProfilerMark&&r.msWriteProfilerMark(b),b=this;b;){c=b;var d=a;if(c.a)for(var e=0,f=void 0;f=c.a[e];e++)f(d);b=b.c}};
Mb.prototype.g=function(a,b,c){var d=new Kb(a,String(b),this.e);if(c){d.b=c;var e;var f=arguments.callee.caller;try{var g;var h=ca("window.location.href");if(x(c))g={message:c,name:"Unknown error",lineNumber:"Not available",fileName:h,stack:"Not available"};else{var k,n,m=!1;try{k=c.lineNumber||c.qd||"Not available"}catch(p){k="Not available",m=!0}try{n=c.fileName||c.filename||c.sourceURL||r.$googDebugFname||h}catch(t){n="Not available",m=!0}g=!m&&c.lineNumber&&c.fileName&&c.stack?c:{message:c.message,
name:c.name,lineNumber:k,fileName:n,stack:c.stack||"Not available"}}e="Message: "+sa(g.message)+'\nUrl: <a href="view-source:'+g.fileName+'" target="_new">'+g.fileName+"</a>\nLine: "+g.lineNumber+"\n\nBrowser stack:\n"+sa(g.stack+"-> ")+"[end]\n\nJS stack traversal:\n"+sa(Eb(f)+"-> ")}catch(s){e="Exception trying to expose exception! You win, we lose. "+s}d.a=e}return d};function Zb(a,b){a.log(Pb,b,void 0)}function E(a,b){a.log(Qb,b,void 0)}function $b(a,b){a.log(Tb,b,void 0)}
function F(a,b){a.log(Ub,b,void 0)}function G(a,b){a.log(Vb,b,void 0)}var ac={},bc=null;function cc(){bc||(bc=new Mb(""),ac[""]=bc,bc.b=Sb)}function dc(){cc();return bc}function H(a){cc();var b;if(!(b=ac[a])){b=new Mb(a);var c=a.lastIndexOf("."),d=a.substr(c+1),c=H(a.substr(0,c));c.d||(c.d={});c.d[d]=b;b.c=c;ac[a]=b}return b};function ec(a){return function(){throw a;}};/*
 Portions of this code are from MochiKit, received by
 The Closure Authors under the MIT license. All other code is Copyright
 2005-2009 The Closure Authors. All Rights Reserved.
*/
function I(a,b){this.c=[];this.oa=b||null;this.d=null;if(Error.captureStackTrace){var c={stack:""};Error.captureStackTrace(c,I);"string"==typeof c.stack&&(this.d=c.stack.replace(/^[^\n]*\n/,""))}}q=I.prototype;q.Oa=!1;q.Qa=!1;q.Mb=!1;q.Jc=!1;q.wc=!1;q.Kc=0;q.lc=function(a,b){this.Mb=!1;fc(this,a,b)};function fc(a,b,c){a.Oa=!0;a.g=c;a.Qa=!b;gc(a)}function hc(a){if(a.Oa){if(!a.wc)throw new ic;a.wc=!1}}q.v=function(a){hc(this);fc(this,!0,a)};q.t=function(a){hc(this);jc(this,a);fc(this,!1,a)};
function jc(a,b){a.d&&(z(b)&&b.stack&&/^[^\n]+(\n   [^\n]+)+/.test(b.stack))&&(b.stack=b.stack+"\nDEFERRED OPERATION:\n"+a.d)}q.da=function(a,b){return this.ea(a,null,b)};q.jc=function(a,b){return this.ea(null,a,b)};q.Ic=function(a,b){return this.ea(a,a,b)};q.ea=function(a,b,c){this.c.push([a,b,c]);this.Oa&&gc(this);return this};function kc(a){return La(a.c,function(a){return fa(a[1])})}
function gc(a){a.h&&(a.Oa&&kc(a))&&(r.clearTimeout(a.h),delete a.h);a.i&&(a.i.Kc--,delete a.i);for(var b=a.g,c=!1,d=!1;a.c.length&&!a.Mb;){var e=a.c.shift(),f=e[0],g=e[1],e=e[2];if(f=a.Qa?g:f)try{var h=f.call(e||a.oa,b);u(h)&&(a.Qa=a.Qa&&(h==b||h instanceof Error),a.g=b=h);b instanceof I&&(d=!0,a.Mb=!0)}catch(k){b=k,a.Qa=!0,jc(a,b),kc(a)||(c=!0)}}a.g=b;d&&(b.ea(la(a.lc,a,!0),la(a.lc,a,!1)),b.Jc=!0);c&&(a.h=r.setTimeout(ec(b),0))}function ic(){oa.call(this)}D(ic,oa);ic.prototype.message="Deferred has already fired";
ic.prototype.name="AlreadyCalledError";var lc={READ_ONLY:"readonly",READ_WRITE:"readwrite",VERSION_CHANGE:"versionchange"},mc=r.IDBRequest&&"LOADING"in r.IDBRequest?r.IDBTransaction:r.webkitIDBRequest&&"LOADING"in r.webkitIDBRequest&&1===r.webkitIDBTransaction.READ_WRITE?r.webkitIDBTransaction:lc,J=mc.READ_ONLY,K=mc.READ_WRITE,nc=mc.VERSION_CHANGE;function oc(a,b){return a?b?"prevunique":"prev":b?"nextunique":"next"}var pc=r.indexedDB||r.mozIndexedDB||r.webkitIndexedDB||r.moz_indexedDB||r.msIndexedDB;function qc(a,b){var c,d;2==arguments.length&&x(arguments[1])?(c=!0,d=arguments[1].split(".")):d=(c=w(b))?b:arguments;for(c=c?0:1;c<d.length&&(a=a[d[c]],u(a));c++);return a}var rc={};
function sc(a){var b=[a];a=new tc;for(var c=0,d,e;void 0!==(e=b.pop());){0===c%4&&12<c+4&&(a.write(c),c=0);d=typeof e;if(e instanceof Array)if(c+=4,0<e.length){b.push(rc);for(d=e.length;d--;)b.push(e[d]);continue}else a.write(c);else if("number"===d)c+=1,a.write(c),uc(a,e);else if(e instanceof Date)c+=2,a.write(c),uc(a,e.valueOf());else if("string"===d){c+=3;a.write(c);c=a;for(d=0;d<e.length;d++){var f=e.charCodeAt(d);126>=f?c.write(f+1):16510>=f?(f-=127,c.write(128|f>>8,f&255)):c.write(192|f>>10,
f>>2|255,(f|3)<<6)}c.write(0)}else if(e===rc)a.write(0);else return"";c=0}for(b=a.a.length;"00"===a.a[--b];);a.a.length=++b;return a.toString()}function vc(a){for(var b=[],c=b,d=[],e,f,g=new wc(a);null!=xc(g);)if(0===g.a)c=d.pop();else{if(null===g.a)break;do{e=g.a/4|0;a=g.a%4;for(var h=0;h<e;h++)f=[],c.push(f),d.push(c),c=f;if(0===a&&12<g.a+4)xc(g);else break}while(1);1===a?c.push(yc(g)):2===a?c.push(new Date(yc(g))):3===a?c.push(zc(g)):0===a&&(c=d.pop())}return b[0]}
function uc(a,b){var c,d,e;c=b;var f=e=d=0;if(0!==c)if(isFinite(c)){0>c&&(d=1,c=-c);f=0;if(2.2250738585072014E-308<=c){for(e=c;1>e;)f--,e*=2;for(;2<=e;)f++,e/=2;e=f+1023}f=e?Math.floor(4503599627370496*(c/Math.pow(2,f)-1)):Math.floor(c/4.9E-324)}else e=2047,isNaN(c)?f=0x8000000000000:-Infinity===c&&(d=1);c=d;d=e;e=f;c&&(e=0xfffffffffffff-e,d=2047-d);a.write((c?0:128)|d>>4);a.write((d&15)<<4|0|e/281474976710656);e%=281474976710656;c=0|e/4294967296;a.write(c>>8,c&255);e%=4294967296;c=0|e/65536;a.write(c>>
8,c&255);c=e%65536;a.write(c>>8,c&255)}function yc(a){var b=xc(a)|0,c=b>>7?!1:!0,d=c?-1:1,e=(b&127)<<4,b=xc(a)|0,e=e+(b>>4);c&&(e=2047-e);for(var b=[c?15-(b&15):b&15],f=6;f--;)b.push(c?255-(xc(a)|0):xc(a)|0);a=0;for(f=7;f--;)a=a/256+b[f];a/=16;return 0===a&&0===e?0:(a+1)*Math.pow(2,e-1023)*d}
function zc(a){for(var b=[],c=0,d=0,e=0,f,g;;){f=xc(a);if(0===f||null==f)break;0===c?(g=f>>6,2>g&&!isNaN(f)?b.push(String.fromCharCode(f-1)):(c=g,d=f<<10,e++)):2===c?(b.push(String.fromCharCode(d+f+127)),c=d=e=0):2===e?(d+=f<<2,e++):(b.push(String.fromCharCode(d|f>>6)),c=d=e=0)}return b.join("")}function wc(a){this.a=null;this.b=a;this.c=this.b.length-1;this.index=-1}function xc(a){return a.a=a.index<a.c?parseInt(a.b[++a.index]+a.b[++a.index],16):null}function tc(){this.a=[];this.b=void 0}
tc.prototype.write=function(a){for(var b=0;b<arguments.length;b++)this.b=arguments[b].toString(16),this.a.push(2===this.b.length?this.b:this.b="0"+this.b)};tc.prototype.toString=function(){return this.a.length?this.a.join(""):""};function Ac(a,b){var c=sc(a),d=sc(b);return c>d?1:c==d?0:-1};var L=pc&&pc.cmp?la(pc.cmp,pc):Ac;function M(a){oa.call(this,a);this.name="ydn.error.ArgumentException"}D(M,oa);function Bc(a){oa.call(this,a);this.name="ydn.error.NotSupportedException"}D(Bc,oa);function Cc(a){oa.call(this,a);this.name="ydn.error.NotImplementedException"}D(Cc,oa);function Dc(a){oa.call(this,a);this.name="ydn.error.InvalidOperationException"}D(Dc,oa);
function Ec(a){Error.captureStackTrace?Error.captureStackTrace(this,Ec):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.InternalError"}D(Ec,Error);Ec.prototype.name="ydn.error.InternalError";function Fc(a){Error.captureStackTrace?Error.captureStackTrace(this,Gc):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.ConstraintError"}D(Fc,Error);Fc.prototype.name="ydn.error.ConstraintError";function Hc(a,b,c,d){this.a=a;this.b=[];this.c=[];this.g=[];this.s=0;this.Ob=this.N=!1;b&&(this.b=Sa(b.b),this.c=Sa(b.c));null!=c&&(this.b[0]=c);null!=d&&(this.c[0]=d);this.d=function(){throw new Ec;};this.e=function(){throw new Ec;};0<this.a.length&&Ic(this)}q=Hc.prototype;q.s=0;q.N=!1;q.Ob=!1;q.U=H("ydn.db.Cursor");
function Jc(a,b){b.J=function(c,e,f){null==c&&(G(a.U,"cursor "+b+" finished."),a.N=!0);a.b[0]=c;a.c[0]=e;a.g[0]=f;a.s++;a.N?(G(a.U,a+" DONE."),a.d(),Kc(a)):(G(a.U,a+" new cursor position {"+(null!=a.c[0]?a.b[0]+", "+a.c[0]:a.b[0])+"}"),a.d(a.b[0]))};b.cb=function(b){a.e(b);Kc(a);a.N=!0};var c=null!=a.c[0]?", "+a.c[0]:"",c=null!=a.b[0]?" resume from {"+a.b[0]+c+"}":"";G(a.U,b+c+" opening");b.Ja(a.b[0],a.c[0])}
function Lc(a){function b(b){var f=a.a[b];f.J=function(k,m,p){d++;null==k&&(G(a.U,"cursor "+f+" finished."),a.N=!0);a.b[b]=k;a.c[b]=m;a.g[b]=p;e[b]=f.b?m:k;if(d==c){d=0;if(a.N)a.s++,G(a.U,a+" DONE."),a.d(),Kc(a);else if(k=e.reduce(function(a,b){return null===a?b:1==L(b,a)?b:a},null),0==L(k,e[0]))G(a.U,a+" new cursor position {"+(null!=a.c[0]?a.b[0]+", "+a.c[0]:a.b[0])+"}"),a.d(a.b[0]);else for(m=0;m<c;m++)-1==L(e[m],k)?(p=a.a[m],p.b?p.eb(k):p.va(k)):d++;Qa(e)}};f.cb=function(b){a.e(b);Kc(a);a.N=!0;
d=0};var k=null!=a.c[b]?", "+a.c[b]:"",k=null!=a.b[b]?" resume from {"+a.b[b]+k+"}":"";G(a.U,f+k+" opening");f.Ja(a.b[b],a.c[b])}for(var c=a.a.length,d=0,e=[],f=0;f<c;f++)b(f)}function Ic(a){var b=a.a.length;if(1==b)Jc(a,a.a[0]);else if(1<b)Lc(a);else throw new Ec("no cursors");}q.Pa=l("s");q.zc=function(a){return this.b[a||0]};q.T=function(a){a=a||0;return this.a[a].b?this.c[a]:this.b[a]};q.ja=function(a){a=a||0;return this.a[a].Sa?this.T(a):this.g[a]};q.advance=function(a){for(var b=0;b<this.a.length;b++)this.a[b].advance(a)};
q.update=function(a,b){return this.a[b||0].update(a)};q.clear=function(a){return this.a[a||0].clear()};function Mc(a){a.Ob=!0;G(a.U,a+": exit");Kc(a);for(var b=0;b<a.a.length;b++)a.a[b].oa();G(a.U,a+" disposed");Qa(a.g);Qa(a.a)}function Kc(a){a.c=Ka(a.c,function(a){if(null!=a)return Nc(a)});a.b=Ka(a.b,function(a){if(null!=a)return Nc(a)})}
q.toString=function(){for(var a="[",b=0;b<this.b.length;b++)0<b&&(a+=" "),this.a[b]?a+=this.a[b].toString():(a+="cursor~{"+this.b[b],a=null!=this.c[b]?a+(";"+this.c[b]+"}"):a+"}");return"Cursor "+(a+"]")};function N(a,b,c,d){this.lower=a;this.upper=b;this.lowerOpen=!!c;this.upperOpen=!!d;fa(Object.freeze)&&Object.freeze(this)}N.prototype.lower=void 0;N.prototype.upper=void 0;N.prototype.toJSON=function(){return Oc(this)};N.only=function(a){return new N(a,a,!1,!1)};N.bound=function(a,b,c,d){return new N(a,b,c,d)};N.upperBound=function(a,b){return new N(void 0,a,void 0,!!b)};N.lowerBound=function(a,b){return new N(a,void 0,!!b,void 0)};
function Pc(a){var b;if(v(a))b=Sa(a),b.push("\uffff");else if(x(a))b=a+"\uffff";else throw new M;return N.bound(a,b,!1,!0)}function Oc(a){a=a||{};return{lower:a.lower,upper:a.upper,lowerOpen:a.lowerOpen,upperOpen:a.upperOpen}}function Qc(a){return null!=a?null!=a.upper&&null!=a.lower?Rc.bound(a.lower,a.upper,!!a.lowerOpen,!!a.upperOpen):null!=a.upper?Rc.upperBound(a.upper,a.upperOpen):null!=a.lower?Rc.lowerBound(a.lower,a.lowerOpen):null:null}
function Sc(a){if(a instanceof N)return"";if(null!=a){if(z(a)){for(var b in a)if(a.hasOwnProperty(b)&&!(0<=Ia(["lower","upper","lowerOpen","upperOpen"],b)))return'invalid attribute "'+b+'" in key range object';return""}return"key range must be an object"}return""}
N.prototype.Lb=function(a){var b=this.lower,c=this.upper,d=this.lowerOpen,e=this.upperOpen;null!=a.lower&&(null==this.lower||a.lower>=this.lower)&&(b=a.lower,d=a.lowerOpen||this.lowerOpen);null!=a.upper&&(null==this.upper||a.upper<=this.upper)&&(c=a.upper,e=a.upperOpen||this.upperOpen);return N.bound(b,c,d,e)};function Tc(a){if(!a)return"";var b=a.lowerOpen?" (":" [";null!=a.lower&&(b+=a.lower+", ");null!=a.upper&&(b+=a.upper);return b+=a.upperOpen?")":"]"}
function Uc(a,b,c,d,e){if(c)if(c.lowerOpen||c.upperOpen||null==c.lower||null==c.upper||0!==L(c.lower,c.upper)){if(null!=c.lower){var f=c.lowerOpen?" > ":" >= ";d.push(a+f+"?");e.push(Vc(c.lower,b))}null!=c.upper&&(f=c.upperOpen?" < ":" <= ",d.push(a+f+"?"),e.push(Vc(c.upper,b)))}else d.push(a+" = ?"),e.push(Vc(c.lower,b))}
function Wc(a,b,c,d){var e,f,g,h;if("^"==a)return Pc(b);if("<"==a||"<="==a)e=b,g="<"==a;else if(">"==a||">="==a)f=b,h=">"==a;else if("="==a||"=="==a)e=f=b;else throw new M("invalid op: "+a);if("<"==c||"<="==c)e=d,g="<"==c;else if(">"==c||">="==c)f=d,h=">"==c;else if(u(c))throw new M("invalid op2: "+c);return N.bound(f,e,h,g)}var Rc=r.IDBKeyRange||r.webkitIDBKeyRange||N;function Xc(a,b,c,d,e){if(!(b instanceof N))if(x(b)&&u(c))b=Wc(b,c,d,e);else if(null!=b){if(!(b instanceof N))if(z(b))b=new N(b.lower,b.upper,b.lowerOpen,b.upperOpen);else throw new M("Invalid key range: "+b+" of type "+typeof b);}else b=null;this.a=b;this.sa=a}Xc.prototype.sa="";Xc.prototype.Lb=function(a){if(this.sa!=a.sa)return null;a=null!=this.a&&null!=a.a?this.a.Lb(a.a):this.a||a.a;return new Xc(this.sa,a)};function O(a,b,c,d,e,f,g){if(!x(a))throw new TypeError("store name");this.M=a;this.e=b;this.h=g;this.d=!!this.e;this.b=u(f)?f:!!x(this.e);if(!ea(this.b))throw new TypeError("key_only");if(u(d)&&!ea(d))throw new TypeError("reverse");if(u(e)&&!ea(e))throw new TypeError("unique");a="next";d&&e?a="prevunique":d?a="prev":e&&(a="nextunique");this.g=a;if(d=Sc(c))throw new M("Invalid key range: "+d);this.a=Qc(c);this.c=null}O.prototype.b=!0;
function Yc(a,b,c){if(3<arguments.length)throw new M("too many argument");O.call(this,a,void 0,b,c,void 0,!0)}D(Yc,O);function Zc(a,b,c,d,e){if(!x(b))throw new M("index name must be string");O.call(this,a,b,c,d,e,!0)}D(Zc,O);function $c(a,b,c){if(3<arguments.length)throw new M("too many argument");O.call(this,a,void 0,b,c,void 0,!1)}D($c,O);function ad(a,b,c,d,e){if(!x(b))throw new M("index name must be string");O.call(this,a,b,c,d,e,!1)}D(ad,O);q=O.prototype;
q.nc=function(){return this.c?this.c.N?"done":this.c.Ob?"rest":"busy":"init"};q.ed=H("ydn.db.Iterator");q.cd=l("M");q.W=l("e");q.Qc=l("a");q.ad=function(){return this.a?this.a instanceof Rc?this.a:Rc.bound(this.a.lower,this.a.upper,this.a.lowerOpen,this.a.upperOpen):null};q.dd=l("b");q.Pc=l("d");q.toJSON=function(){return{store:this.M,index:this.e,keyRange:this.a?Oc(this.a):null,direction:this.g}};
q.toString=function(){var a=u(this.h)?":"+this.h.join(","):u(this.e)?":"+this.e:"",a=a+Tc(this.a),b=this.d?"Index":"",b=b+(this.b?"Key":"Value");return b+"Iterator:"+this.M+a};q.$c=function(){return this.c?this.c.zc():void 0};q.bd=function(){return this.c?this.c.T():void 0};q.Vc=function(a,b){var c=new O(this.M,this.e,this.a,this.zb(),this.Wa(),this.b,this.h);c.c=new Hc([],null,a,b);return c};
q.gd=function(a,b){var c=new O(this.M,this.e,this.a,!this.zb(),this.Wa(),this.b,this.h);null!=a&&(c.c=new Hc([],null,a,b));return c};q.count=function(){return this.c?this.c.Pa():NaN};q.stores=function(){var a=[this.M];if(this.i)for(var b=0;b<this.i.length;b++)0<=Ia(a,this.i[b].a)||a.push(this.i[b].a);return a};q.zb=function(){return"prev"===this.g||"prevunique"===this.g};q.Wa=function(){return"nextunique"===this.g||"prevunique"===this.g};
q.$=function(a,b){var c;c=[b];c=this.a?new N(null!=this.a.lower?c.concat(this.a.lower):c,null!=this.a.upper?c.concat(this.a.upper):c,!!this.a.lowerOpen,!!this.a.upperOpen):this.d?Pc(c):N.only(b);var d,e;this.h?e=[a].concat(this.h):this.d?e=[a].concat(this.e):d=a;return new O(this.M,d,c,this.zb(),this.Wa(),this.b,e)};
function bd(a,b,c,d,e){var f=e||cd;e=[d.ob(b,c,a.M,a.h||a.e,a.a,a.g,a.b,f)];for(var g=0,h=a.i?a.i.length:0;g<h;g++){var k=a.i[g];if(k.b&&null!=k.value){var n;n=a.d?Qc(Pc([k.value])):Rc.only(k.value);k=d.ob(b,c,k.a,k.b,n,a.g,a.b,f);e.push(k)}}b="";a.c&&(b=" by resuming "+a.c);a.c=new Hc(e,a.c);G(a.ed,c+" "+a+" created "+a.c+b);return a.c}q.fd=function(){if("busy"==this.nc())throw new dd("busy");this.c=null};function ed(a){Error.captureStackTrace?Error.captureStackTrace(this,ed):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ConstraintError"}D(ed,Error);ed.prototype.name="ConstraintError";function fd(a){Error.captureStackTrace?Error.captureStackTrace(this,fd):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.db.InvalidKeyException"}D(fd,Error);
function gd(a){Error.captureStackTrace?Error.captureStackTrace(this,gd):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.db.VersionError"}D(gd,Error);gd.prototype.name="ydn.db.VersionError";function hd(a){Error.captureStackTrace?Error.captureStackTrace(this,hd):this.stack=Error().stack||"";a&&(this.message=String(a))}D(hd,Error);hd.prototype.name="ydn.db.InternalError";
function id(a){Error.captureStackTrace?Error.captureStackTrace(this,id):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="InvalidStateError"}D(id,Error);function jd(a){Error.captureStackTrace?Error.captureStackTrace(this,jd):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="InvalidAccessError"}D(jd,Error);function kd(a){Error.captureStackTrace?Error.captureStackTrace(this,kd):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="NotFoundError"}
D(kd,Error);kd.prototype.name="NotFoundError";function ld(a,b){Error.captureStackTrace?Error.captureStackTrace(this,ld):this.stack=Error().stack||"";b&&(this.message=String(b));this.message+=" :"+a.message+" ["+a.code+"]";this.name="SQLError"}D(ld,Error);function md(a,b){Error.captureStackTrace?Error.captureStackTrace(this,md):this.stack=Error().stack||"";b&&(this.message=String(b));this.message+=" :"+a.message;this.name="SecurityError"}D(md,Error);
function nd(a){Error.captureStackTrace?Error.captureStackTrace(this,nd):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.db.SqlParseError"}D(nd,Error);function od(a){Error.captureStackTrace?Error.captureStackTrace(this,od):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.db.TimeoutError"}D(od,Error);function pd(a,b,c){var d;if(z(a))d=a.store,b=a.id,null!=a.parent&&(c=new pd(a.parent));else if(u(b))d=a;else if(d=a.lastIndexOf("^|"),b=a,0<d&&(b=a.substr(d),c=new pd(a.substring(0,d))),b=b.split("^:"),d=b[0],b=b[1],!u(b))throw Error("Invalid key value: "+a);this.a=d;this.id=b;this.parent=c||null}q=pd.prototype;q.toJSON=function(){var a={store:this.a,id:this.id};this.parent&&(a.parent=this.parent.toJSON());return a};
q.valueOf=function(){return(this.parent?this.parent.valueOf()+"^|":"")+this.a+"^:"+this.id};q.toString=function(){return this.valueOf().replace("^|","|").replace("^:",":")};q.jd=l("a");q.Mc=l("id");q.hd=l("parent");function Nc(a){if(w(a)){for(var b=[],c=0,d=a.length;c<d;c++)b[c]=a[c];return b}return a};function qd(a,b){this.ma=a;this.a=b}qd.prototype.f=H("ydn.db.crud.req.RequestExecutor");qd.prototype.ma="";qd.prototype.toString=ba("RequestExecutor");qd.prototype.W=function(a,b){var c;if(v(b))a:{for(c=0;c<a.indexes.length;c++)if(!rd(a.indexes[c].keyPath,b)){c=a.indexes[c];break a}c=null}else c=sd(a,b);return c.getName()};A("ydn.db.con.IStorage.prototype.transaction",aa().prototype.ua);function td(a,b,c,d){if("transaction"in a)this.i=a,this.e=this.h=null;else if("objectStore"in a){if(this.i=null,this.h=a.db,this.e=a,!this.e.db.objectStoreNames.contains(b))throw new ud('store "'+b+'" not in transaction.');}else throw new ud("storage instance require.");this.w=b;this.O=c;this.oa=d;this.d=[];this.b=0;this.g=!1}td.prototype.a=H("ydn.db.con.IdbCursorStream");td.prototype.g=!1;td.prototype.d=[];
function wd(a,b){a.b++;b.onsuccess=function(b){if(b=b.target.result){if(fa(a.oa)){var d=b.value;a.oa(b.primaryKey,null!=a.O?d[a.O]:d)}else E(a.a,"sink gone, dropping value for: "+b.primaryKey);if(b&&0<a.d.length)b["continue"](a.d.shift());else a.b--,0==a.b&&a.ga&&a.ga()}};b.onerror=function(){E(a.a,"seeking fail. "+("error"in b?b.error.name+":"+b.error.message:""));a.b--;0==a.b&&a.ga&&a.ga()}}function xd(a,b){0==a.d.length&&0==a.b?b():a.ga=b}
function yd(a){if(!a.g){var b=function(b,c){a.e=null;"complete"!==b&&E(a.a,c.name+":"+c.message);G(a.a,a+" transaction "+b)},c=function(b){var c=a.d.shift();G(a.a,a+" transaction started for "+c);b=b.objectStore(a.w);wd(a,b.openCursor(c))};if(a.e)G(a.a,a+" using existing tx."),c(a.e);else if(a.h)G(a.a,a+" creating tx from IDBDatabase."),a.c=a.h.transaction([a.w],J),a.c.oncomplete=function(a){b("complete",a)},a.c.onerror=function(a){b("error",a)},a.c.onabort=function(a){b("abort",a)};else if(a.i)G(a.a,
a+" creating tx from ydn.db.con.IStorage."),a.g=!0,a.i.ua(function(b){a.g=!1;c(b)},[a.w],J,b);else throw new zd("no way to create a transaction provided.");}};function Ad(a,b,c){if(a&&a instanceof P)this.$a=a,this.ka=null;else if(a&&a.db)if(this.$a=null,a.db)this.ka=new td(a,this.a,this.Ha,la(this.ga,this));else throw new M("Invalid IndexedDB Transaction.");else throw new M("ydn.db.Streamer: First argument requires storage or transaction instance required.");if(!x(b))throw new M("a store name required.");this.a=b;if(u(c)&&!x(c))throw new M("index name must be a string.");this.Ha=c;this.ka=null;this.ba=[];this.qa=[];this.Ra=!1}q=Ad.prototype;q.$a=null;
q.j=null;q.gc=null;q.qa=[];q.ba=[];q.ka=null;q.Zc=function(a){this.gc=a};function Bd(a){var b=0<a.ba.length;if(b&&!a.Ra&&fa(a.gc)){var c=function(){Bd(a)},d=a.qa.shift(),e=a.ba.shift(),b=0<a.ba.length,c=a.gc(d,e,b?c:null);b&&!c&&Bd(a)}}q.Ra=!1;q.fa=function(a){if(this.ka){this.Ra=!0;var b=this;xd(this.ka,function(){a(b.qa,b.ba);b.qa=[];b.ba=[];b.Ra=!1})}else a(this.qa,this.ba),this.qa=[],this.ba=[]};q.ga=function(a,b){this.qa.push(a);this.ba.push(b);Bd(this)};
q.push=function(a,b){if(this.Ra)throw new dd("push not allowed after a collection is started");if(2<=arguments.length)this.ga(a,b);else{if(!this.ka){if(!this.$a)throw new dd("Database is not setup.");var c=this.$a.i();if(c)if("indexeddb"===c)this.ka=new td(this.$a,this.a,this.Ha,la(this.ga,this));else throw new Cd(c);else throw new dd("Database is not connected.");}c=this.ka;c.d.push(a);yd(c)}};q.W=l("Ha");q.toString=function(){return"Streamer:"+this.a+(this.Ha||"")};function Dd(){0!=Ed&&(Fd[ga(this)]=this)}var Ed=0,Fd={};Dd.prototype.oc=!1;Dd.prototype.oa=function(){if(!this.oc&&(this.oc=!0,this.Ba(),0!=Ed)){var a=ga(this);delete Fd[a]}};Dd.prototype.Ba=function(){if(this.qc)for(;this.qc.length;)this.qc.shift()()};function Gd(a,b,c,d,e,f,g,h){Dd.call(this);this.Eb=c;this.g=d;this.b=x(this.g);this.n=e||null;this.c=a;this.O=b;this.o="prev"==f||"prevunique"==f;this.unique="nextunique"==f||"prevunique"==f;this.V=f;this.Sa=g;this.h=h}D(Gd,Dd);q=Gd.prototype;q.Eb="";q.V="";q.n=null;q.unique=!1;q.o=!1;q.Sa=!0;q.cb=function(){throw new Ec;};q.J=function(){throw new Ec;};q.Ba=function(){this.c=null};q.toString=function(){return"Cursor:"+this.Eb+(u(this.g)?":"+this.g:"")+"["+(this.c?"":"~")+this.O+"]"};function Hd(a,b){if(null!=a&&!("push"in a))throw new ud;this.a=a||null;this.g=b;this.e=0}Hd.prototype.h=H("ydn.db.algo.AbstractSolver");Hd.prototype.a=null;Hd.prototype.b=function(a){if(!v(a))throw new TypeError("iterators must be array");if(2>a.length)throw new RangeError("ZigzagMerge require at least 2 iterators, but  only "+a.length+" found.");for(var b=0;b<a.length;b++)if(!(a[b]instanceof O))throw new TypeError("item at iterators "+b+" is not an iterator.");return!1};
function Id(a,b,c){var d,e=null!=d;if(!u(d)){d=c[0];for(var e=null!=d,f=1;e&&f<c.length;f++)null!=c[f]&&0==L(c[f],d)||(e=!1)}return e&&(a.e++,a.a&&a.a.push(d),u(a.g)&&a.e>=a.g)?[]:b}Hd.prototype.c=function(){return[]};function Jd(a,b,c,d,e,f,g,h){Gd.call(this,a,b,c,d,e,f,g,h);this.A=null}D(Jd,Gd);q=Jd.prototype;q.Dc=H("ydn.db.core.req.IDBCursor");q.kb=function(a){(a=a.target.result)?this.J(a.key,this.b?a.primaryKey:void 0,a.value):this.J()};q.A=null;
q.Ja=function(a,b){function c(a,b,c){h.A=g;h.J(a,h.b?b:void 0,c);h.A&&(h.A.onsuccess=la(h.kb,h));g=null}var d=this+" opening ";null!=a&&(d+="{"+a,d=null!=b?d+(";"+b+"}"):d+"}");G(this.Dc,d);var d=this.n,e=this.c.objectStore(this.Eb),f=x(this.g)?e.index(this.g):null,g;g=this.Sa?f?null!=this.V?f.openKeyCursor(d,this.V):null!=d?f.openKeyCursor(d):f.openKeyCursor():null!=this.V?e.openCursor(d,this.V):null!=d?e.openCursor(d):e.openCursor():f?null!=this.V?f.openCursor(d,this.V):null!=d?f.openCursor(d):
f.openCursor():null!=this.V?e.openCursor(d,this.V):null!=d?e.openCursor(d):e.openCursor();var h=this;g.onerror=function(a){var b=g.error;a.preventDefault();h.cb(b)};null!=a?g.onsuccess=function(d){if(d=d.target.result){var e=pc.cmp(d.key,a),f=h.o?-1:1;if(e==f)c(d.key,d.primaryKey,d.value);else if(e==-f)d["continue"](a);else if(null!=b)if(pc.cmp(d.primaryKey,b)==f)c(d.key,d.primaryKey,d.value);else d["continue"]();else d["continue"]()}else c()}:(h.A=g,h.A.onsuccess=la(h.kb,h))};q.rb=function(){return!!this.A};
q.update=function(a){var b=this.A.result;if(b){var c=new I;a=b.update(a);a.onsuccess=function(a){c.v(a.target.result)};a.onerror=function(a){a.preventDefault();c.t(a)};return c}throw new jd("cursor gone");};q.clear=function(){var a=this.A.result;if(a){var b=new I,a=a["delete"]();a.onsuccess=function(){b.v(1)};a.onerror=function(a){a.preventDefault();b.t(a)};return b}throw new jd("cursor gone");};q.fb=function(a,b){G(this.Dc,this+" restarting.");this.Ja(b,a)};
q.advance=function(a){var b=this.A.result;if(1==a)b["continue"]();else b.advance(a)};
q.eb=function(a){var b=this.A.result,c=pc.cmp(a,b.primaryKey);if(1!=c)throw new Ec('continuing primary key "'+a+'" must higher than current primary key "'+b.primaryKey+'"');var d=this;this.A.onsuccess=function(e){if(b=e.target.result)if(c=pc.cmp(b.primaryKey,a),0==c||1==c&&!d.o||-1==c&&d.o)d.A.onsuccess=la(d.kb,d),d.J(b.key,d.b?b.primaryKey:void 0,b.value);else b["continue"]();else d.A.onsuccess=la(d.kb,d),d.J()};b["continue"]()};q.va=function(a){var b=this.A.result;if(null!=a)b["continue"](a);else b["continue"]()};
q.Ba=function(){Jd.u.Ba.call(this);this.A=null};q.toString=function(){return"IDB"+Jd.u.toString.call(this)};function ud(a){Error.captureStackTrace?Error.captureStackTrace(this,ud):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.ArgumentException"}D(ud,Error);function Kd(a){Error.captureStackTrace?Error.captureStackTrace(this,Kd):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.NotSupportedException"}D(ud,Error);Kd.prototype.name="ydn.error.NotSupportedException";
function Cd(a){Error.captureStackTrace?Error.captureStackTrace(this,Cd):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.NotImplementedException"}D(Cd,Error);function zd(a){Error.captureStackTrace?Error.captureStackTrace(this,zd):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.InternalError"}D(zd,Error);zd.prototype.name="ydn.InternalError";
function Gc(a){Error.captureStackTrace?Error.captureStackTrace(this,Gc):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.ConstraintError"}D(Gc,Error);Gc.prototype.name="ydn.error.ConstraintError";function Ld(a){Error.captureStackTrace?Error.captureStackTrace(this,Ld):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.InvalidOperationException"}D(ud,Error);
function dd(a){Error.captureStackTrace?Error.captureStackTrace(this,dd):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.InvalidOperationError"}D(dd,Error);function Md(a){a=String(a);if(/^\s*$/.test(a)?0:/^[\],:{}\s\u2028\u2029]*$/.test(a.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r\u2028\u2029\x00-\x08\x0a-\x1f]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:[\s\u2028\u2029]*\[)+/g,"")))try{return eval("("+a+")")}catch(b){}throw Error("Invalid JSON string: "+a);}function Nd(){}
function Od(a,b,c){switch(typeof b){case "string":Pd(b,c);break;case "number":c.push(isFinite(b)&&!isNaN(b)?b:"null");break;case "boolean":c.push(b);break;case "undefined":c.push("null");break;case "object":if(null==b){c.push("null");break}if(v(b)){var d=b.length;c.push("[");for(var e="",f=0;f<d;f++)c.push(e),Od(a,b[f],c),e=",";c.push("]");break}c.push("{");d="";for(e in b)Object.prototype.hasOwnProperty.call(b,e)&&(f=b[e],"function"!=typeof f&&(c.push(d),Pd(e,c),c.push(":"),Od(a,f,c),d=","));c.push("}");
break;case "function":break;default:throw Error("Unknown type: "+typeof b);}}var Qd={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\x0B":"\\u000b"},Rd=/\uffff/.test("\uffff")?/[\\\"\x00-\x1f\x7f-\uffff]/g:/[\\\"\x00-\x1f\x7f-\xff]/g;function Pd(a,b){b.push('"',a.replace(Rd,function(a){if(a in Qd)return Qd[a];var b=a.charCodeAt(0),e="\\u";16>b?e+="000":256>b?e+="00":4096>b&&(e+="0");return Qd[a]=e+b.toString(16)}),'"')};H("ydn");var Sd="undefined"!=typeof r.JSON;function Td(a){return!x(a)||qa(a)?{}:Sd?JSON.parse(a):Md(a)}function Ud(a){var b;try{b=R(a)}catch(c){b=""}return b?b.substr(0,70)+(70<b.length?"...":""):""}function R(a){if(Sd)a=JSON.stringify(a);else{var b=[];Od(new Nd,a,b);a=b.join("")}return a};function Vd(a,b){qd.call(this,a,b)}D(Vd,qd);q=Vd.prototype;q.f=H("ydn.db.crud.req.IndexedDb");q.jb=function(a,b){function c(e){var f=a.a.objectStore(b[e]).count();f.onsuccess=function(f){d[e]=f.target.result;e++;e==b.length?T(a,d):c(e)};f.onerror=function(b){b.preventDefault();T(a,f.error,!0)}}var d=[];0==b.length?T(a,[]):c(0)};
q.Jb=function(a,b,c,d){var e=a.a.objectStore(b);G(this.f,V(a)+" addObject: "+b+" "+d);var f;f=u(d)?e.add(c,d):e.add(c);f.onsuccess=function(b){T(a,b.target.result)};f.onerror=function(b){b.preventDefault();T(a,f.error,!0)}};
q.ac=function(a,b,c,d){var e=a.a.objectStore(b);G(this.f,V(a)+' putObject to store "'+b+'" '+(u(d)?" key: "+d:""));var f;f=u(d)?e.put(c,d):e.put(c);f.onsuccess=function(b){T(a,b.target.result)};f.onerror=function(d){"DataError"==d.name&&(d=R(c),d=new fd(b+": "+d.substring(0,70)));d.preventDefault();T(a,f.error,!0)}};
q.Kb=function(a,b,c,d){function e(m){var t;t=null!=d?n.add(c[m],d[m]):n.add(c[m]);t.onsuccess=function(b){g++;f[m]=b.target.result;g==c.length?T(a,f,k):(b=m+10,b<c.length&&e(b))};t.onerror=function(d){g++;var n=t.error;E(h.f,V(a)+' add request to "'+b+'" cause '+n.name+' for object "'+Ud(c[m])+'" at index '+m+" of "+c.length+" objects.");f[m]=n;k=!0;d.preventDefault();g==c.length?T(a,f,k):(d=m+10,d<c.length&&e(d))}}var f=[],g=0,h=this,k=!1,n=a.a.objectStore(b);G(this.f,V(a)+" addObjects: "+b+" "+
c.length+" objects");if(0<c.length)for(var m=0;10>m&&m<c.length;m++)e(m);else T(a,[])};
q.bc=function(a,b,c,d){function e(m){if(null==c[m])if(G(k.f,"empty object at "+m+" of "+c.length),g++,g==c.length)T(a,f,h);else{var t=m+10;t<c.length&&e(t)}var s;s=null!=d?n.put(c[m],d[m]):n.put(c[m]);s.onsuccess=function(b){g++;f[m]=b.target.result;g==c.length?T(a,f,h):(b=m+10,b<c.length&&e(b))};s.onerror=function(d){g++;var n=s.error;G(k.f,V(a)+' put request to "'+b+'" cause '+n.name+' for object "'+Ud(c[m])+'" at index '+m+" of "+c.length+" objects.");f[m]=n;h=!0;d.preventDefault();g==c.length?
T(a,f,h):(d=m+10,d<c.length&&e(d))}}var f=[],g=0,h=!1,k=this,n=a.a.objectStore(b);G(this.f,V(a)+" put "+c.length+' objects to store "'+b+'"');if(0<c.length)for(var m=0;10>m&&m<c.length;m++)e(m);else T(a,[])};
q.$b=function(a,b,c){function d(k){var m=c[k],p=m.a,t=a.a.objectStore(p),s;s=null===t.keyPath?t.put(b[k],m.id):t.put(b[k]);s.onsuccess=function(c){f++;e[k]=c.target.result;f==b.length?T(a,e,g):(c=k+10,c<b.length&&d(c))};s.onerror=function(c){f++;E(h.f,"request result "+c.name+' error when put keys to "'+p+'" for object "'+Ud(b[k])+'" at index '+k+" of "+b.length+" objects.");e[k]=s.error;g=!0;c.preventDefault();f==b.length?T(a,e,g):(c=k+10,c<b.length&&d(c))}}var e=[],f=0,g=!1,h=this;G(this.f,V(a)+
" putByKeys: of "+b.length+" objects");if(0<b.length)for(var k=0;10>k&&k<b.length;k++)d(k);else T(a,e,g)};q.wb=function(a,b,c){var d=a.a.objectStore(b);G(this.f,V(a)+" clearById: "+b+" "+c);var e=d.openCursor(Rc.only(c));e.onsuccess=function(b){if(b=b.target.result){var c=b["delete"]();c.onsuccess=function(){T(a,1)};c.onerror=function(){T(a,c.error,!0)}}else T(a,0)};e.onerror=function(b){b.preventDefault();T(a,e.error,!0)}};
q.dc=function(a,b){function c(h){h++;if(h>=b.length)0<g.length?T(a,g,!0):T(a,d);else{b[h].a!=e&&(e=b[h].a,f=a.a.objectStore(e));var k=f["delete"](b[h].id);k.onsuccess=function(){d++;c(h)};k.onerror=function(a){a.preventDefault();g[h]=k.error;c(h)}}}var d=0,e,f;G(this.f,V(a)+" removeByKeys: "+b.length+" keys");var g=[];c(-1)};
q.xb=function(a,b,c){var d=a.a.objectStore(b),e=d.count(c);G(this.f,V(a)+" clearByKeyRange: "+b+" "+c);e.onsuccess=function(b){var e=b.target.result,h=d["delete"](c);h.onsuccess=function(){T(a,e)};h.onerror=function(){T(a,h.error,!0)}};e.onerror=function(b){b.preventDefault();T(a,e.error,!0)}};q.Nb=function(a,b,c){var d=a.a.objectStore(b);G(this.f,V(a)+" "+b+" "+c);var e=d["delete"](c);e.onsuccess=function(){T(a,void 0)};e.onerror=function(b){b.preventDefault();T(a,e.error,!0)}};
q.cc=function(a,b,c,d){var e=a.a.objectStore(b).index(c);G(this.f,V(a)+" clearByIndexKeyRange: "+b+":"+c+" "+d);var f=[],g=e.openCursor(d),h=0;g.onsuccess=function(b){var c=b.target.result;if(c){var d=c["delete"]();d.onsuccess=function(){h++;c["continue"]()};d.onerror=function(a){f.push(d.error);a.preventDefault();c["continue"]()}}else 0<f.length?T(a,f,!0):T(a,h)};g.onerror=function(b){b.preventDefault();T(a,g.error,!0)}};
q.hb=function(a,b){var c=b.length,d=0;G(this.f,V(a)+" clearByStores: "+b);for(var e=0;e<c;e++){var f=a.a.objectStore(b[e]).clear();f.onsuccess=function(){d++;d==c&&T(a,d)};f.onerror=function(b){d++;b.preventDefault();d==c&&T(a,f.error,!0)}}};
function Wd(a,b,c,d,e,f,g,h,k){var n=[],m=b.a.objectStore(c),p=oc(f,k);c=V(b)+" "+c+(d?":"+d:"")+(e?R(e):"");f&&(c+=" reverse");k&&(c+=" unique");G(a.f,c);var t;t=d?m.index(d).openCursor(e,p):m.openCursor(e,p);var s=!1;t.onsuccess=function(a){if(a=a.target.result)if(!s&&0<h)s=!0,a.advance(h);else if(n.push(a.value),n.length<g)a["continue"]();else T(b,n);else T(b,n)};t.onerror=function(a){a.preventDefault();T(b,t.error,!0)}}q.tb=function(a,b,c,d,e,f){Wd(this,a,b,null,c,d,e,f)};
q.Ta=function(a,b,c,d,e,f,g,h){Wd(this,a,b,c,d,e,f,g,h)};q.Tb=function(a,b,c,d,e,f){var g=[],h=a.a.objectStore(b);d=oc(d);G(this.f,V(a)+" "+b+" "+c);var k=h.openCursor(c,d),n=!1;k.onsuccess=function(b){if(b=b.target.result)if(!n&&0<f)n=!0,b.advance(f);else if(g.push(b.key),g.length<e)b["continue"]();else T(a,g);else T(a,g)};k.onerror=function(b){b.preventDefault();T(a,k.error,!0)}};
q.Rb=function(a,b,c,d,e,f,g,h){var k=[],n=a.a.objectStore(b).index(c);G(this.f,V(a)+" "+b+":"+c+" "+d);var m=n.openKeyCursor(d,oc(e,h)),p=!1;m.onsuccess=function(b){if(b=b.target.result)if(!p&&0<g)p=!0,b.advance(g);else if(k.push(b.primaryKey),k.length<f)b["continue"]();else T(a,k);else T(a,k)};m.onerror=function(b){b.preventDefault();T(a,m.error,!0)}};
q.nb=function(a,b,c){var d=this;G(this.f,V(a)+b+":"+c);var e=a.a.objectStore(b).get(c);e.onsuccess=function(b){G(d.f,V(a)+" record "+c+(null!=b.target.result?" ":" not ")+" exists.");T(a,b.target.result)};e.onerror=function(b){b.preventDefault();T(a,e.error,!0)}};
q.Ub=function(a,b,c){function d(b){if(null==c[b])if(f++,e[b]=void 0,f==h)T(a,e);else{var n=b+10;n<h&&d(n)}var m;m=g.get(c[b]);m.onsuccess=function(c){f++;e[b]=c.target.result;f==h?T(a,e):(c=b+10,c<h&&d(c))};m.onerror=function(b){f++;b.preventDefault();T(a,m.error,!0)}}var e=[];e.length=c.length;var f=0,g=a.a.objectStore(b),h=c.length;G(this.f,V(a)+" "+b+":"+h+" ids");if(0<h)for(b=0;10>b&&b<h;b++)d(b);else T(a,[])};
q.Wb=function(a,b){function c(f){var h=b[f],k=a.a.objectStore(h.a).get(h.id);k.onsuccess=function(h){e++;d[f]=h.target.result;e==b.length?T(a,d):(h=f+10,h<b.length&&c(h))};k.onerror=function(b){e++;b.preventDefault();T(a,k.error,!0)}}var d=[];d.length=b.length;var e=0;G(this.f,V(a)+" "+b.length+" ids");if(0<b.length)for(var f=0;10>f&&f<b.length;f++)c(f);else T(a,[])};
q.za=function(a,b,c,d){var e=a.a.objectStore(b);b=V(a)+" "+b+(d?":"+d:"")+(c?":"+R(c):"");G(this.f,b);var f;null!=d?(d=e.index(d),f=null!=c?d.count(c):d.count()):f=null!=c?e.count(c):e.count();f.onsuccess=function(b){T(a,b.target.result)};f.onerror=function(b){b.preventDefault();T(a,f.error,!0)}};function Xd(a,b){qd.call(this,a,b)}D(Xd,Vd);q=Xd.prototype;q.f=H("ydn.db.core.req.IndexedDb");q.Sb=function(a,b,c,d){Yd(this,Zd,a,b,c,d)};
function Yd(a,b,c,d,e,f){var g=[],h=c.a,k=V(c),n=b==Zd,m=k+" "+b+"ByIterator "+d;0<e&&(m+=" limit "+e);F(a.f,m);var p=bd(d,h,k,a,b);p.e=function(a){Mc(p);T(c,a,!0)};var t=0,s=!1,B=!1;p.d=function(h){B||(G(a.f,m+" starting"),B=!0);if(null!=h){var k=d.d?p.T():h;!s&&0<f?(p.advance(f),s=!0):(t++,n?g.push(h):g.push(d.b?k:p.ja()),b==$d?(Mc(p),T(c,g[0])):!u(e)||t<e?p.a[0].va(void 0):(F(a.f,"success:"+m+" "+g.length+" records"),Mc(p),T(c,g)))}else F(a.f,"success:"+m+" "+g.length+" records"),Mc(p),T(c,b==
$d?g[0]:g)}}q.Vb=function(a,b,c,d){Yd(this,cd,a,b,c,d)};q.Pb=function(a,b){Yd(this,$d,a,b,1,0)};q.ob=function(a,b,c,d,e,f,g,h){var k=W(this.a,c);u(d)&&(d=this.W(k,d));return new Jd(a,b,c,d,e,f,g,h)};var ae=!pb||pb&&9<=Db,be=pb&&!Bb("9");!rb||Bb("528");qb&&Bb("1.9b")||pb&&Bb("8")||ob&&Bb("9.5")||rb&&Bb("528");qb&&!Bb("8")||pb&&Bb("9");function ce(a,b){this.type=a;this.a=this.target=b}ce.prototype.oa=aa();ce.prototype.b=!1;ce.prototype.d=!0;ce.prototype.preventDefault=function(){this.d=!1};function de(a){de[" "](a);return a}de[" "]=aa();function ee(a,b){a&&fe(this,a,b)}D(ee,ce);q=ee.prototype;q.target=null;q.clientX=0;q.clientY=0;q.mc=null;function fe(a,b,c){var d=a.type=b.type;ce.call(a,d);a.target=b.target||b.srcElement;a.a=c;if((c=b.relatedTarget)&&qb)try{de(c.nodeName)}catch(e){}a.clientX=void 0!==b.clientX?b.clientX:b.pageX;a.clientY=void 0!==b.clientY?b.clientY:b.pageY;a.mc=b;b.defaultPrevented&&a.preventDefault();delete a.b}
q.preventDefault=function(){ee.u.preventDefault.call(this);var a=this.mc;if(a.preventDefault)a.preventDefault();else if(a.returnValue=!1,be)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};var ge="closure_listenable_"+(1E6*Math.random()|0),he=0;function ie(a,b,c,d,e,f){this.X=a;this.a=b;this.src=c;this.type=d;this.capture=!!e;this.Ca=f;this.key=++he;this.S=this.ya=!1};var je={},ke={},le={},me={};function ne(a,b,c,d,e){if(v(b))for(var f=0;f<b.length;f++)ne(a,b[f],c,d,e);else c=oe(c),a&&a[ge]?pe(a,b,c,!1,d,e):qe(a,b,c,!1,d,e)}
function qe(a,b,c,d,e,f){if(!b)throw Error("Invalid event type");e=!!e;var g=ke;b in g||(g[b]={s:0,aa:0});g=g[b];e in g||(g[e]={s:0,aa:0},g.s++);var g=g[e],h=ga(a),k;g.aa++;if(g[h]){k=g[h];for(var n=0;n<k.length;n++)if(g=k[n],g.X==c&&g.Ca==f){if(g.S)break;d||(k[n].ya=!1);return}}else k=g[h]=[],g.s++;n=re();g=new ie(c,n,a,b,e,f);g.ya=d;n.src=a;n.X=g;k.push(g);le[h]||(le[h]=[]);le[h].push(g);a.addEventListener?a.addEventListener(b,n,e):a.attachEvent(b in me?me[b]:me[b]="on"+b,n);je[g.key]=g}
function re(){var a=se,b=ae?function(c){return a.call(b.src,b.X,c)}:function(c){c=a.call(b.src,b.X,c);if(!c)return c};return b}function te(a,b,c,d,e){if(v(b))for(var f=0;f<b.length;f++)te(a,b[f],c,d,e);else c=oe(c),a&&a[ge]?pe(a,b,c,!0,d,e):qe(a,b,c,!0,d,e)}
function ue(a,b,c,d,e){if(v(b))for(var f=0;f<b.length;f++)ue(a,b[f],c,d,e);else if(c=oe(c),a&&a[ge])b in a.g&&(a=a.g[b],c=ve(a,c,d,e),-1<c&&(e=a[c],delete je[e.key],e.S=!0,Ha.splice.call(a,c,1)));else{d=!!d;a:{f=ke;if(b in f&&(f=f[b],d in f&&(f=f[d],a=ga(a),f[a]))){a=f[a];break a}a=null}if(a)for(f=0;f<a.length;f++)if(a[f].X==c&&a[f].capture==d&&a[f].Ca==e){we(a[f]);break}}}
function we(a){if(!y(a)&&a&&!a.S){var b=a.src;if(b&&b[ge])xe(b,a);else{var c=a.type,d=a.a,e=a.capture;b.removeEventListener?b.removeEventListener(c,d,e):b.detachEvent&&b.detachEvent(c in me?me[c]:me[c]="on"+c,d);b=ga(b);le[b]&&(d=le[b],Ra(d,a),0==d.length&&delete le[b]);a.S=!0;a.X=null;a.a=null;a.src=null;a.Ca=null;if(d=ke[c][e][b])d.sc=!0,ye(c,e,b,d);delete je[a.key]}}}
function ye(a,b,c,d){if(!d.ub&&d.sc){for(var e=0,f=0;e<d.length;e++)d[e].S||(e!=f&&(d[f]=d[e]),f++);d.length=f;d.sc=!1;0==f&&(delete ke[a][b][c],ke[a][b].s--,0==ke[a][b].s&&(delete ke[a][b],ke[a].s--),0==ke[a].s&&delete ke[a])}}function ze(a,b,c,d,e){var f=1;b=ga(b);if(a[b]){var g=--a.aa,h=a[b];h.ub?h.ub++:h.ub=1;try{for(var k=h.length,n=0;n<k;n++){var m=h[n];m&&!m.S&&(f&=!1!==Ae(m,e))}}finally{a.aa=Math.max(g,a.aa),h.ub--,ye(c,d,b,h)}}return Boolean(f)}
function Ae(a,b){var c=a.X,d=a.Ca||a.src;a.ya&&we(a);return c.call(d,b)}
function se(a,b){if(a.S)return!0;var c=a.type,d=ke;if(!(c in d))return!0;var d=d[c],e,f;if(!ae){e=b||ca("window.event");var g=!0 in d,h=!1 in d;if(g){if(0>e.keyCode||void 0!=e.returnValue)return!0;a:{var k=!1;if(0==e.keyCode)try{e.keyCode=-1;break a}catch(n){k=!0}if(k||void 0==e.returnValue)e.returnValue=!0}}k=new ee;fe(k,e,this);e=!0;try{if(g){for(var m=[],p=k.a;p;p=p.parentNode)m.push(p);f=d[!0];f.aa=f.s;for(var t=m.length-1;!k.b&&0<=t&&f.aa;t--)k.a=m[t],e&=ze(f,m[t],c,!0,k);if(h)for(f=d[!1],f.aa=
f.s,t=0;!k.b&&t<m.length&&f.aa;t++)k.a=m[t],e&=ze(f,m[t],c,!1,k)}else e=Ae(a,k)}finally{m&&(m.length=0)}return e}c=new ee(b,this);return e=Ae(a,c)}var Be="__closure_events_fn_"+(1E9*Math.random()>>>0);function oe(a){return fa(a)?a:a[Be]||(a[Be]=function(b){return a.handleEvent(b)})};function Ce(){Dd.call(this);this.g={};this.Sc=this}D(Ce,Dd);Ce.prototype[ge]=!0;q=Ce.prototype;q.Zb=null;q.Qb=function(a,b,c,d){ne(this,a,b,c,d)};q.removeEventListener=function(a,b,c,d){ue(this,a,b,c,d)};
q.dispatchEvent=function(a){var b,c=this.Zb;if(c)for(b=[];c;c=c.Zb)b.push(c);var c=this.Sc,d=a.type||a;if(x(a))a=new ce(a,c);else if(a instanceof ce)a.target=a.target||c;else{var e=a;a=new ce(d,c);Za(a,e)}var e=!0,f;if(b)for(var g=b.length-1;!a.b&&0<=g;g--)f=a.a=b[g],e=De(f,d,!0,a)&&e;a.b||(f=a.a=c,e=De(f,d,!0,a)&&e,a.b||(e=De(f,d,!1,a)&&e));if(b)for(g=0;!a.b&&g<b.length;g++)f=a.a=b[g],e=De(f,d,!1,a)&&e;return e};
q.Ba=function(){Ce.u.Ba.call(this);var a=0,b;for(b in this.g){for(var c=this.g[b],d=0;d<c.length;d++)++a,delete je[c[d].key],c[d].S=!0;c.length=0}this.Zb=null};function pe(a,b,c,d,e,f){var g=a.g[b]||(a.g[b]=[]),h=ve(g,c,e,f);-1<h?(a=g[h],d||(a.ya=!1)):(a=new ie(c,null,a,b,!!e,f),a.ya=d,g.push(a))}function xe(a,b){var c=b.type;c in a.g&&Ra(a.g[c],b)&&(delete je[b.key],b.S=!0)}
function De(a,b,c,d){if(!(b in a.g))return!0;var e=!0;b=Sa(a.g[b]);for(var f=0;f<b.length;++f){var g=b[f];if(g&&!g.S&&g.capture==c){var h=g.X,k=g.Ca||g.src;g.ya&&xe(a,g);e=!1!==h.call(k,d)&&e}}return e&&!1!=d.d}function ve(a,b,c,d){for(var e=0;e<a.length;++e){var f=a[e];if(f.X==b&&f.capture==!!c&&f.Ca==d)return e}return-1};function Ee(a,b,c){if(fa(a))c&&(a=la(a,c));else if(a&&"function"==typeof a.handleEvent)a=la(a.handleEvent,a);else throw Error("Invalid listener argument");2147483647<b||r.setTimeout(a,b||0)};function Fe(){this.a=!1}Fe.prototype.a=!1;function Ge(a,b,c,d,e,f,g,h,k){Gd.call(this,a,b,d,e,f,g,h,k);this.yb=this.Ua=this.Ea=void 0;this.Yb=this.i=this.d=this.a=null;this.e=new Fe}D(Ge,Gd);q=Ge.prototype;q.rb=function(){return!!this.c};q.update=function(){throw new Cc;};q.advance=function(a){function b(b){d++;if(!b||d>=a)return He(c,b)}var c=this,d=this.a?-1:0;this.o?Ie(this.d,b,this.a):Je(this.d,b,this.a)};
q.va=function(a){if(null!=a){var b=this,c=new X(a),d=function(c){b.a=c;if(!c)return He(b,c);var d=L(c.value.key,a);if(b.o){if(1!=d)return He(b,c)}else if(-1!=d)return He(b,c)};this.o?Ie(this.d,d,c):Je(this.d,d,c)}else this.advance(1)};function Ke(a){Ee(function(){a.e.a?(a.e.a=!1,this.J(this.Ea,this.Ua,this.yb),Ke(this)):(this.Yb(),this.Yb=null)},0,a)}
function He(a,b){if(a.a=b){var c=b.value;if(a.n)if(a.o||null==a.n.upper)a.o&&null!=a.n.lower&&(d=L(c.key,a.n.lower),-1==d||0==d&&a.n.lowerOpen)&&(a.a=null);else{var d=L(c.key,a.n.upper);if(1==d||0==d&&a.n.upperOpen)a.a=null}if(a.a){if(a.unique&&(null!=a.Ea&&null!=c.key)&&0==L(a.Ea,c.key))return;a.Ea=c.key;a.Ua=a.b?c.a:a.Ea;a.h==cd&&(a.Sa?a.yb=a.Ua:a.yb=Le(a.i,a.Ua))}}a.a||(a.Ea=void 0,a.Ua=void 0,a.yb=void 0);return a.e.a=!0}
q.Ja=function(a,b){var c=null;this.n&&(this.o?null!=this.n.upper&&(c=new X(this.n.upper)):null!=this.n.lower&&(c=new X(this.n.lower)));null!=a&&(c=this.b?new X(a,b):new X(a));this.Yb=Me(this.c,function(d){function e(c){var d=c.value,e=d.key;if(c&&null!=e)if(null!=a)if(null!=b){if(d=d.a,null!=d&&0==L(a,e)&&0==L(b,d))return}else{if(0==L(a,e))return}else if(this.n&&(!this.o&&(this.n.lowerOpen&&null!=this.n.lower)&&(d=L(e,this.n.lower),0==d)||this.o&&(this.n.upperOpen&&null!=this.n.upper)&&(d=L(e,this.n.upper),
0==d)))return;return He(this,c)}this.i=Ne(d,this.Eb);this.d=Oe(this.i,this.g);this.o?Ie(this.d,la(e,this),c):Je(this.d,la(e,this),c);Ke(this)},this)};q.clear=function(){throw new Cc;};q.fb=function(){throw new Cc;};q.eb=function(){throw new Cc;};q.toString=function(){return"Simple"+Ge.u.toString.call(this)};function Pe(a,b){qd.call(this,a,b)}D(Pe,qd);q=Pe.prototype;q.f=H("ydn.db.crud.req.SimpleStore");q.Rb=function(a,b,c,d,e,f,g){var h=V(a)+" "+b+":"+c+" "+(d?Ud(d):"");G(this.f,h);var k=Me(a.a,function(h){h=Ne(h,b).na(c,d,e,f,g);T(a,h);k();k=null},this)};q.Tb=function(a,b,c,d,e,f){var g=V(a)+" "+b+" "+(c?Ud(c):"");G(this.f,g);var h=Me(a.a,function(g){g=Ne(g,b).na(null,c,d,e,f);T(a,g);h();h=null},this)};q.$b=function(a,b,c){Qe(this,a,null,b,c,!0,!1)};
function Qe(a,b,c,d,e,f,g){G(a.f,V(b)+" "+(f?"put":"add")+"Object"+(g?"":"s "+d.length+" objects"));var h=Me(b.a,function(a){var n;if(g)n=Ne(a,c),a=Re(n,e,d,!f),null!=a?T(b,a):(a=Ud(a),a=new ed(a),T(b,a,!0));else{for(var m=c,p=[],t=!1,s=e||{},B=0;B<d.length;B++){var C;c?C=s[B]:(m=e[B],C=m.id,m=m.a);n&&n.getName()==m||(n=Ne(a,m));C=Re(n,C,d[B],!f);null!=C||(t=!0);p.push(C)}T(b,p,t)}h();h=null},a)}q.Jb=function(a,b,c,d){Qe(this,a,b,c,d,!1,!0)};q.ac=function(a,b,c,d){Qe(this,a,b,c,d,!0,!0)};
q.Kb=function(a,b,c,d){Qe(this,a,b,c,d,!1,!1)};q.bc=function(a,b,c,d){Qe(this,a,b,c,d,!0,!1)};q.nb=function(a,b,c){var d=Me(a.a,function(e){e=Le(Ne(e,b),c);T(a,e);d();d=null},this)};function Ue(a,b,c,d){var e=Me(b.a,function(a){for(var g=[],h=c,k,n=0;n<d.length;n++){var m=d[n];m instanceof pd&&(h=m,m=h.id,h=h.a);k&&k.getName()==h||(k=Ne(a,h));m=Le(k,m);g[n]=m}T(b,g,!1);e();e=null},a)}q.Ub=function(a,b,c){Ue(this,a,b,c)};q.Wb=function(a,b){Ue(this,a,null,b)};
q.tb=function(a,b,c,d,e,f){var g=V(a)+" "+b+" "+(c?Ud(c):"");G(this.f,g);var h=Me(a.a,function(k){k=Ne(k,b);F(this.f,g+" getting records for "+b);k=Ve(k,!1,null,c,d,e,f);F(this.f,g+" "+k.length+" records found.");T(a,k);h();h=null},this)};q.Ta=function(a,b,c,d,e,f,g,h){var k=V(a)+" "+b+" "+(d?Ud(d):"");G(this.f,k);var n=Me(a.a,function(m){m=Ve(Ne(m,b),!1,c,d,e,f,g,h);F(this.f,k+" "+m.length+" records found.");T(a,m);n();n=null},this)};
q.wb=function(a,b,c){var d=V(a)+" removeById "+b+" "+c;G(this.f,d);var e=this,f=Me(a.a,function(g){g=We(Ne(g,b),c);F(e.f,"success "+d+(0==g?" [not found]":""));T(a,g);f();f=null},this)};q.dc=function(a,b){G(this.f,V(a)+" removeByKeys "+b.length+" keys");var c,d=0,e=Me(a.a,function(f){for(var g=0;g<b.length;g++){var h=b[g].a,k=b[g].id;c&&c.getName()==h||(c=Ne(f,h));d+=We(c,k)}T(a,d);e();e=null},this)};q.Nb=function(a,b,c){this.xb(a,b,c)};
q.xb=function(a,b,c){var d=V(a)+" removeByKeyRange "+(c?R(c):"");G(this.f,d);var e=this,f=Me(a.a,function(g){g=Xe(Ne(g,b),c);F(e.f,d+" deleted "+g+" records.");T(a,g);f();f=null},this)};q.cc=function(a,b,c,d){var e=V(a)+" removeByIndexKeyRange "+(d?R(d):"");G(this.f,e);var f=Me(a.a,function(e){e=Ne(e,b);for(var h=e.na(c,d),k=h.length,n=0;n<k;n++)We(e,h[n]);T(a,k);f();f=null},this)};
q.hb=function(a,b){var c=V(a)+" clearByStores";G(this.f,c);var d=Me(a.a,function(e){for(var f=0;f<b.length;f++)Ne(e,b[f]).clear();F(this.f,"success "+c);T(a,b.length);d();d=null},this)};q.jb=function(a,b){var c=Me(a.a,function(d){for(var e=[],f=0;f<b.length;f++){var g=Ne(d,b[f]);e.push(Ye(g))}T(a,e);c();c=null},this)};
q.za=function(a,b,c,d){var e=V(a)+" count"+(null!=d?"Index":"")+(null!=c?"KeyRange":"Store");G(this.f,e);var f=Me(a.a,function(g){g=Ye(Ne(g,b),d,c);F(this.f,"success "+e);T(a,g);f();f=null},this)};function Ze(a,b){qd.call(this,a,b)}D(Ze,Pe);Ze.prototype.Sb=function(a,b,c,d){var e=[],f=V(a),g=a.a;G(this.f,f+" keysByIterator:"+b);var h=bd(b,g,f,this);h.e=function(b){T(a,b,!0)};var k=0,n=!1;h.d=function(b){null!=b?!n&&0<d?(h.advance(d),n=!0):(k++,e.push(b),!u(c)||k<c?h.advance(1):(Mc(h),T(a,e))):(Mc(h),T(a,e))}};
function $e(a,b,c,d,e,f){var g=c.a,h=V(c),k=[];G(a.f,h+" listByIterator"+d);var n=bd(d,g,h,a);n.e=function(a){Mc(n);T(c,a,!0)};var m=0,p=!1;n.d=function(a){if(null!=a){a=d.d?n.T():a;var g=n.ja();!p&&0<f?(n.advance(f),p=!0):(m++,k.push(d.b?a:g),!u(e)||m<e?n.advance(1):(Mc(n),a=$d==b?k[0]:k,T(c,a)))}else Mc(n),a=$d==b?k[0]:k,T(c,a)}}Ze.prototype.Vb=function(a,b,c,d){$e(this,cd,a,b,c,d)};Ze.prototype.Pb=function(a,b){$e(this,$d,a,b,1,0)};
Ze.prototype.ob=function(a,b,c,d,e,f,g,h){var k=W(this.a,c);u(d)&&(d=this.W(k,d));return new Ge(a,b,0,c,d,e,f,g,h)};function af(a,b,c,d,e,f,g,h,k){Gd.call(this,a,b,d,e,f,g,h,k);this.a=c;this.i=x(e)?sd(c,e):null;this.d=this.e=void 0}D(af,Gd);q=af.prototype;q.wa=H("ydn.db.core.req.WebsqlCursor");q.fa=function(a){this.w=this.d=this.e=void 0;if(u(a))if(z(a)){var b=bf(a[this.a.b],this.a.type);if(this.b){var c;c=sd(this.a,this.g).type;this.d=b;this.e=bf(a[this.g],c)}else this.e=b;this.w=this.Sa?b:cf(a,this.a)}else this.w=a};
function df(a,b,c){sd(a.a,a.g);var d=[],e=a.g,f=a.n,g=a.e;if(null!=f){var h=f.lower,k=f.upper,n=f.lowerOpen,f=f.upperOpen;a.o?k=null!=k&&-1==L(k,g)?k:g:h=null!=h&&1==L(h,g)?h:g;f=null!=h&&null!=k?N.bound(h,k,!!n,!!f):null!=h?Rc.lowerBound(h,!!n):Rc.upperBound(k,!!f)}else f=a.o?Rc.upperBound(g):Rc.lowerBound(g);e=ef(a.a,d,a.h,e,f,a.o,a.unique);c=a.o?Rc.upperBound(c,!1):Rc.lowerBound(c,!1);c=ef(a.a,d,a.h,a.a.b,c,a.o,a.unique);e.p=e.p?e.p+(" AND "+c.p):c.p;c="SELECT "+e.select+" FROM "+e.Aa+(e.p?" WHERE "+
e.p:"")+(e.group?" GROUP BY "+e.group:"")+" ORDER BY "+e.$;c+=" LIMIT 1";G(a.wa,a+": continuePrimary:  SQL: "+c+" : "+R(d));a.c.executeSql(c,d,function(c,d){0<d.rows.length?a.fa(d.rows.item(0)):a.fa();b.call(a,a.e,a.d,a.w);b=null},function(c,d){E(a.wa,"get error: "+d.message);a.cb(d);a.fa();b.call(a,a.d,a.e,a.w);b=null;return!1})}
function ff(a,b,c,d,e){var f=a.i.c,g=a.i.b,h=a.a.a,k=a.o?" <":" >",k=d?k+" ":k+"= ";d=Vc(c,a.i.type);e=Vc(e,a.a.type);var n="";a.n?(a=ef(a.a,b,a.h,f,a.n,a.o,a.unique),a.p+=" AND ",n=g+k+"?",b.push(d)):(c=a.o?N.upperBound(c,!0):N.lowerBound(c,!0),a=ef(a.a,b,a.h,f,c,a.o,a.unique),n=a.p,a.p="");a.p+="("+n+" OR ("+g+" = ? AND "+h+k+"?))";b.push(d);b.push(e);return"SELECT "+a.select+" FROM "+a.Aa+" WHERE "+a.p+(a.group?" GROUP BY "+a.group:"")+" ORDER BY "+a.$}
function gf(a,b,c,d){var e,f,g,h;if(null!=a.n)if(e=a.n.lower,f=a.n.upper,g=a.n.lowerOpen,h=a.n.upperOpen,a.o)if(null!=f){var k=L(c,f);-1==k?(f=c,h=d):0==k&&(h=d||h)}else f=c,h=d;else null!=e?(k=L(c,e),1==k?(e=c,g=d):0==k&&(g=d||g)):(e=c,g=d);else a.o?(f=c,h=d):(e=c,g=d);c=new N(e,f,!!g,!!h);b=ef(a.a,b,a.h,a.i?a.i.c:a.a.b,c,a.o,a.unique);b="SELECT "+b.select+" FROM "+b.Aa+(b.p?" WHERE "+b.p:"")+(b.group?" GROUP BY "+b.group:"")+" ORDER BY "+b.$;a.b&&(b+=", "+a.a.a+(a.o?"DESC":"ASC"));return b}
function hf(a,b,c,d,e,f){var g=!d;d=[];null!=f?c=ff(a,d,c,g,f):null!=c?c=gf(a,d,c,g):(c=jf(a.a,d,a.h,a.b?a.i.c:a.a.b,a.n,a.o,a.unique),a.b&&(c+=", "+a.a.a+" ASC"));c+=" LIMIT 1";0<e&&(c+=" OFFSET "+e);G(a.wa,a+": continue:  SQL: "+c+" : "+R(d));a.c.executeSql(c,d,function(c,d){0<d.rows.length?a.fa(d.rows.item(0)):a.fa();b.call(a,a.e,a.d,a.w);b=null},function(c,d){E(a.wa,"get error: "+d.message);a.cb(d);a.fa();b.call(a,a.d,a.e,a.w);b=null;return!1})}q.rb=function(){return!!this.c};
q.update=function(a){if(!this.rb())throw new jd;var b=new I,c=this.d;a=kf(this.a,a,c);var d="REPLACE INTO "+lf(this.a)+" ("+a.kc.join(", ")+") VALUES ("+a.xc.join(", ")+") ON CONFLICT FAIL";G(this.wa,this+': clear "'+d+'" : '+R(a.G));this.c.executeSql(d,a.G,function(){b.v(c)},function(a,c){b.t(c);return!1});return b};
q.advance=function(a){var b=this.e,c=this.d,d=!0;null==this.e||this.b&&null==this.d||(a-=1,d=!1);hf(this,function(a,d,g){var h=null!=b&&null!=a&&0==L(b,a);if(this.b){var k=null!=d&&null!=c&&0==L(d,c);if(h&&k)throw new Ec("current: "+b+";"+c+" next: "+a+";"+d);}else if(h)throw new Ec("current: "+b+" next: "+a);this.J(a,d,g)},this.e,d,a,this.d)};q.va=function(a){null!=a?hf(this,this.J,a,!0):this.advance(1)};q.Ja=function(a,b){hf(this,this.J,a,!1,0,b)};
q.clear=function(){if(!this.rb())throw new jd;var a=new I,b=this.a.b,b="DELETE FROM "+lf(this.a)+" WHERE "+b+" = ?",c=[this.d];G(this.wa,this+': clear "'+b+'" : '+R(c));this.c.executeSql(b,c,function(b,c){a.v(c.rowsAffected)},function(b,c){a.t(c);return!1});return a};q.fb=function(a,b){G(this.wa,this+" restarting.");this.Ja(b,a)};
q.eb=function(a){var b=L(a,this.d);if(0==b||1==b&&this.o||-1==b&&!this.o)throw new dd(this+" to continuePrimaryKey  from "+this.d+" to "+a+" on "+this.V+" direction is wrong");df(this,this.J,a)};q.toString=function(){return"WebSql"+af.u.toString.call(this)};function mf(a,b){qd.call(this,a,b)}D(mf,qd);q=mf.prototype;q.f=H("ydn.db.crud.req.WebSql");function cf(a,b){var c=a._default_?Td(a._default_):{};if(null!=b.keyPath){var d=bf(a[b.keyPath],b.type);null!=d&&nf(b,c,d)}for(d=0;d<b.indexes.length;d++){var e=b.indexes[d],f=e.c;"_default_"==f||(e.e||e.multiEntry)||e.type!=of||(f=bf(a[f],e.type),u(f)&&pf(e,c,f))}return c}q.Tb=function(a,b,c,d,e,f){qf(this,a,!0,b,void 0,c,d,e,f,!1)};q.Rb=function(a,b,c,d,e,f,g,h){qf(this,a,!0,b,c,d,e,f,g,h)};
function qf(a,b,c,d,e,f,g,h,k,n){var m=[],p=W(a.a,d),t=p.b;null!=e&&e!==t&&sd(p,e);d=[];e=jf(p,d,c?Zd:cd,e||t,f,g,n);y(h)&&(e+=" LIMIT "+h);y(k)&&(e+=" OFFSET "+k);var s=V(b)+" SQL: "+e+" ;params= "+R(d);G(a.f,s);b.a.executeSql(e,d,function(d,e){for(var f=e.rows.length,g=0;g<f;g++){var h=e.rows.item(g);c?m[g]=bf(h[t],p.type):null!=h&&(m[g]=cf(h,p))}F(a.f,"success "+s);T(b,m)},function(c,d){E(a.f,"error: "+s+d.message);T(b,d,!0);return!1})}q.Jb=function(a,b,c,d){rf(this,a,!0,!0,b,[c],[d])};
q.ac=function(a,b,c,d){rf(this,a,!1,!0,b,[c],[d])};q.Kb=function(a,b,c,d){rf(this,a,!0,!1,b,c,d)};
function rf(a,b,c,d,e,f,g){function h(c,e){if(null==f[c])if(G(a.f,"empty object at "+c+" of "+f.length),p++,p==f.length)F(a.f,"success "+t),T(b,m,s);else{var Q=c+2;Q<f.length&&h(Q,e)}var U;U=u(g)?kf(k,f[c],g[c]):kf(k,f[c]);Q=n+lf(k)+" ("+U.kc.join(", ")+") VALUES ("+U.xc.join(", ")+");";G(a.f,V(b)+" SQL: "+Q+" PARAMS: "+U.G+" REQ: "+c+" of "+f.length);e.executeSql(Q,U.G,function(g,t){function Q(c,d){var f=n+Ea("ydn.db.me:"+k.getName()+":"+c.getName())+" ("+k.a+", "+c.b+") VALUES (?, ?)",g=[Vc(S,k.type),
d];G(a.f,V(b)+" multiEntry "+f+" "+g);e.executeSql(f,g,aa(),function(b,c){E(a.f,"multiEntry index insert error: "+c.message);return!1})}p++;var S=u(U.key)?U.key:t.insertId;1>t.rowsAffected&&(s=!0,S=new ed(S+" no-op"));for(var xa=0,vd=k.indexes.length;xa<vd;xa++){var sb=k.index(xa);if(sb.multiEntry)for(var Jb=qc(f[c],sb.keyPath),Kh=(Jb?Jb.length:0)||0,Te=0;Te<Kh;Te++)Q(sb,Jb[Te])}d?T(b,S):(m[c]=S,p==f.length?T(b,m,s):(xa=c+2,xa<f.length&&h(xa,g)))},function(e,g){p++;s=!0;6==g.code?g.name="ConstraintError":
E(a.f,"error: "+g.message+" "+t);if(d)T(b,g,!0);else if(m[c]=g,p==f.length)G(a.f,"success "+t),T(b,m,s);else{var k=c+2;k<f.length&&h(k,e)}return!1})}var k=W(a.a,e),n=c?"INSERT INTO ":"INSERT OR REPLACE INTO ";c=b.a;var m=[],p=0,t=V(b)+" inserting "+f.length+" objects.",s=!1;if(0<f.length)for(e=0;2>e&&e<f.length;e++)h(e,c);else F(a.f,"success"),T(b,[])}q.bc=function(a,b,c,d){rf(this,a,!1,!1,b,c,d)};
q.$b=function(a,b,c){if(0==c.length)T(a,[]);else{for(var d=0,e=this,f=function(d,f){var g=[];G(e.f,"put "+f.length+" objects to "+d);for(var h,k=(h=!!W(e.a,d).keyPath)?void 0:[],m=0;m<f.length;m++)g.push(b[f[m]]),h||k.push(c[f[m]].id);rf(e,a,!1,!1,d,g,k)},g="",h=[],k=[],n=0;n<c.length;n++){var m=c[n].a,p=c[n].id;m!=g?(d++,0<h.length&&f(g,h),h=[n],k=[p],g=m):(h.push(n),k.push(p))}0<h.length&&f(g,h)}};
q.nb=function(a,b,c){var d=a.a,e=W(this.a,b),f=this;b=e.a;c=[Vc(c,e.type)];b="SELECT * FROM "+lf(e)+" WHERE "+b+" = ?";var g=V(a)+" SQL: "+b+" PARAMS: "+c;G(this.f,g);d.executeSql(b,c,function(b,c){if(0<c.rows.length){var d=c.rows.item(0);null!=d?(d=cf(d,e),T(a,d)):(F(f.f,"success no result: "+g),T(a,void 0))}else F(f.f,"success no result: "+g),T(a,void 0)},function(b,c){E(f.f,"error: "+g+" "+c.message);T(a,c,!0);return!1})};
q.Ub=function(a,b,c){function d(b,e){var p=k.a,t=[Vc(c[b],k.type)],s="SELECT * FROM "+lf(k)+" WHERE "+p+" = ?";G(f.f,"SQL: "+s+" PARAMS: "+t);e.executeSql(s,t,function(e,f){h++;if(0<f.rows.length){var m=f.rows.item(0);null!=m&&(g[b]=cf(m,k))}else g[b]=void 0;h==c.length?T(a,g):(m=b+10,m<c.length&&d(m,e))},function(e,k){h++;E(f.f,"error: "+s+" "+k.message);if(h==c.length)T(a,g);else{var m=b+10;m<c.length&&d(m,e)}return!1})}var e=a.a,f=this,g=[],h=0,k=W(this.a,b);if(0<c.length)for(b=0;10>b&&b<c.length;b++)d(b,
e);else F(f.f,"success"),T(a,[])};q.tb=function(a,b,c,d,e,f){qf(this,a,!1,b,void 0,c,d,e,f,!1)};q.Ta=function(a,b,c,d,e,f,g,h){qf(this,a,!1,b,c,d,e,f,g,h)};
q.Wb=function(a,b){function c(d,h){var m=b[d],p=W(e.a,m.a),t=v(m.id)?m.id.join("^|"):m.id instanceof Date?+m.id:m.id,m=p.a,t=[Vc(t,p.type)],s="SELECT * FROM "+lf(p)+" WHERE "+m+" = ?";G(e.f,"SQL: "+s+" PARAMS: "+t);h.executeSql(s,t,function(h,m){g++;if(0<m.rows.length){var n=m.rows.item(0);null!=n&&(f[d]=cf(n,p))}else f[d]=void 0;g==b.length?(G(e.f,"success "+s),T(a,f)):(n=d+10,n<b.length&&c(n,h))},function(b,c){T(a,c,!0);return!1})}var d=a.a,e=this,f=[],g=0;if(0<b.length)for(var h=0;10>h&&h<b.length;h++)c(h,
d);else G(this.f,"success"),T(a,[])};
q.hb=function(a,b){function c(d,g){function h(a){a="DELETE FROM  "+Ea("ydn.db.me:"+k.getName()+":"+a.getName());G(e.f,"SQL: "+a);g.executeSql(a,[])}var k=W(e.a,b[d]),n="DELETE FROM  "+lf(k);G(e.f,"SQL: "+n+" PARAMS: []");g.executeSql(n,[],function(g){d==b.length-1?(G(e.f,"success "+n),T(a,b.length)):c(d+1,g)},function(b,c){T(a,c,!0);return!1});for(var m=0,p=k.indexes.length;m<p;m++){var t=k.index(m);t.multiEntry&&h(t)}}var d=a.a,e=this;0<b.length?c(0,d):(G(this.f,"success"),T(a,0))};
q.dc=function(a,b){function c(h){if(h>=b.length)T(a,f,g);else{var k=W(e.a,b[h].a),n=Vc(b[h].id,k.type),m=" WHERE "+k.a+" = ?",p="DELETE FROM "+lf(k)+m,t=V(a)+" SQL: "+p+" PARAMS: "+[n];d.executeSql(p,[n],function(){f++;c(h)},function(a,b){E(e.f,"error: "+t+b.message);g=!0;c(h);return!1});h++;for(var p=function(b){b="DELETE FROM  "+Ea("ydn.db.me:"+k.getName()+":"+b.getName())+m;G(e.f,V(a)+NaN+b);d.executeSql(b,[n])},s=0,B=k.indexes.length;s<B;s++){var C=k.index(s);C.multiEntry&&p(C)}}}var d=a.a,e=
this,f=0,g=!1;G(this.f,V(a)+" removeByKeys: "+b.length+" keys");c(0)};q.wb=function(a,b,c){function d(b){b="DELETE FROM  "+Ea("ydn.db.me:"+f.getName()+":"+b.getName())+k;G(h.f,V(a)+NaN+b);e.executeSql(b,[g])}var e=a.a,f=W(this.a,b),g=Vc(c,f.type),h=this,k=" WHERE "+f.a+" = ?";b="DELETE FROM "+lf(f)+k;G(this.f,V(a)+" SQL: "+b+" PARAMS: "+[g]);e.executeSql(b,[g],function(b,c){T(a,c.rowsAffected)},function(b,c){T(a,c,!0);return!1});b=0;for(c=f.indexes.length;b<c;b++){var n=f.index(b);n.multiEntry&&d(n)}};
q.Nb=function(a,b,c){sf(this,a,b,void 0,c)};q.xb=function(a,b,c){sf(this,a,b,void 0,c)};q.cc=function(a,b,c,d){sf(this,a,b,c,d)};
function sf(a,b,c,d,e){function f(c){c="DELETE FROM  "+Ea("ydn.db.me:"+h.getName()+":"+c.getName())+m;G(a.f,V(b)+NaN+c);g.executeSql(c,n)}var g=b.a,h=W(a.a,c);c="DELETE FROM "+lf(h);var k=[],n=[],m="";null!=e&&(u(d)?(d=sd(h,d),Uc(d.b,d.type,e,n,k)):Uc(h.a,h.type,e,n,k),m=" WHERE "+n.join(" AND "));c+=m;var p=V(b)+" SQL: "+c+" PARAMS: "+k;G(a.f,p);g.executeSql(c,k,function(c,d){G(a.f,"success "+p);T(b,d.rowsAffected)},function(c,d){E(a.f,"error: "+p+d.message);T(b,d,!0);return!1});e=0;for(d=h.indexes.length;e<
d;e++)c=h.index(e),c.multiEntry&&f(c)}q.jb=function(a,b){function c(g){var h="SELECT COUNT(*) FROM "+Ea(b[g]);G(e.f,"SQL: "+h+" PARAMS: []");d.executeSql(h,[],function(d,e){var h=e.rows.item(0);f[g]=parseInt(h["COUNT(*)"],10);g++;g==b.length?T(a,f):c(g)},function(b,c){T(a,c,!0);return!1})}var d=a.a,e=this,f=[];0==b.length?(G(this.f,"success"),T(a,0)):c(0)};
q.za=function(a,b,c,d,e){var f=[];b=jf(W(this.a,b),f,tf,d,c,!1,e);G(this.f,V(a)+" SQL: "+b+" PARAMS: "+f);a.a.executeSql(b,f,function(b,c){var d=c.rows.item(0);T(a,uf(d))},function(b,c){T(a,c,!0);return!1})};function vf(a,b){qd.call(this,a,b)}D(vf,mf);q=vf.prototype;q.f=H("ydn.db.core.req.WebSql");q.Sb=function(a,b,c,d){wf(this,a,b,Zd,c,d)};q.Pb=function(a,b){wf(this,a,b,$d,1,0)};q.Vb=function(a,b,c,d){wf(this,a,b,cd,c,d)};
function wf(a,b,c,d,e,f){var g=b.a,h=V(b),k=[],n=h+" "+(d==Zd?"keys":d==cd?"values":d==tf?"count":"")+"ByIterator "+c;0<e&&(n+=" limit "+e);F(a.f,n);var m=bd(c,g,h,a,d);m.e=function(a){Mc(m);T(b,a,!0)};var p=0,t=!1;m.d=function(g){if(u(g)){var h=m.T(),C=m.ja();!t&&0<f?(m.advance(f),t=!0):(p++,k.push(d==Zd?g:c.d&&c.b?h:C),!u(e)||p<e?m.a[0].va(void 0):(Mc(m),F(a.f,"success:"+n+" "+k.length+" records"),g=$d==d?k[0]:k,T(b,g)))}else Mc(m),F(a.f,"success:"+n+" "+k.length+" records"),g=$d==d?k[0]:k,T(b,
g)}}q.ob=function(a,b,c,d,e,f,g,h){var k=W(this.a,c);u(d)&&(d=this.W(k,d));return new af(a,b,k,c,d,e,f,g,h)};function xf(a,b,c){I.call(this,0,c);this.e=a;this.O=[];this.b=[];this.w=[];this.a=null;this.ia=""}D(xf,I);q=xf.prototype;q.ia="";q.Xa=H("ydn.db.Request");function yf(a,b,c){a.a=b;a.ia=c;F(a.Xa,a+" BEGIN");if(b){for(c=0;c<a.b.length;c++)a.b[c][0].call(a.b[c][1],b);a.b.length=0}F(a.Xa,a+" END")}q.Lc=function(){return!!this.a};
q.kd=function(){if(this.a)if(F(this.Xa,this+" aborting"),fa(this.a.abort))this.a.abort();else if(fa(this.a.executeSql))this.a.executeSql("ABORT",[],aa(),ba(!0));else throw new Kd;else throw new id("No active transaction");};function T(a,b,c){var d=a.w.shift();c=!!c;d?d[0].call(d[1],b,c,function(b,c){T(a,b,c)}):c?a.t(b):a.v(b)}function zf(a,b,c){a.w.push([b,c])}function Y(a,b,c){a.a?b.call(c,a.a):a.b.push([b,c])}q.ld=function(a,b){this.O.push([a,b]);return this};
q.v=function(a){F(this.Xa,this+" SUCCESS");xf.u.v.call(this,a);Af(this)};q.t=function(a){F(this.Xa,this+" ERROR");xf.u.t.call(this,a);Af(this)};function Af(a){a.O.length=0;a.a=null;a.ia=a.ia}function V(a){var b="";a.ia&&(b=a.a?"!":"",b+="["+a.ia+"]");return a.e+b}function Bf(a,b){var c=new xf(a);T(c,b);return c}q.valueOf=l("ia");q.toString=function(){return"Request:"+V(this)};
q.toJSON=function(){var a=(this.ia||"").match(/B(\d+)T(\d+)(?:Q(\d+?))?(?:R(\d+))?/)||[];return{method:this.e?this.e.split(":"):[],branchNo:parseFloat(a[1]),transactionNo:parseFloat(a[2]),queueNo:parseFloat(a[3]),requestNo:parseFloat(a[4])}};function Cf(a){this.d=a;this.a=null;this.b=0}Cf.prototype.e=H("ydn.db.tr.Mutex");Cf.prototype.P=null;Cf.prototype.K=null;Cf.prototype.toString=function(){return"Mutex:"+("B"+this.d+"T"+this.b)+(this.a?"*":"")};function Df(a,b,c,d,e,f){this.j=a;this.c=0;this.i=d;this.g=c||"single";this.b=[];this.d=[];this.e=null;this.a=new Cf(b);this.Ib=f||0;this.h=!1}q=Df.prototype;q.Ib=0;q.H=H("ydn.db.tr.Serial");q.gb=function(){return this.a.b};
function Ef(a,b,c){if("multi"==a.g)a:if(a=a.a,!a.P||!a.mode||c!=a.mode&&(a.mode!=K||c!=J)||b.length>a.P.length)b=!1;else{for(c=0;c<b.length;c++)if(-1==a.P.indexOf(b[c])){b=!1;break a}b=!0}else if("repeat"==a.g)a:if(a=a.a,a.P&&a.mode&&c==a.mode&&a.P.length==b.length){for(c=0;c<b.length;c++)if(-1==a.P.indexOf(b[c])){b=!1;break a}b=!0}else b=!1;else b="all"==a.g?!0:!1;return b}q.type=function(){return this.j.i()};
function Ff(a){var b=0<a.b.length?a.b[0].P:null,c=0<a.b.length?a.b[0].mode:null;return null!=b&&null!=c?Ef(a,b,c):!1}function Gf(a,b,c,d,e){G(a.H,"push tx queue["+a.b.length+"]");a.b.push({mb:b,P:c,mode:d,K:e})}
q.pa=function(a,b,c,d){var e=x(b)?[b]:b;if(w(e)){if(0==e.length)throw new M("number of store names must more than 0");for(var f=0;f<e.length;f++){if(!x(e[f]))throw new M("store name at "+f+" must be string but found "+e[f]+" of type "+typeof e[f]);if(this.i&&!(0<=Ia(this.i,e[f])))throw new M('store name "'+f+e[f]+'" in scope of '+this);}}else throw new M("store names must be an array");var g=u(c)?c:J,h=this;if(this.a.a||(!this.j.a||!this.j.a.ab())&&this.h)Gf(this,a,b,g,d);else{var k=this.F();d&&this.d.push(d);
if(this.Ib&&this.gb()>=this.Ib)throw new Dc("Exceed maximum number of transactions of "+this.Ib);this.h=!0;this.j.ua(function(c){var d=h.a;d.a=c;d.c=!1;d.P=b;d.mode=g;d.b++;d.K=null;k=h.F();$b(h.H,k+" BEGIN "+R(b)+" "+g);a(h);for(a=null;Ff(h);)c=h.b.shift(),c.K&&h.d.push(c.K),G(h.H,"pop tx queue"+(h.b.length+1)+" reusing T"+h.gb()),c.mb()},e,g,function(a,b){$b(h.H,k+" "+a);var c=h.a;c.a?(c.a=null,c.P=null,c.mode=null,fa(c.K)&&c.K(a,b),c.K=null):E(c.e,c+" has no TX to be unlocked for "+a);for(c=0;c<
h.d.length;c++)(0,h.d[c])(a,b);h.d.length=0;(c=h.b.shift())&&h.pa(c.mb,c.P,c.mode,c.K);h.c=0})}};q.F=function(){return"B"+this.a.d+"T"+this.a.b};q.l=function(a,b,c,d){var e=new xf(a);a=c||J;var f=this;this.a.a&&!this.a.c&&Ef(this,b,a)?(b=this.a.a,this.c++,yf(e,b,this.F()+"R"+this.c),d&&this.d.push(d)):f.pa(function(){var a=f.a.a;f.c++;yf(e,a,f.F()+"R"+f.c)},b,a,d);return e};
q.ca=function(a,b,c,d,e){d=d||J;var f=this,g;if(f.a.a&&!f.a.c&&Ef(this,c,d)){var h=f.a.a;f.c++;g=f.F()+"R"+f.c;F(f.H,g+" BEGIN");b(h,g,function(b,c){f.e=h;c?(F(f.H,g+" ERROR"),a.t(b)):(F(f.H,g+" SUCCESS"),a.v(b));f.e=null});F(f.H,g+" END");b=null}else f.pa(function(){var c=f.a.a;f.c++;g=f.F()+"R"+f.c;F(f.H,g+" BEGIN");b(c,g,function(b,d){f.e=c;d?(F(f.H,g+" ERROR"),a.t(b)):(F(f.H,g+" SUCCESS"),a.v(b));f.e=null});F(f.H,g+" END");b=null},c,d,e)};q.getName=function(){return this.j.getName()};
q.toString=function(){return"Serial:"+this.F()+(this.e?"*":"")};function Hf(a,b){Df.call(this,a,b)}D(Hf,Df);Hf.prototype.H=H("ydn.db.tr.AtomicSerial");Hf.prototype.l=function(a,b,c){var d,e,f,g=Hf.u.l.call(this,a,b,c,function(a,b){g.a=null;if(d)"complete"!=a&&(f=!0,e=b),d(e,f);else{var c=new od;T(g,c,!0)}});zf(g,function(a,b,c){f=b;e=a;d=c});return g};
Hf.prototype.ca=function(a,b,c,d,e){var f,g,h=new I;h.ea(function(a){g=!1;f=a},function(a){g=!0;f=a});Hf.u.ca.call(this,h,b,c,d,function(b,c){if("complete"!=b)a.t(c);else if(!0===g)a.t(f);else if(!1===g)a.v(f);else{var d=new od;a.t(d)}e&&(e(b,c),e=void 0)})};Hf.prototype.toString=function(){return"Atomic"+Hf.u.toString.call(this)};function If(a,b,c){this.j=a;this.b=b;this.a=c;this.c=null}If.prototype.k=H("ydn.db.tr.DbOperator");If.prototype.d=function(){return this.a.gb()};function Z(a){a.c||(a.c=a.j.Xb());return a.c}If.prototype.toString=function(){return"TxStorage:"+this.j.getName()};function Jf(a,b,c){If.call(this,a,b,c)}D(Jf,If);q=Jf.prototype;q.k=H("ydn.db.crud.DbOperator");
q.count=function(a,b,c,d){var e,f,g,h;if(null!=a)if(v(a)){if(u(c)||u(b))throw new M("too many arguments.");f=a;for(var k=0;k<f.length;k++)if(!Kf(this.b,f[k]))throw new M('store name "'+f[k]+'" at '+k+" not found.");F(this.k,"countStores: "+R(f));e=this.a.l("count",f);Y(e,function(){Z(this).jb(e,f)},this)}else if(x(a)){k=W(this.b,a);if(!k)throw new M('store name "'+a+'" not found.');if(u(d)&&!ea(d))throw new TypeError('unique value "'+d+'" must be boolean, but found '+typeof d+".");f=[a];if(x(b))if(g=
b,z(c)){var n=Sc(c);if(n)throw new M("invalid key range: "+Ud(c)+" "+n);h=Qc(c)}else{if(null!=c)throw new M("invalid key range: "+Ud(c)+" of type "+typeof c);h=null}else if(z(b)||!u(b))if(z(b)){if(n=Sc(b))throw new M("invalid key range: "+Ud(b)+" "+n);h=Qc(b)}else{if(null!=b)throw new M("key range must be  an object but found "+Ud(b)+" of type "+typeof b);h=null}else throw new M("key range must be an object, but "+Ud(c)+" of type "+typeof b+" found.");F(this.k,"countKeyRange: "+a+" "+(g?g:"")+R(h));
e=this.a.l("count",f);Lf(k,e,arguments);Y(e,function(){Z(this).za(e,f[0],h,g,!!d)},this)}else throw new M("Invalid store name or store names.");else E(this.k,"count method requires store name(s)"),k=Mf(this.b),e=this.a.l("count",k),zf(e,function(a,b,c){if(b)c(a,!0);else{for(var d=b=0;d<a.length;d++)b+=a[d];c(b,!1)}},this),Y(e,function(){Z(this).jb(e,f)},this);return e};
q.Ka=function(a,b){var c;if(a instanceof pd){var d=a,e=d.a,f=W(this.b,e);if(!f){if(this.b.R())return Bf("get",void 0);throw new M("Store: "+e+" not found.");}var g=d.id;F(this.k,"getByKey: "+e+":"+g);c=this.a.l("get",[e]);Lf(f,c,arguments);Y(c,function(){Z(this).nb(c,e,g)},this)}else if(x(a)&&u(b)){var h=a,f=W(this.b,h);if(!f){if(this.b.R())return Bf("get",void 0);throw new M('Store name "'+h+'" not found.');}var k=b;F(this.k,"getById: "+h+":"+k);c=this.a.l("get",[h]);Lf(f,c,arguments);Y(c,function(){Z(this).nb(c,
h,k)},this)}else throw new M("get require valid input arguments.");return c};
q.keys=function(a,b,c,d,e,f){var g,h,k=null,n=!1,m=W(this.b,a);if(!x(a))throw new M("store name must be a string, but "+a+" of type "+typeof a+" is not.");if(!this.b.R()){if(!m)throw new M('store name "'+a+'" not found.');if(x(b)&&!sd(m,b))throw new M('index "'+b+'" not found in store "'+a+'".');}if(this.b.R()&&!m)return Bf("keys",[]);var p;if(x(b)){if(m=Sc(c))throw new M("invalid key range: "+c+" "+m);k=Qc(c);if(y(d))g=d;else{if(u(d))throw new M("limit must be a number");g=100}if(y(e))h=e;else{if(u(e))throw new M("offset must be a number");
h=0}if(u(f))if(ea)n=f;else throw new M("reverse must be a boolean");F(this.k,"keysByIndexKeyRange: "+a);p=this.a.l("keys:iter:index",[a]);Y(p,function(){Z(this).Rb(p,a,b,k,n,g,h,!1)},this)}else{if(z(b)){if(m=Sc(b))throw new M("invalid key range: "+Ud(b)+" "+m);k=Qc(b)}else{if(null!=b)throw new TypeError("invalid key range: "+Ud(b)+" of type "+typeof b);k=null}if(y(c))g=c;else{if(u(c))throw new M("limit must be a number");g=100}if(y(d))h=d;else{if(u(d))throw new M("offset must be a number");h=0}if(u(e))if(ea(e))n=
e;else throw new M("reverse must be a boolean");F(this.k,"keysByKeyRange: "+a);p=this.a.l("keys",[a]);Y(p,function(){Z(this).Tb(p,a,k,n,g,h)},this)}return p};
q.G=function(a,b,c,d,e,f){var g,h,k,n=!1;if(x(a)){var m=a,p=W(this.b,m);if(!p){if(this.b.R())return Bf("get",[]);throw new kd(m);}if(v(b)){if(u(c)||u(d))throw new M("too many input arguments");var t=b;F(this.k,"listByIds: "+m+" "+t.length+" ids");g=this.a.l("values:array",[m]);Lf(p,g,arguments);Y(g,function(){Z(this).Ub(g,m,t)},this)}else if(x(b)){var s=b;if(!Nf(p,s))throw new M('index "'+s+'" not found in store "'+m+'"');var B=Sc(c);if(B)throw new M("invalid key range: "+c+" "+B);var C=Qc(c);if(u(d))if(y(d))h=
d;else throw new M("limit must be a number.");else h=100;if(u(e))if(y(e))k=e;else throw new M("offset must be a number.");else k=0;if(ea(f))n=f;else if(u(f))throw new M("reverse must be a boolean, but "+f);F(this.k,"listByIndexKeyRange: "+m+":"+s);g=this.a.l("values:iter:index",[m]);Lf(p,g,arguments);Y(g,function(){Z(this).Ta(g,m,s,C,n,h,k,!1)},this)}else{C=null;if(z(b)){if(B=Sc(b))throw new M("invalid key range: "+b+" "+B);C=Qc(b)}else if(null!=b)throw new TypeError('expect key range object, but found "'+
Ud(b)+'" of type '+typeof b);if(u(c))if(y(c))h=c;else throw new M("limit must be a number, but "+c+" is "+typeof c);else h=100;if(u(d))if(y(d))k=d;else throw new M("offset must be a number, but "+d+" is "+typeof d);else k=0;if(u(e))if(ea(e))n=e;else throw new M("reverse must be a boolean, but "+e+" is "+typeof e);F(this.k,(C?"listByKeyRange: ":"listByStore: ")+m);g=this.a.l("values",[m]);Lf(p,g,arguments);Y(g,function(){Z(this).tb(g,m,C,n,h,k)},this)}}else if(v(a))if(a[0]instanceof pd){for(var p=
[],Q=a,B=0;B<Q.length;B++){var U=Q[B].a;if(!Kf(this.b,U)){if(this.b.R())return p=[],p[Q.length-1]=void 0,Bf("get",p);throw new M("Store: "+U+" not found.");}0<=Ia(p,U)||p.push(U)}F(this.k,"listByKeys: "+R(p)+" "+Q.length+" keys");g=this.a.l("values:keys",p);Y(g,function(){Z(this).Wb(g,Q)},this)}else throw new M("first argumentmust be array of ydn.db.Key, but "+a[0]+" of "+typeof a[0]+" found.");else throw new M("first argument "+a+" is invalid.");return g};
q.Fb=function(a,b,c){var d=x(a)?a:z(a)?a.name:void 0;if(!x(d))throw new M("store name "+d+" must be a string, but "+typeof d);var e=W(this.b,d);if(!e){if(!this.b.R())throw new M('store name "'+d+'" not found.');e=Of(z(a)?a:{name:d});F(this.k,"Adding object store: "+d);Pf(this.j,e)}else if(this.b.R()&&z(a)&&(a=Of(a),a=Qf(e,a)))throw new Kd(a);var f;if(!e)throw new M('store name "'+d+'" not found.');if(x(e.keyPath)&&u(c))throw new M("key must not be provided while the store uses in-line key.");if(!e.keyPath&&
!e.autoIncrement&&!u(c))throw new M("out-of-line key must be provided.");if(v(b)){F(this.k,"addObjects: "+d+" "+b.length+" objects");for(a=0;a<b.length;a++)Rf(e,b[a]);f=this.a.l("add:array",[d],K);Y(f,function(){Z(this).Kb(f,d,b,c)},this);e.c&&f.da(function(a){this.j.dispatchEvent(new Sf(Tf,this.j,e.getName(),a,b))},this)}else if(z(b))a="store: "+d+" key: "+Uf(e,b,c),F(this.k,"addObject: "+a),Rf(e,b),f=this.a.l("add",[d],K),Y(f,function(){Z(this).Jb(f,d,b,c)},this),e.c&&f.da(function(a){this.j.dispatchEvent(new Vf(Tf,
this.j,e.getName(),a,b))},this);else throw new M("record must be an object or array list of objects, but "+b+" of type "+typeof b+" found.");return f};function Wf(a,b){var c=x(b)?b:z(b)?b.name:void 0;if(!x(c))throw new M("store name must be a string");var d=W(a.b,c);if(!d){if(!a.b.R())throw new kd(c);d=Of(z(b)?b:{name:c});F(a.k,"Adding object store: "+c);Pf(a.j,d)}else if(a.b.R()&&z(b)){var e=Of(b);if(e=Qf(d,e))throw new Kd(e);}if(!d)throw new kd(c);return d}
q.La=function(a,b,c){var d,e=this;if(a instanceof pd){var f=a,g=f.a,h=W(this.b,g);if(!h)throw new M('store "'+g+'" not found.');if(h.keyPath){var k=Uf(h,b);if(null!=k){if(0!=L(k,f.id))throw new M("Inline key must be "+f+" but "+k+" found.");}else nf(h,b,f.id);return this.La(g,b)}return this.La(g,b,f.id)}if(v(a)){if(u(c))throw new M("too many arguments");var n=a;if(!u(b))throw new M("record values required");for(var m=b,f=[],g=0,h=n.length;g<h;g++){k=n[g].a;-1==Ia(f,k)&&f.push(k);var p=W(this.b,k);
if(!p)throw new M('store "'+k+'" not found.');p.keyPath&&nf(p,m[g],n[g].id)}F(this.k,"putByKeys: to "+R(f)+" "+m.length+" objects");for(g=0;g<m.length;g++)Rf(p,m[g]);d=this.a.l("put:keys",f,K);Lf(p,d,arguments);Y(d,function(){Z(e).$b(d,m,n)},this)}else if(x(a)||z(a)){var p=Wf(this,a),t=p.getName();if(p.keyPath&&u(c))throw new M("key must not be provided while the store uses in-line key.");if(!p.keyPath&&!p.autoIncrement&&!u(c))throw new M("out-of-line key must be provided.");if(v(b)){var s=b,B=c;
F(this.k,"putObjects: "+t+" "+s.length+" objects");for(g=0;g<s.length;g++)Rf(p,s[g]);d=this.a.l("put:array",[t],K);Lf(p,d,arguments);Y(d,function(){Z(this).bc(d,t,s,B)},this);p.c&&d.da(function(a){this.j.dispatchEvent(new Sf(Xf,this.j,t,a,s))},this)}else if(z(b)){var C=b,Q=c;F(this.k,"putObject: "+t+" "+Q);Rf(p,C);d=this.a.l("put",[t],K);Lf(p,d,arguments);Y(d,function(){Z(e).ac(d,t,C,Q)},this);p.c&&d.da(function(a){this.j.dispatchEvent(new Vf(Xf,this.j,t,a,C))},this)}else throw new M("put record value must be Object or array of Objects");
}else throw new M("the first argument of put must be store name, store schema or array of keys.");return d};
q.clear=function(a,b,c){if(u(c))throw new M("too many input arguments");var d;if(x(a)){c=W(this.b,a);if(!c)throw new M('store name "'+a+'" not found.');if(z(b)){var e=Qc(b);if(null===e)throw new M("clear method requires a valid non-null KeyRange object.");F(this.k,"clearByKeyRange: "+a+":"+R(e));d=this.a.l("clear",[a],K);Lf(c,d,[a,e]);Y(d,function(){Z(this).Nb(d,a,e)},this)}else{if(u(b))throw new M("clear method requires a valid KeyRange object as second argument, but found "+b+" of type "+typeof b);
F(this.k,"clearByStore: "+a);d=this.a.l("clear",[a],K);Y(d,function(){Z(this).hb(d,[a])},this)}}else if(!u(a)||v(a)&&x(a[0])){var f=a||Mf(this.b);F(this.k,"clearByStores: "+R(f));d=this.a.l("clear",f,K);Y(d,function(){Z(this).hb(d,f)},this)}else throw new M('first argument "'+a+'" is invalid.');return d};
q.Gb=function(a,b,c){var d;if(x(a)){var e=W(this.b,a);if(!e)throw new M('store name "'+a+'" not found.');if(u(c))if(x(b)){var f=sd(e,b);if(!f)throw new M("index: "+b+" not found in "+a);if(z(c)||null===c){var g=Qc(c);F(this.k,"removeByIndexKeyRange: "+a+":"+f.getName()+" "+a);d=this.a.l("rm:iter:index",[a],K);Y(d,function(){Z(this).cc(d,a,f.getName(),g)},this)}else throw new M("key range "+c+' is invalid type "'+typeof c+'".');}else throw new M('index name "'+b+'" must be a string, but '+typeof b+
" found.");else if(x(b)||y(b)||w(b)||b instanceof Date)F(this.k,"removeById: "+a+":"+b),d=this.a.l("rm",[a],K),Lf(e,d,[a,b]),Y(d,function(){Z(this).wb(d,a,b)},this),e.c&&d.da(function(b){this.j.dispatchEvent(new Vf(Yf,this.j,a,b,void 0))},this);else if(z(b))g=Qc(b),F(this.k,"removeByKeyRange: "+a+":"+R(g)),d=this.a.l("rm:iter",[a],K),Lf(e,d,[a,g]),Y(d,function(){Z(this).xb(d,a,g)},this),e.c&&d.da(function(b){this.j.dispatchEvent(new Sf(Yf,this.j,a,b,void 0))},this);else throw new M('Invalid key or key range "'+
b+'" of type '+typeof b);}else if(a instanceof pd){var h=a.a,e=W(this.b,h);d=this.a.l("rm",[h],K);Lf(e,d,[h,a.id]);Y(d,function(){Z(this).wb(d,h,a.id)},this)}else if(v(a)){c=[];for(var e=0,k=a.length;e<k;e++){if(!(a[e]instanceof pd))throw new M("key list element at "+e+" of "+k+' must be yn.db.Key, but "'+Ud(a[e])+'" ('+da(a[e])+") is not ydn.db.Key.");var n=a[e].a;-1==Ia(c,n)&&c.push(n)}if(1>c.length)throw new M('at least one valid key required in key list "'+Ud(a)+'"');d=this.a.l("rm:keys",c,K);
Y(d,function(){Z(this).dc(d,a)},this)}else throw new M('first argument requires store name, key (ydn.db.Key) or list of keys (array) , but "'+Ud(a)+'" ('+da(a)+") found.");return d};q.toString=function(){return"DbOperator:"+this.j.getName()};function Zf(a,b,c){If.call(this,a,b,c)}D(Zf,Jf);q=Zf.prototype;q.k=H("ydn.db.core.DbOperator");q.Ka=function(a,b){if(a instanceof O){var c=a.M,d=W(this.b,c);if(!d)throw new M('store "'+c+'" not found.');var e=a.W();if(u(e)&&!Nf(d,e))throw new M('index "'+e+'" not found in store "'+c+'".');F(this.k,"getByIterator:"+a);var f=this.a.l("get:iter",[c]);Y(f,function(){Z(this).Pb(f,a)},this);return f}return Zf.u.Ka.call(this,a,b)};
q.keys=function(a,b,c,d,e){if(a instanceof O){var f=100;if(y(b)){if(f=b,1>f)throw new M("limit must be a positive value, but "+b);}else if(u(b))throw new M("limit must be a number,  but "+b);if(u(c))throw new M("offset must not be specified");F(this.k,"keysByIterator:"+a);var g=this.a.l("keys:iter",a.stores());Y(g,function(){Z(this).Sb(g,a,f)},this);return g}return Zf.u.keys.call(this,a,b,c,d,e)};
q.count=function(a,b,c){if(a instanceof O){if(u(b)||u(c))throw new M("too many arguments.");F(this.k,"countKeyRange:"+a);var d=this.a.l("count",a.stores());Y(d,function(){Z(this).za(d,a.M,a.Qc(),a.W(),a.Wa())},this);return d}return Zf.u.count.call(this,a,b,c)};
q.G=function(a,b,c,d,e,f){if(a instanceof O){var g;if(y(b)){if(g=b,1>g)throw new M("limit must be a positive value, but "+g);}else if(u(b))throw new M("limit must be a number, but "+b);if(u(c))throw new M("offset must not be specified");F(this.k,"listByIterator:"+a);var h=this.a.l("values:iter",a.stores());Y(h,function(){Z(this).Vb(h,a,g)},this);return h}return Zf.u.G.call(this,a,b,c,d,e,f)};
q.Cc=function(a,b){var c=new I;if(u(b)){if(!v(b))throw new TypeError("Iterator argument must be an array.");for(var d=0;d<b.length;d++)if(!(b[d]instanceof O))throw new TypeError("Iterator at "+d+" must be cursor range iterator.");}var e;e=b?b:null;for(var f=[],d=0;d<e.length;d++)for(var g=e[d].stores(),h=0;h<g.length;h++)0<=Ia(f,g[h])||f.push(g[h]);G(this.k,this+": scan for "+e.length+" iterators on "+f);var k=this;this.a.ca(c,function(b,c,d){function f(){for(var a=0,d=0;d<e.length;d++){var p=bd(e[d],
b,c,Z(k));p.e=g;p.d=ma(h,a);S[d]=p;ta[a]=d;a++}U=e.length}function g(a){for(var b=0;b<S.length;b++)Mc(S[b]);Qa(S);F(k.k,C+" error");d(a,!0)}function h(b,c){if(Q)throw new zd;xa++;var f=xa===U,g=ta[b],m=e[g],n=S[g],g=n.T(),n=n.ja();Na[b]=c;Oa[b]=m.d?m.b?g:n:m.b?c:n;if(f){var t;t=a instanceof Hd?a.c(Na,Oa):a(Na,Oa);f=[];m=[];g=[];n=[];if(v(t))for(var s=0;s<t.length;s++)!0===t[s]?g[s]=1:!1===t[s]?n[s]=!0:m[s]=t[s];else if(null===t)f=[];else if(u(t))if(z(t)){f=["advance","continue","continuePrimary",
"restart"];for(s in t)if(!(0<=Ia(f,s)))throw new Dc('Unknown attribute "'+s+'" in cursor advancement object');f=t.continuePrimary||[];m=t["continue"]||[];g=t.advance||[];n=t.restart||[]}else throw new Ld("scan callback output");else for(f=[],s=0;s<e.length;s++)u(ta[s])&&(g[s]=1);for(s=xa=t=0;s<e.length;s++)null!=f[s]||(u(m[s])||null!=n[s]||null!=g[s])||xa++;for(s=0;s<e.length;s++)if(null!=f[s]||u(m[s])||null!=n[s]||null!=g[s]){var B=ta[s];if(!u(B))throw new Ld(s+" is not an iterator.");var B=e[B],
Ib=S[s];if(null==Na[s]){var Se=s+"/"+e.length;if(null!=g[s])throw new dd(Ib+" "+Se+" must not advance "+g[s]+" steps");if(u(m[s]))throw new dd(Ib+" "+Se+" must not continue to key "+m[s]);if(null!=f[s])throw new dd(Ib+" "+Se+" must not continue to primary key "+f[s]);}Na[s]=void 0;Oa[s]=void 0;if(null!=n[s])B=Ib,B.N=!1,B.a[0].fb(void 0,void 0);else if(u(m[s]))Ib.a[0].va(m[s]);else if(null!=f[s])Ib.a[0].eb(f[s]);else if(null!=g[s])Ib.advance(1);else throw new zd(B+": has no action");t++}if(0==t){for(f=
0;f<S.length;f++)Mc(S[f]);Q=!0;Qa(S);F(k.k,"success "+C);d(void 0)}}}var C=c+" "+k+" scanning";G(k.k,C);var Q=!1,U,ta=[],Na=[],Oa=[],S=[],xa=0;a instanceof Hd?a.b(e,function(){f()})||f():f()},f,J);return c};
q.Bc=function(a,b,c){if(!(b instanceof O))throw new M("Second argument must be cursor range iterator.");if(!W(this.b,b.M))throw new M('Store "'+b.M+'" not found.');c=c||J;var d=this,e=new I;F(this.k,"open:"+c+" "+b);this.a.ca(e,function(c,e,h){G(d.k,e+" iterating "+b);var k=bd(b,c,e,Z(d));k.e=function(a){h(a,!0)};k.d=function(b){if(null!=b){var c=a(k);!0===c?(k.N=!1,k.a[0].fb(void 0,void 0)):z(c)?!0===c.restart?(b=c["continue"],c=c.continuePrimary,k.N=!1,k.a[0].fb(c,b)):null!=c["continue"]?k.a[0].va(c["continue"]):
null!=c.continuePrimary?k.a[0].eb(c.continuePrimary):(Mc(k),h(void 0)):k.advance(1)}else Mc(k),h(void 0)}},b.stores(),c);return e};q.map=function(a,b){for(var c=this,d=a.stores(),e,f=0;e=d[f];f++)if(!e)throw new M('Store "'+e+'" not found.');e=new I;G(this.k,"map:"+a);this.a.ca(e,function(d,e,f){G(c.k,e+" iterating "+a);var n=bd(a,d,e,Z(c));n.e=function(a){f(a,!1)};n.d=function(c){null!=c?(b(a.d?a.b?c:n.T():a.b?c:n.ja()),n.advance(1)):(f(void 0),b=null)}},d,J);return e};
q.Db=function(a,b,c){for(var d=this,e=a.stores(),f,g=0;f=e[g];g++)if(!f)throw new M('Store "'+f+'" not found.');f=new I;var h=z(c)?Td(R(c)):c;F(this.k,"reduce:"+a);this.a.ca(f,function(c,e,f){var g=bd(a,c,e,Z(d));g.e=function(a){f(a,!0)};var t=0;g.d=function(c){null!=c?(h=b(h,a.d?a.b?c:g.T():a.b?c:g.ja(),t++),g.advance(1)):f(h)}},e,J);return f};I.prototype.done=I.prototype.da;I.prototype.fail=I.prototype.jc;I.prototype.then=I.prototype.ea;I.prototype.always=I.prototype.Ic;Ce.prototype.addEventListener=Ce.prototype.Qb;var Tf="created",Yf="deleted",Xf="updated";function $f(a,b){ce.call(this,a,b)}D($f,ce);$f.prototype.e=l("c");function ag(a,b,c,d,e){ce.call(this,a,b);this.version=c;this.Ec=d;this.vc=e}D(ag,$f);q=ag.prototype;q.name="ReadyEvent";q.version=NaN;q.Ec=NaN;q.vc=null;q.od=l("version");q.Oc=l("Ec");q.Nc=l("vc");function bg(a,b,c){ce.call(this,c||"error",a);this.error=b}D(bg,$f);bg.prototype.name="ErrorEvent";bg.prototype.error=null;bg.prototype.g=l("error");function cg(a,b){bg.call(this,a,b,"fail")}
D(cg,bg);cg.prototype.name="FailEvent";function Vf(a,b,c,d,e){ce.call(this,a,b);this.c=c;this.key=d;this.value=e}D(Vf,$f);Vf.prototype.name="RecordEvent";Vf.prototype.g=l("key");Vf.prototype.h=l("value");function Sf(a,b,c,d,e){ce.call(this,a,b);this.c=c;this.keys=d;this.G=e}D(Sf,$f);Sf.prototype.name="StoreEvent";Sf.prototype.na=l("keys");Sf.prototype.pb=l("G");function dg(a,b,c,d,e,f){u(e)||(e=v(a)?a.join(", "):a);if(null!=a&&!x(a)&&!w(a))throw new M("index keyPath for "+e+" must be a string or array, but "+a+" is "+typeof a);v(a)&&Object.freeze&&Object.freeze(a);!u(a)&&u(e)&&(a=e);this.keyPath=a;this.e=w(this.keyPath);this.name=e;this.type=eg(b);if(u(b)){if(!u(this.type))throw new M("type invalid in index: "+this.name);if(v(this.keyPath))throw new M('composite key for store "'+this.name+'" must not specified type');}this.unique=!!c;this.multiEntry=!!d;
this.g=x(this.type)?this.type:fg;this.c=x(e)?e:v(a)?this.keyPath.join(","):a;this.b=Ea(this.c);this.a=this.e||this.multiEntry?null:this.keyPath.split(".");this.d=f||null}function gg(a,b){if(null!=b){if(w(a.keyPath)){for(var c=[],d=0,e=a.keyPath.length;d<e;d++){var f=qc(b,a.keyPath[d]);c[d]=f}return c}return qc(b,a.keyPath)}}function pf(a,b,c){for(var d=0;d<a.a.length;d++)d==a.a.length-1?b[a.a[d]]=c:z(b[a.a[d]])||(b[a.a[d]]={})}var of="DATE",fg="TEXT";
function Vc(a,b){if(b==of){if(a instanceof Date)return+a}else return u(b)?a:sc(a)}function bf(a,b){return b==of?new Date(a):u(b)?a:vc(a)}var hg=["BLOB",of,"INTEGER","NUMERIC",fg];function eg(a){if(x(a))return a=Ia(hg,a),hg[a]}dg.prototype.getName=l("name");dg.prototype.toJSON=function(){return{name:this.name,keyPath:this.keyPath,type:this.type,unique:this.unique,multiEntry:this.multiEntry}};
dg.prototype.Na=function(){var a=v(this.keyPath)?Sa(this.keyPath):this.keyPath;return new dg(a,this.type,this.unique,this.multiEntry,this.name,this.d)};function rd(a,b){return null!=a||null!=b?null!=a?null!=b?w(a)&&w(b)?Ua(a,b)?null:"expect: "+a+", but: "+b:ig(a,b)?null:"expect: "+a+", but: "+b:"keyPath: "+a+" no longer defined":"newly define "+b:null}
dg.prototype.hint=function(a){if(!a)return this;var b=v(this.keyPath)?Sa(this.keyPath):this.keyPath,c=this.type;u(a.type)||"TEXT"!=c||(c=void 0);return new dg(b,c,this.unique,this.multiEntry,a.name)};function jg(a,b,c,d,e,f,g){this.name=a;if(!x(this.name))throw new M("store name must be a string");this.keyPath=u(b)?b:null;this.e=w(this.keyPath);if(null!==this.keyPath&&!x(this.keyPath)&&!this.e)throw new M("keyPath must be a string or array");this.autoIncrement=c;var h;if(null!=d){h=eg(d);if(!u(h))throw new M('type "'+d+'" for primary key in store "'+this.name+'" is invalid.');if(this.e)throw new M('composite key for store "'+this.name+'" must not specified type');}this.type=null!=h?h:this.autoIncrement?
"INTEGER":void 0;this.d=x(this.keyPath)?this.keyPath.split("."):[];this.indexes=e||[];this.c=!!f;this.h=!!g;this.i=x(this.type)?this.type:fg;this.b=v(this.keyPath)?this.keyPath.join(","):x(this.keyPath)?this.keyPath:"_ROWID_";this.a=Ea(this.b);this.g=[]}jg.prototype.c=!1;jg.prototype.h=!1;jg.prototype.toJSON=function(){for(var a=[],b=0;b<this.indexes.length;b++)a.push(this.indexes[b].toJSON());return{name:this.name,keyPath:this.keyPath,autoIncrement:this.autoIncrement,type:this.type,indexes:a}};
function Of(a){var b="name keyPath autoIncrement type indexes dispatchEvents fixed Sync".split(" "),c;for(c in a)if(a.hasOwnProperty(c)&&-1==Ia(b,c))throw new M('Unknown attribute "'+c+'"');b=[];c=a.indexes||[];if(v(c))for(var d=0;d<c.length;d++){var e;e=c[d];var f="name unique type keyPath multiEntry generator".split(" "),g=void 0;for(g in e)if(e.hasOwnProperty(g)&&-1==Ia(f,g))throw new M("Unknown field: "+g+" in "+R(e));e=new dg(e.keyPath,e.type,e.unique,e.multiEntry,e.name,e.generator);u(e.keyPath)&&
e.keyPath===a.keyPath||b.push(e)}return new jg(a.name,a.keyPath,a.autoIncrement,"undefined"===a.type||"null"===a.type?void 0:a.type,b,a.dispatchEvents,a.fixed)}var Zd=1,cd=2,$d=3,tf=4;function jf(a,b,c,d,e,f,g){a=ef(a,b,c,d,e,f,g);b="";0!=c&&(b+="SELECT "+a.select);b+=" FROM "+a.Aa;a.p&&(b+=" WHERE "+a.p);a.group&&(b+=" GROUP BY "+a.group);a.$&&(b+=" ORDER BY "+a.$);return b}
function ef(a,b,c,d,e,f,g){var h={select:"",Aa:"",p:"",group:"",$:""},k=a.b,n=a.a,m=null;d!==k&&x(d)&&(m=sd(a,d));var p=!!m,t=d||k,s=Ea(t),B=p?m.type:a.type,C=p&&m.multiEntry;h.Aa=lf(a);c===tf?h.select="COUNT("+n+")":c===Zd?(h.select=n,null!=d&&d!=k&&(h.select+=", "+s)):h.select="*";d=g?"DISTINCT ":"";k=[];C?(C=Ea("ydn.db.me:"+a.getName()+":"+m.getName()),h.select=c===tf?"COUNT("+d+C+"."+s+")":c===Zd?lf(a)+"."+n+", "+C+"."+s:lf(a)+".*, "+C+"."+s+" AS "+t,h.Aa=C+" INNER JOIN "+lf(a)+" USING ("+n+")",
null!=e&&(Uc(C+"."+s,B,e,k,b),0<k.length&&(h.p=h.p?h.p+(" AND "+k.join(" AND ")):k.join(" AND ")))):null!=e&&(Uc(s,B,e,k,b),0<k.length&&(h.p=h.p?h.p+(" AND "+k.join(" AND ")):k.join(" AND ")));p&&(!m.unique&&g)&&(h.group=s);a=f?"DESC":"ASC";h.$=s+" "+a;p&&(h.$+=", "+n+" "+a);return h}jg.prototype.Na=function(){return Of(this.toJSON())};jg.prototype.index=function(a){return this.indexes[a]||null};function sd(a,b){return Ma(a.indexes,function(a){return a.name==b})}
function Nf(a,b){return b===a.keyPath?!0:La(a.indexes,function(a){return a.name==b})}function lf(a){return Ea(a.name)}
jg.prototype.hint=function(a){if(!a)return this;var b=this.autoIncrement,c=v(this.keyPath)?Sa(this.keyPath):this.keyPath,d=this.type,e=Ka(this.indexes,function(a){return a.Na()});u(a.type)||"TEXT"!=d||(d=void 0);v(a.keyPath)&&(x(c)&&c==a.keyPath.join(","))&&(c=Sa(a.keyPath));for(var f=0,g=a.indexes.length;f<g;f++)if(a.indexes[f].e)for(var h=a.indexes[f].getName(),k=e.length-1;0<=k;k--)if(0<=h.indexOf(e[k].getName())){e[k]=a.indexes[f].Na();break}for(f=0;f<e.length;f++)(g=sd(a,e[f].getName()))&&(e[f]=
e[f].hint(g));return new jg(a.name,c,b,d,e)};jg.prototype.getName=l("name");function Uf(a,b,c){if(!a.keyPath&&null!=c)return c;if(a.e){c=[];for(var d=0;d<a.keyPath.length;d++)c.push(qc(b,a.keyPath[d]));return c}if(a.keyPath)return Xa(b,a.d)}function nf(a,b,c){for(var d=0;d<a.d.length;d++){var e=a.d[d];if(d==a.d.length-1){b[e]=c;break}u(b[e])||(b[e]={});b=b[e]}}
function kf(a,b,c){var d=[],e=[];c=u(c)?c:Uf(a,b);u(c)&&(e.push(a.a),d.push(Vc(c,a.type)));for(var f=0;f<a.indexes.length;f++){var g=a.indexes[f];if(!g.multiEntry&&g.name!==a.keyPath&&"_default_"!=g.name){var h=gg(g,b);null!=h&&(d.push(Vc(h,g.type)),e.push(g.b))}}a.h||(d.push(R(b)),e.push("_default_"));a=[];for(f=d.length-1;0<=f;f--)a[f]="?";return{kc:e,xc:a,G:d,key:c}}
function Qf(a,b){if(!b)return"missing store: "+a.name;if(a.name!=b.name)return"store name, expect: "+a.name+", but: "+b.name;var c=rd(a.keyPath,b.keyPath);if(c)return"keyPath, "+c;if(u(a.autoIncrement)&&u(b.autoIncrement)&&a.autoIncrement!=b.autoIncrement)return"autoIncrement, expect:  "+a.autoIncrement+", but: "+b.autoIncrement;if(a.indexes.length!=b.indexes.length)return"indexes length, expect:  "+a.indexes.length+", but: "+b.indexes.length;if(u(a.type)&&u(b.type)&&(w(a.type)?!Ua(a.type,b.type):
a.type!=b.type))return"data type, expect:  "+a.type+", but: "+b.type;for(c=0;c<a.indexes.length;c++){var d=sd(b,a.indexes[c].name),e;e=a.indexes[c];if(d)if(e.name!=d.name)e="name, expect: "+e.name+", but: "+d.name;else{var f=rd(e.keyPath,d.keyPath);e=f?"keyPath, "+f:null!=e.unique&&null!=d.unique&&e.unique!=d.unique?"unique, expect: "+e.unique+", but: "+d.unique:null!=e.multiEntry&&null!=d.multiEntry&&e.multiEntry!=d.multiEntry?"multiEntry, expect: "+e.multiEntry+", but: "+d.multiEntry:u(e.type)&&
u(d.type)&&(w(e.type)?!Ua(e.type,d.type):e.type!=d.type)?"data type, expect: "+e.type+", but: "+d.type:""}else e="no index for "+e.name;if(0<e.length)return'index "'+a.indexes[c].name+'" '+e}return""}function Rf(a,b){if(b)for(var c=0;c<a.indexes.length;c++){var d=a.indexes[c],e=b;if(d.d){var f=d.d(e),g=typeof f;if("string"==g||"number"==g||"array"==g||"undefined"==g||f instanceof Date){for(g=0;g<d.a.length-1;g++)z(e[d.a[g]])||(e[d.a[g]]={});e[d.a[d.a.length-1]]=f}}}}
function Lf(a,b,c){for(var d=0;d<a.g.length;d++)if(void 0!==d)a.g[d](b,c)};function kg(a,b){if(!a||qa(a))throw new M("store_name must be provided for primary full text index");if(!b||qa(b))throw new M("index_name must be provided for primary full text index");this.a=a};function lg(a,b,c){this.name=a;this.indexes=b;this.a=c||"";if(-1==["","en","fr"].indexOf(this.a))throw new M('Unsupported lang "'+c+" for full text search index "+a);}lg.prototype.getName=l("name");lg.prototype.count=function(){return this.indexes.length};lg.prototype.index=function(a){return this.indexes[a]};
function mg(a){var b=["name","sources","lang"],c;for(c in a)if(a.hasOwnProperty(c)&&-1==Ia(b,c))throw new M("Unknown field: "+c+" in "+R(a));if(!v(a.sources))throw new M("indexes require for full text search index "+a.name+", but "+a.sources+" of type "+typeof a.sources+" found.");b=a.sources.map(function(a){var b=["storeName","keyPath","weight"],c;for(c in a)if(a.hasOwnProperty(c)&&-1==Ia(b,c))throw new M("Unknown field: "+c+" in "+Ud(a));return new kg(a.storeName,a.keyPath)});return new lg(a.name,
b,a.lang)};function ng(a,b){var c,d,e=b;if(z(a)){d=a;c=["version","stores","fullTextCatalogs"];for(var f in d)if(d.hasOwnProperty(f)&&-1==Ia(c,f))throw new M("Unknown field: "+f+" in schema.");c=d.version;var e=[],g=d.stores||[];if(!v(g))throw new M("stores must be array");for(f=0;f<g.length;f++){var h=Of(g[f]);if(-1!=Pa(e,function(a){return a.name==h.name}))throw new M('duplicate store name "'+h.name+'".');e.push(h)}}else x(a)?c=0==a.length?void 0:parseFloat(a):y(a)&&(c=a);if(u(c)){if(!y(c)||0>c)throw new M("Invalid version: "+
c+" ("+a+")");isNaN(c)&&(c=void 0)}if(u(b)&&(!v(b)||0<b.length&&!(b[0]instanceof jg)))throw new M("stores");this.version=c;this.Da=!u(this.version);this.stores=e||[];c=[];if(d&&d.fullTextCatalogs)for(f=0;f<d.fullTextCatalogs.length;f++)e=mg(d.fullTextCatalogs[f]),c[f]=e,W(this,e.getName())||(g=[new dg("k",fg),new dg("v",fg)],e=new jg(e.getName(),"id",!1,void 0,g),this.stores.push(e));this.a=c}q=ng.prototype;
q.toJSON=function(){var a=Ka(this.stores,function(a){return a.toJSON()}),b={};b.stores=a;u(this.version)&&(b.version=this.version);return b};q.Da=!1;q.R=ba(!1);function Mf(a){return Ka(a.stores,function(a){return a.name})}q.ra=function(a){return this.stores[a]||null};q.count=function(){return this.stores.length};function W(a,b){return Ma(a.stores,function(a){return a.name==b})}function Kf(a,b){return La(a.stores,function(a){return a.name==b})}
function og(a,b,c){if(!b||a.stores.length!=b.stores.length)return"Number of store: "+a.stores.length+" vs "+b.stores.length;for(var d=0;d<a.stores.length;d++){var e=W(b,a.stores[d].name),e=e&&c?e.hint(a.stores[d]):e,e=Qf(a.stores[d],e);if(0<e.length)return'store: "'+a.stores[d].name+'" '+e}return""};function pg(a,b){ng.call(this,a,b)}D(pg,ng);pg.prototype.R=ba(!0);function qg(a,b){a.stores.push(b)};function ig(a,b){var c;c=c||{};if(null!=a&&null!=b){if(w(a)&&w(b)){if(a.length!=b.length)return!1;for(var d=0;d<a.length;d++)if(-1==Ma(b,function(b){return ig(b,a[d])}))return!1;return!0}if(w(a))return 1==a.length&&ig(a[0],b);if(w(b))return 1==b.length&&ig(b[0],a);if(z(a)&&z(a)){for(var e in a)if(a.hasOwnProperty(e)&&!c[e]){var f=ig(a[e],b[e]);if(!f)return!1}for(e in b)if(b.hasOwnProperty(e)&&!c[e]&&(f=ig(a[e],b[e]),!f))return!1;return!0}return a===b}return!1}
function uf(a){if(a)for(var b in a)if(a.hasOwnProperty(b))return a[b]};function rg(){};function sg(){}D(sg,rg);sg.prototype.Pa=function(){var a=0;cb(this.xa(!0),function(){a++});return a};sg.prototype.clear=function(){var a=db(this.xa(!0)),b=this;Ja(a,function(a){b.C.removeAttribute(tg(a));ug(b)})};function vg(a,b){if(pb&&!(pb&&9<=Db)){wg||(wg=new eb);var c=wg;this.C=Object.prototype.hasOwnProperty.call(c.b,a)?c.b[a]:void 0;this.C||(b?this.C=document.getElementById(b):(this.C=document.createElement("userdata"),this.C.addBehavior("#default#userData"),document.body.appendChild(this.C)),fb(wg,a,this.C));this.ec=a;try{this.C.load(this.ec)}catch(d){this.C=null}}}D(vg,sg);var xg={".":".2E","!":".21","~":".7E","*":".2A","'":".27","(":".28",")":".29","%":"."},wg=null;q=vg.prototype;q.C=null;q.ec=null;
function tg(a){return"_"+encodeURIComponent(a).replace(/[.!~*'()%]/g,function(a){return xg[a]})}q.Pa=function(){return yg(this).attributes.length};q.xa=function(a){var b=0,c=yg(this).attributes,d=new ab;d.a=function(){if(b>=c.length)throw $a;var d=c[b++];if(a)return decodeURIComponent(d.nodeName.replace(/\./g,"%")).substr(1);d=d.nodeValue;if(!x(d))throw"Storage mechanism: Invalid value was encountered";return d};return d};
q.clear=function(){for(var a=yg(this),b=a.attributes.length;0<b;b--)a.removeAttribute(a.attributes[b-1].nodeName);ug(this)};function ug(a){try{a.C.save(a.ec)}catch(b){throw"Storage mechanism: Quota exceeded";}}function yg(a){return a.C.XMLDocument.documentElement};function zg(a,b,c){a=["ydn.db",a];u(b)&&(a.push(b),u(c)&&(a.push(c),u(void 0)&&a.push(sc(void 0))));return a.join("^|")};function Ag(a){this.I=a||Bg}function Bg(a,b){return String(a)<String(b)?-1:String(a)>String(b)?1:0}q=Ag.prototype;q.B=null;q.I=null;q.Z=null;q.Y=null;
function Cg(a,b){if(null==a.B)a.B=new Dg(b),a.Z=a.B,a.Y=a.B;else{var c=null;Eg(a,function(a){var e=null;0<this.I(a.value,b)?(e=a.left,null==a.left&&(c=new Dg(b,a),a.left=c,a==this.Z&&(this.Z=c))):0>this.I(a.value,b)&&(e=a.right,null==a.right&&(c=new Dg(b,a),a.right=c,a==this.Y&&(this.Y=c)));return e});c&&(Eg(a,function(a){a.count++;return a.parent},c.parent),Fg(a,c.parent))}}
function Gg(a,b){Eg(a,function(a){var d=null;0<this.I(a.value,b)?d=a.left:0>this.I(a.value,b)?d=a.right:Hg(this,a);return d})}q.clear=function(){this.Y=this.Z=this.B=null};q.contains=function(a){var b=!1;Eg(this,function(c){var d=null;0<this.I(c.value,a)?d=c.left:0>this.I(c.value,a)?d=c.right:b=!0;return d});return b};q.Pa=function(){return this.B?this.B.count:0};q.pb=function(){var a=[];Ig(this,function(b){a.push(b)});return a};
function Ig(a,b){if(a.B){var c,d=c=Jg(a);for(c=c.left?c.left:c;null!=d;)if(null!=d.left&&d.left!=c&&d.right!=c)d=d.left;else{if(d.right!=c&&b(d.value))break;var e=d,d=null!=d.right&&d.right!=c?d.right:d.parent;c=e}}}function Eg(a,b,c){for(c=c?c:a.B;c&&null!=c;)c=b.call(a,c)}
function Fg(a,b){Eg(a,function(a){var b=a.left?a.left.height:0,e=a.right?a.right.height:0;1<b-e?(a.left.right&&(!a.left.left||a.left.left.height<a.left.right.height)&&Kg(this,a.left),Lg(this,a)):1<e-b&&(a.right.left&&(!a.right.right||a.right.right.height<a.right.left.height)&&Lg(this,a.right),Kg(this,a));b=a.left?a.left.height:0;e=a.right?a.right.height:0;a.height=Math.max(b,e)+1;return a.parent},b)}
function Kg(a,b){Mg(b)?(b.parent.left=b.right,b.right.parent=b.parent):Ng(b)?(b.parent.right=b.right,b.right.parent=b.parent):(a.B=b.right,a.B.parent=null);var c=b.right;b.right=b.right.left;null!=b.right&&(b.right.parent=b);c.left=b;b.parent=c;c.count=b.count;b.count-=(c.right?c.right.count:0)+1}
function Lg(a,b){Mg(b)?(b.parent.left=b.left,b.left.parent=b.parent):Ng(b)?(b.parent.right=b.left,b.left.parent=b.parent):(a.B=b.left,a.B.parent=null);var c=b.left;b.left=b.left.right;null!=b.left&&(b.left.parent=b);c.right=b;b.parent=c;c.count=b.count;b.count-=(c.left?c.left.count:0)+1}
function Hg(a,b){if(null!=b.left||null!=b.right){var c=null,d;if(null!=b.left){d=Og(a,b.left);Eg(a,function(a){a.count--;return a.parent},d);if(d!=b.left){if(d.parent.right=d.left)d.left.parent=d.parent;d.left=b.left;d.left.parent=d;c=d.parent}d.parent=b.parent;d.right=b.right;d.right&&(d.right.parent=d);b==a.Y&&(a.Y=d)}else{d=Jg(a,b.right);Eg(a,function(a){a.count--;return a.parent},d);if(d!=b.right){if(d.parent.left=d.right)d.right.parent=d.parent;d.right=b.right;d.right.parent=d;c=d.parent}d.parent=
b.parent;d.left=b.left;d.left&&(d.left.parent=d);b==a.Z&&(a.Z=d)}d.count=b.count;Mg(b)?b.parent.left=d:Ng(b)?b.parent.right=d:a.B=d;Fg(a,c?c:d)}else Eg(a,function(a){a.count--;return a.parent},b.parent),Mg(b)?(b.parent.left=null,b==a.Z&&(a.Z=b.parent),Fg(a,b.parent)):Ng(b)?(b.parent.right=null,b==a.Y&&(a.Y=b.parent),Fg(a,b.parent)):a.clear()}function Jg(a,b){if(!b)return a.Z;var c=b;Eg(a,function(a){var b=null;a.left&&(b=c=a.left);return b},b);return c}
function Og(a,b){if(!b)return a.Y;var c=b;Eg(a,function(a){var b=null;a.right&&(b=c=a.right);return b},b);return c}function Dg(a,b){this.value=a;this.parent=b?b:null;this.count=1}Dg.prototype.left=null;Dg.prototype.right=null;Dg.prototype.height=1;function Ng(a){return!!a.parent&&a.parent.right==a}function Mg(a){return!!a.parent&&a.parent.left==a};function Pg(a){this.I=a||Bg}D(Pg,Ag);function Je(a,b,c){if(a.B){var d;if(c instanceof Dg)d=c;else if(c){if(Eg(a,function(a){var b=null;0<this.I(a.value,c)?(b=a.left,d=a):0>this.I(a.value,c)?b=a.right:d=a;return b}),!d)return}else d=Jg(a);a=d;for(var e=d.left?d.left:d;null!=a;)if(null!=a.left&&a.left!=e&&a.right!=e)a=a.left;else{if(a.right!=e&&b(a))return;var f=a;a=null!=a.right&&a.right!=e?a.right:a.parent;e=f}b(null)}}
function Ie(a,b,c){if(a.B){var d;if(c instanceof Dg)d=c;else if(c){if(Eg(a,la(function(a){var b=null;0<this.I(a.value,c)?b=a.left:(0>this.I(a.value,c)&&(b=a.right),d=a);return b},a)),!d)return}else d=Og(a);a=d;for(var e=d.right?d.right:d;null!=a;)if(null!=a.right&&a.right!=e&&a.left!=e)a=a.right;else{if(a.left!=e&&b(a))return;var f=a;a=null!=a.left&&a.left!=e?a.left:a.parent;e=f}b(null)}};function X(a,b){this.key=a;this.a=b}X.prototype.toString=function(){return"ydn.db.con.simple.Node:"+this.key+(null!=this.a?":"+this.a:"")};function Qg(a,b){var c=L(a.key,b.key);return 0===c?null!=a.a?null!=b.a?L(a.a,b.a):1:null!=b.a?-1:0:c};function Rg(a,b,c){this.g=a;this.c=b;this.d=c;this.a={};a=this.d.keyPath;this.b=v(a)?a.join(","):a||"_ROWID_";this.a[this.b]=null;this.e=zg(this.g,this.d.getName(),this.b)+"^|"}
function Oe(a,b){var c=b||a.b;if(!a.a[c]){a.a[c]=new Pg(Qg);for(var d=a.c.length,e=0;e<d;e++){var f=a.c.key(e);if(null!==f&&0==f.lastIndexOf(a.e,0)){var g=vc(f.substr(a.e.length));if(c==a.b)Cg(a.a[c],new X(g));else{var h=a.c.getItem(f);if(null!==h)if(f=sd(a.d,c),h=Td(h),h=gg(f,h),f.multiEntry){if(v(h))for(f=0;f<h.length;f++)Cg(a.a[c],new X(h[f],g))}else Cg(a.a[c],new X(h,g))}}}}return a.a[c]}
function Sg(a,b,c){for(var d in a.a){var e=a.a[d];if(e)if(d==a.b)Gg(e,new X(b));else{var f=sd(a.d,d),f=qc(c,f.keyPath);Gg(e,new X(b,f))}}}function Tg(a){for(var b in a.a){var c=a.a[b];c&&c.clear()}a.a={}}
function Re(a,b,c,d){if(null==b&&(a.d.keyPath&&(b=Uf(a.d,c)),a.d.autoIncrement&&null==b)){b=a.e+sc(void 0);var e=Td(a.c.getItem(b));e.key_count||(e.key_count=0);e.key_count++;a.c.setItem(b,R(e));b=e.key_count}if(d)if(a.a[a.b]){if(a.a[a.b].contains(sc(b)))return null}else if(null!==a.c.getItem(a.e+sc(b)))return null;a.c.setItem(a.e+sc(b),R(c));d=b;for(var f in a.a)if(e=a.a[f])if(f==a.b)Cg(e,new X(d));else{var g=sd(a.d,f),g=qc(c,g.keyPath);null!=g&&Cg(e,new X(d,g))}return b}
function We(a,b){var c=a.e+sc(b),d=a.c.getItem(c);if(null===d)return 0;a.c.removeItem(c);c=Td(d);Sg(a,b,c);return 1}Rg.prototype.clear=function(){Tg(this);Xe(this)};function Le(a,b){var c=a.c.getItem(a.e+sc(b)),d=void 0;if(null!==c)for(var d=Td(c),c=0,e=a.d.indexes.length;c<e;c++){var f=a.d.index(c);if(f.type==of){var g=gg(f,d);g&&pf(f,d,new Date(g))}}return d}Rg.prototype.getName=function(){return this.d.getName()};
function Ye(a,b,c){b=b||a.b;a=Oe(a,b);var d=null,e=null,f=0,g=!1,h=!1;null!=c&&(null!=c.lower&&(d=new X(c.lower)),null!=c.upper&&(e=new X(c.upper)),g=c.lowerOpen,h=c.upperOpen);Je(a,function(a){if(null!=a&&(a=a.value,!g||null==d||0!=L(a.key,d.key))){if(null!=e&&(a=L(a.key,e.key),1===a||0===a&&h))return!0;f++}},d);return f}
function Xe(a,b){var c=Oe(a,a.b),d=null,e=null,f=0,g=[],h=[],k=!1,n=!1;null!=b&&(null!=b.lower&&(d=new X(b.lower)),null!=b.upper&&(e=new X(b.upper)),k=b.lowerOpen,n=b.upperOpen);Je(c,function(b){if(null!=b&&(b=b.value,!k||null==d||0!=Qg(b,d))){if(null!=e){var c=Qg(b,e);if(1===c||0===c&&n)return!0}var c=a.e+sc(b.key),t=a.c.getItem(c);null!==t&&(a.c.removeItem(c),f++,10>g.length&&(g.push(b.key),h.push(Td(t))))}},d);if(10>g.length)for(c=0;c<g.length;c++)Sg(a,g[c],h[c]);else Tg(a);return f}
function Ve(a,b,c,d,e,f,g,h){function k(c){if(c&&(B++,!(B<g))){var d=c.value;if(e){if(Q&&null!=s&&0==L(d.key,s.key))return;if(null!=t&&(c=L(d.key,t.key),-1===c||0===c&&C))return!0}else{if(C&&null!=t&&0==L(d.key,t.key))return;if(null!=s&&(c=L(d.key,s.key),1===c||0===c&&Q))return!0}c=d.key;if(!h||null!=m&&L(m,c))d=p?d.a:c,b?n.push(d):(d=Le(a,d),n.push(d));m=c;if(u(f)&&n.length>=f)return!0}}var n=[],m;c=c||a.b;var p=c!=a.b;c=Oe(a,c);var t=null,s=null;u(g)||(g=0);var B=-1,C=!1,Q=!1;null!=d&&(null!=d.lower&&
(t=p&&e?new X(d.lower,"\uffff"):new X(d.lower)),null!=d.upper&&(s=p&&!e?new X(d.upper,"\uffff"):new X(d.upper)),C=d.lowerOpen,Q=d.upperOpen);e?Ie(c,k,s):Je(c,k,t);return n}Rg.prototype.na=function(a,b,c,d,e){return Ve(this,!0,a,b,c,d,e)};Rg.prototype.toString=function(){return"ydn.db.con.simple.Store:"+this.g+":"+this.d.getName()};function Ug(a,b){this.j=a;this.a=b}function Me(a,b,c){Ee(function(){b.call(c,this.j)},0,a);return function(){a.a("complete",null);a.a=null;a.j=null}};function Vg(){this.clear()}q=Vg.prototype;q.ib=function(){return this};q.setItem=function(a,b){u(this.a[a])||(this.keys.push(a.toString()),this.length=this.keys.length);this.a[a]=b};q.getItem=function(a){return u(this.a[a])?this.a[a]:null};q.removeItem=function(a){delete this.a[a];Ra(this.keys,a.toString());this.length=this.keys.length};q.length=0;q.key=function(a){a=this.keys[a];return u(a)?this.a[a]:null};q.clear=function(){this.a={};this.keys=[];this.length=0};function Wg(a){this.d=a||new Vg;this.b=NaN}q=Wg.prototype;q.Ac=H("ydn.db.con.SimpleStorage");q.Bb=l("b");
q.Ia=function(a,b){function c(a,b){Ee(function(){b?(F(d.Ac,d+" opening fail"),e.t(b)):(F(d.Ac,d+" version "+d.Bb()+" open"),e.v(a))})}var d=this,e=new I;this.j=this.d.ib(a);this.ma=a;this.a=b;this.c={};var f=zg(this.ma);this.b=NaN;var g=Td(this.j.getItem(f));u(g.version)&&!y(g.version)&&(g.version=NaN);if(g)if(g=new ng(g),og(this.a,g))if(!this.a.Da&&!isNaN(g.version)&&this.a.version>g.version)c(NaN,new gd("existing version "+g.version+" is larger than "+this.a.version));else{var h=this.a.version;
this.b=u(h)?h:g.version+1;for(h=0;h<this.a.count();h++)var k=this.a.ra(h);if(this.a instanceof pg)for(h=0;h<g.count();h++)k=g.ra(h),qg(this.a,k);h=this.a.toJSON();h.version=this.b||NaN;this.j.setItem(f,R(h));c(g.version||NaN)}else{for(h=0;h<this.a.count();h++)k=this.a.ra(h);this.b=g.version||NaN;c(this.b)}else g=b.toJSON(),this.b=1,g.version=this.b,this.j.setItem(f,R(g)),c(NaN);return e};q.ab=function(){return!!this.ma};q.Cb=aa();q.bb=aa();q.ta=ba("memory");q.Ab=aa();
q.lb=function(a,b,c,d){a(new Ug(this,function(a,b){d(a,b)}))};q.Q=function(a){Ee(function(){var b=zg(this.ma),b=this.j.getItem(b),b=new ng(b);a(b)},0,this)};function Ne(a,b){var c=W(a.a,b);if(c)a.c[b]||(a.c[b]=new Rg(a.ma,a.j,c));else throw new Ec('store name "'+b+'" not found.');return a.c[b]}q.toString=function(){return"SimpleStorage:"+this.ta()+":"+(this.ma+":"+this.b)};function Xg(){Wg.call(this,this)}D(Xg,Wg);Xg.prototype.ib=function(a){return new Yg(a)};Xg.prototype.ta=ba("userdata");function Yg(a){this.j=new vg(a);this.length=this.keys().length}q=Yg.prototype;q.length=0;q.clear=function(){this.j.clear();this.a=[]};q.keys=function(){this.a||(this.a=[],cb(this.j,function(a){this.a.push(a)},this));return this.a};q.key=function(a){return this.keys()[a]};q.setItem=function(a,b){this.a&&this.a.push(a);var c=this.j;c.C.setAttribute(tg(a),b);ug(c)};
q.getItem=function(a){a=this.j.C.getAttribute(tg(a));if(!x(a)&&null!==a)throw"Storage mechanism: Invalid value was encountered";return u(a)?a:null};q.removeItem=function(a){this.a=null;var b=this.j;b.C.removeAttribute(tg(a));ug(b)};function Zg(){Wg.call(this,this)}D(Zg,Wg);Zg.prototype.ib=function(){return window.localStorage};Zg.prototype.ta=ba("localstorage");function $g(a){var b=new Zg,c=new pg;b.Ia(a,c);b.Q(function(a){for(var c=0;c<a.stores.length;c++)Ne(b,a.stores[c].name).clear()})}function ah(){Wg.call(this,this)}D(ah,Wg);ah.prototype.ib=function(){return window.sessionStorage};ah.prototype.ta=ba("sessionstorage");
function bh(a){var b=new ah,c=new pg;b.Ia(a,c);b.Q(function(a){for(var c=0;c<a.stores.length;c++)Ne(b,a.stores[c].name).clear()})};function ch(a,b){u(a)&&5242880<a&&E(this.m,"storage size request ignored, use Quota Management API instead");this.r=null;this.Va=b||NaN}q=ch.prototype;
q.Ia=function(a,b){function c(a,c,d){F(e.m,(d?"changing":"upgrading")+" version to "+a.version+" from "+g);for(d=0;d<b.stores.length;d++)dh(e,a,c,b.stores[d]);c=a.objectStoreNames;var f=c.length;for(d=0;d<f;d++)Kf(b,c[d])||(a.deleteObjectStore(c[d]),F(e.m,"store: "+c[d]+" deleted."))}function d(a,b){f.Oa?E(e.m,"database already set."):u(b)?(E(e.m,b?b.message:"Error received."),e.r=null,f.t(b)):(e.r=a,e.r.onabort=function(a){G(e.m,e+": abort");e.bb(a.target.error)},e.r.onerror=function(a){G(e.m,e+
": error");e.bb(a.target.error)},e.r.onversionchange=function(a){G(e.m,e+" closing connection for onversionchange to: "+a.version);e.r&&(e.r.onabort=null,e.r.onblocked=null,e.r.onerror=null,e.r.onversionchange=null,e.r.close(),e.r=null,e.Cb(Error(a.type)))},f.v(parseFloat(g)))}var e=this,f=new I,g=void 0,h=b.version;F(e.m,"Opening database: "+a+" ver: "+(b.Da?"auto":h));var k;k=u(h)?pc.open(a,h):pc.open(a);k.onsuccess=function(f){var h=f.target.result;u(g)||(g=h.version);F(e.m,"Database: "+h.name+
", ver: "+h.version+" opened.");if(b.Da)e.Q(function(f){if(b instanceof pg)for(var g=0;g<f.stores.length;g++)Kf(b,f.stores[g].getName())||qg(b,f.stores[g].Na());f=og(b,f);if(0<f.length){F(e.m,"Schema change require for difference in "+f);var k=y(h.version)?h.version+1:1;if("IDBOpenDBRequest"in r){h.close();var n=pc.open(a,k);n.onupgradeneeded=function(a){a=a.target.result;F(e.m,"re-open for version "+a.version);c(a,n.transaction,!1)};n.onsuccess=function(a){d(a.target.result)};n.onerror=function(){F(e.m,
e+": fail.");d(null)}}else{var p=h.setVersion(k+"");p.a=function(a){E(e.m,"migrating from "+h.version+" to "+k+" failed.");d(null,a)};p.onsuccess=function(){p.transaction.oncomplete=U;c(h,p.transaction,!0)};var U=function(){var b=pc.open(a);b.onsuccess=function(a){a=a.target.result;F(e.m,e+": OK.");d(a)};b.onerror=function(){F(e.m,e+": fail.");d(null)}};null!=p.transaction&&(p.transaction.oncomplete=U)}}else d(h)},void 0,h);else if(b.version>h.version){var k=h.setVersion(b.version);k.a=function(a){E(e.m,
"migrating from "+h.version+" to "+b.version+" failed.");d(null,a)};k.onsuccess=function(){c(h,k.transaction,!0)}}else b.version==h.version?F(e.m,"database version "+h.version+" ready to go"):E(e.m,"connected database version "+h.version+" is higher than requested version."),e.Q(function(a){a=og(b,a);0<a.length?(F(e.m,a),d(null,new Gc("different schema: "+a))):d(h)},void 0,h)};k.onupgradeneeded=function(a){a=a.target.result;g=NaN;F(e.m,"upgrade needed for version "+a.version);c(a,k.transaction,!1)};
k.onerror=function(c){Zb(e.m,'open request to database "'+a+'" '+(u(b.version)?" with version "+b.version:"")+" cause error of "+k.error.name);d(null,c)};k.onblocked=function(c){Zb(e.m,"database "+a+" "+b.version+" block, close other connections.");d(null,c)};y(this.Va)&&!isNaN(this.Va)&&Ee(function(){"done"!=k.readyState&&(Zb(e.m,e+": database state is still "+k.readyState),d(null,new od("connection timeout after "+e.Va)))},this.Va);return f};q.Va=18E4;q.Cb=aa();q.bb=aa();q.ta=ba("indexeddb");
q.ab=function(){return!!this.r};q.m=H("ydn.db.con.IndexedDb");q.r=null;q.Bb=function(){return this.r?parseFloat(this.r.version):void 0};
q.Q=function(a,b,c){c=c||this.r;if(u(b)){if(null===b){if(0==c.objectStoreNames.length){a(new ng(c.version));return}throw new zd;}c=b.db}else{b=[];for(var d=c.objectStoreNames.length-1;0<=d;d--)b[d]=c.objectStoreNames[d];if(0==b.length){a(new ng(c.version));return}b=c.transaction(b,J)}for(var e=c.objectStoreNames,f=[],g=e.length,d=0;d<g;d++){for(var h=b.objectStore(e[d]),k=[],n=0,m=h.indexNames.length;n<m;n++){var p=h.index(h.indexNames[n]);k[n]=new dg(p.keyPath,void 0,p.unique,p.multiEntry,p.name)}f[d]=
new jg(h.name,h.keyPath,h.autoIncrement,void 0,k)}b=new ng(c.version,f);a(b)};
function dh(a,b,c,d){function e(){var a={autoIncrement:!!d.autoIncrement};null!=d.keyPath&&(a.keyPath=d.keyPath);try{return b.createObjectStore(d.getName(),a)}catch(c){if("InvalidAccessError"==c.name)throw new jd("creating store for "+d.getName()+" of keyPath: "+d.keyPath+" and autoIncrement: "+d.autoIncrement);if("ConstraintError"==c.name)throw new Gc("creating store for "+d.getName());throw c;}}G(a.m,"Creating Object Store for "+d.getName()+" keyPath: "+d.keyPath);if(b.objectStoreNames.contains(d.getName()))if(c=
c.objectStore(d.getName()),rd(d.keyPath||"",c.keyPath||""))b.deleteObjectStore(d.getName()),E(a.m,"store: "+d.getName()+" deleted due to keyPath change."),c=e();else if(ea(c.autoIncrement)&&ea(d.autoIncrement)&&c.autoIncrement!=d.autoIncrement)b.deleteObjectStore(d.getName()),E(a.m,"store: "+d.getName()+" deleted due to autoIncrement change."),c=e();else{for(var f=c.indexNames,g=0,h=0,k=0,n=0;n<d.indexes.length;n++){var m=d.indexes[n],p=!1;if(f.contains(m.name)){var t=c.index(m.name),s=null!=t.unique&&
null!=m.unique&&t.unique!=m.unique,B=null!=t.multiEntry&&null!=m.multiEntry&&t.multiEntry!=m.multiEntry,t=null!=t.keyPath&&null!=m.keyPath&&!!rd(t.keyPath,m.keyPath);if(s||B||t)c.deleteIndex(m.name),p=!0,g--,k++}else p=!0;p&&(m.unique||m.multiEntry?(p={unique:m.unique,multiEntry:m.multiEntry},c.createIndex(m.name,m.keyPath,p)):c.createIndex(m.name,m.keyPath),g++)}for(n=0;n<f.length;n++)Nf(d,f[n])||(c.deleteIndex(f[n]),h++);G(a.m,"Updated store: "+c.name+", "+g+" index created, "+h+" index deleted, "+
k+" modified.")}else{c=e();for(n=0;n<d.indexes.length;n++)m=d.indexes[n],G(a.m,"Creating index: "+m.name+" multiEntry: "+m.multiEntry),m.unique||m.multiEntry?(p={unique:m.unique,multiEntry:m.multiEntry},c.createIndex(m.name,m.keyPath,p)):c.createIndex(m.name,m.keyPath);G(a.m,"Created store: "+c.name+" keyPath: "+c.keyPath)}}
q.lb=function(a,b,c,d){var e=this.r;if(!b){b=[];for(var f=e.objectStoreNames.length-1;0<=f;f--)b[f]=e.objectStoreNames[f]}0==b.length?a(null):(b=e.transaction(b,c),b.oncomplete=function(a){d("complete",a)},b.onabort=function(a){d("abort",a)},a(b),a=null)};q.Ab=function(){G(this.m,this+" closing connection");this.r.close()};q.toString=function(){return"IndexedDB:"+(this.r?this.r.name+":"+this.r.version:"")};function eh(a){this.a=u(a)?a:4194304}q=eh.prototype;
q.Ia=function(a,b){function c(b,c){var f=b.version?parseInt(b.version,10):0,f=c.Da?isNaN(f)?1:f+1:c.version;G(e.q,a+": changing version from "+b.version+" to "+f);var g=!1,h=0;b.changeVersion(b.version,f+"",function(a){e.Q(function(b){g=!0;for(var d=0;d<c.count();d++){var f=W(b,c.ra(d).getName()),f=f?f.hint(c.ra(d)):null;fh(e,a,c.ra(d),function(a){a&&h++},f)}for(d=0;d<b.count();d++)f=b.ra(d),Kf(c,f.getName())||(c instanceof pg?qg(c,f):(f="DROP TABLE "+lf(f),F(e.q,f),a.executeSql(f,[],aa(),function(a,
b){throw b;})))},a,b)},function(a){throw a;},function(){if(g){var f=".";h!=c.stores.length&&(f=" but unexpected stores exists.");G(e.q,a+":"+b.version+" ready"+f);d(b)}else E(e.q,a+": changing version voided.")})}function d(a,b){u(b)?(e.D=null,g.t(b)):(e.D=a,g.v(parseFloat(f)))}var e=this,f=NaN,g=new I,h=null;try{h=r.openDatabase(a,"",a,this.a)}catch(k){if("SECURITY_ERR"==k.name)E(this.q,"SECURITY_ERR for opening "+a),h=null,this.hc=new md(k);else throw k;}if(h){var f=h.version,n="database "+a+(0==
h.version.length?"":" version "+h.version);null!=b.version&&b.version==h.version?($b(e.q,"Existing "+n+" opened as requested."),d(h)):this.Q(function(a){(a=og(b,a,!0))?(0==h.version.length?$b(e.q,"New "+n+" created."):b.Da?$b(e.q,"Existing "+n+" opened and schema change for "+a):$b(e.q,"Existing "+n+" opened and  schema change to version "+b.version+" for "+a),c(h,b)):($b(e.q,"Existing "+n+" with same schema opened."),d(h))},null,h)}else d(null,this.hc);return g};q.ta=ba("websql");q.hc=null;q.D=null;
q.q=H("ydn.db.con.WebSql");q.Cb=aa();q.bb=aa();
function gh(a){var b=a.i,c="CREATE TABLE IF NOT EXISTS "+lf(a)+" (",d=a.a,c=c+(d+" "+b+" PRIMARY KEY ");a.autoIncrement&&(c+=" AUTOINCREMENT ");for(var c=c+" ,_default_ BLOB",e=[],f=[d],g=0,h=a.indexes.length;g<h;g++){var k=a.index(g),n="";if(k.multiEntry)n=k.unique?" UNIQUE ":"",k="CREATE TABLE IF NOT EXISTS "+Ea("ydn.db.me:"+a.getName()+":"+k.getName())+" ("+d+" "+b+", "+k.b+" "+k.g+n+")",e.push(k);else{k.unique&&(n=" UNIQUE ");var m=k.keyPath;"BLOB"!=k.type&&x(m)&&(m="CREATE "+n+" INDEX IF NOT EXISTS "+
Ea(a.getName()+"-"+k.getName())+" ON "+lf(a)+" ("+Ea(m)+")",e.push(m));m=k.b;-1==f.indexOf(m)&&(c+=", "+m+" "+k.g+n,f.push(m))}}e.unshift(c+")");return e}q.Bb=function(){return this.D?parseFloat(this.D.version):void 0};
q.Q=function(a,b,c){function d(a,b){throw b;}function e(b,c){if(c&&c.rows){for(var d=0;d<c.rows.length;d++){var e=c.rows.item(d);if("__WebKitDatabaseInfoTable__"!=e.name&&"sqlite_sequence"!=e.name&&"table"==e.type){var t="sql"in e?e.sql:void 0;G(f.q,"Parsing table schema from SQL: "+t);for(var s=t.substr(t.indexOf("("),t.lastIndexOf(")")).match(/(?:"[^"]*"|[^,])+/g),B=void 0,C,t=[],Q=!1,U=!1,ta=0;ta<s.length;ta++){var Na=s[ta].match(/\w+|"[^"]+"/g),Oa=Ka(Na,function(a){return a.toUpperCase()}),S=
Ba(Na[0],'"'),Na=eg(Oa[1]);if(-1!=Oa.indexOf("PRIMARY")&&-1!=Oa.indexOf("KEY")){C=Na;if(x(S)&&!qa(S)&&"_ROWID_"!=S){var xa=S.split(","),B=S;1<xa.length&&(B=xa,C=void 0)}-1!=Oa.indexOf("AUTOINCREMENT")&&(Q=!0)}else if("_ROWID_"!=S)if("_default_"==S)U=!0;else{var vd="UNIQUE"==Oa[2];0==S.lastIndexOf(e.tbl_name+"-",0)&&(S=S.substr(e.tbl_name.length+1));Oa=new dg(S,Na,vd);t.push(Oa)}}if(0==e.name.lastIndexOf("ydn.db.me:",0)){var sb=e.name.split(":");if(3<=sb.length){var Jb=sb[1],B=new dg(sb[2],Na,vd,!0),
s=Pa(t,function(a){return a.getName()==sb[2]});0<=s?t[s]=B:t.push(B);s=Pa(h,function(a){return a.getName()===Jb});0<=s?(ta=h[s],h[s]=new jg(ta.getName(),ta.keyPath,Q,C,t,void 0,!U)):h.push(new jg(Jb,void 0,!1,void 0,[B]));G(f.q,'multi entry index "'+B.getName()+'" found in '+Jb+(-1==s?"*":""))}else E(f.q,'Invalid multiEntry store name "'+e.name+'"')}else ta=Pa(h,function(a){return a.getName()===e.name}),0<=ta?(s=h[ta].index(0),t.push(s),h[ta]=new jg(e.name,B,Q,C,t,void 0,!U)):(t=new jg(e.name,B,Q,
C,t,void 0,!U),h.push(t))}}d=new ng(g,h);a(d)}}var f=this,g=(c=c||this.D)&&c.version?parseFloat(c.version):void 0,g=isNaN(g)?void 0:g,h=[];b?b.executeSql("SELECT * FROM sqlite_master",[],e,d):c.readTransaction(function(b){f.Q(a,b,c)},function(a){Zb(f.q,"opening tx: "+a.message);throw a;},e)};
function fh(a,b,c,d,e){function f(a){b.executeSql(a,[],function(){g++;g==h.length&&(d(!0),d=null)},function(b,e){g++;g==h.length&&(d(!1),d=null);throw new ld(e,"SQLError creating table: "+c.name+" "+e.message+' for executing "'+a);})}var g=0,h=gh(c),k="Create";if(e){e=Qf(c,e);if(0==e.length){G(a.q,"same table "+c.name+" exists.");d(!0);d=null;return}k="Modify";E(a.q,"table: "+c.name+" has changed by "+e+" additionallly TABLE ALTERATION is not implemented, dropping old table.");h.unshift("DROP TABLE IF EXISTS "+
Ea(c.name))}G(a.q,k+" table: "+c.name+": "+h.join(";"));for(a=0;a<h.length;a++)f(h[a])}q.ab=function(){return!!this.D};q.Ab=aa();q.lb=function(a,b,c,d){function e(a){G(h.q,h+": Tx "+c+" request cause error.");d("abort",a)}function f(){d("complete",{type:"complete"})}function g(b){a(b)}var h=this;null===this.D&&(a(null),d("abort",this.hc));c==J?this.D.readTransaction(g,e,f):c==nc?this.D.changeVersion(this.D.version,this.D.version+1+"",g,e,f):this.D.transaction(g,e,f)};
function hh(a){function b(){c.q.log(Rb,"all tables in "+a+" deleted.",void 0)}var c=new eh,d=new pg;F(c.q,"deleting websql database: "+a);d=c.Ia(a,d);d.da(function(){c.lb(function(b){b.executeSql('SELECT * FROM sqlite_master WHERE type = "table"',[],function(d,g){if(g&&g.rows){for(var h=g.rows.length,k=0,n=0;n<h;n++){var m=g.rows.item(n);"__WebKitDatabaseInfoTable__"!=m.name&&"sqlite_sequence"!=m.name&&(k++,G(c.q,"deleting table: "+m.name),b.executeSql("DROP TABLE "+m.name))}F(c.q,k+' tables deleted from "'+
a+'"')}},function(a,b){throw b;})},[],K,b)});d.jc(function(){E(c.q,"Connecting "+a+" failed.")})}q.toString=function(){return"WebSql:"+(this.D?":"+this.D.version:"")};/*
 Copyright 2012 YDN Authors, Yathit. All Rights Reserved.
 Licensed under the Apache License, Version 2.0 (the "License");.
*/
function P(a,b,c){Ce.call(this);c=c||{};var d="autoSchema connectionTimeout size mechanisms policy isSerial".split(" "),e;for(e in c)if(c.hasOwnProperty(e)&&-1==Ia(d,e))throw new M('Unknown attribute "'+e+'" in options.');if(c.mechanisms){if(!v(c.mechanisms))throw new M("mechanisms attribute must be an array but "+da(c.mechanisms)+" found.");for(e=0;e<c.mechanisms.length;e++)if(!(0<=Ia(ih,c.mechanisms[e])))throw new M('Invalid mechanism "'+c.mechanisms[e]+'"');}this.Tc=c.mechanisms||ih;this.tc=c.size;
this.Uc=u(c.connectionTimeout)?c.connectionTimeout:3E4;this.yc=u(c.yc)?c.yc:!1;this.a=null;this.h=[];this.sb=!1;if(b instanceof ng)c=b;else if(z(b))for(c=c.autoSchema||!u(b.stores)?new pg(b):new ng(b),d=b.stores?b.stores.length:0,e=0;e<d;e++){var f=W(c,b.stores[e].name);b.stores[e].Sync&&E(this.e,"Synchronization option for "+f.getName()+" ignored.")}else c=new pg;this.b=c;u(a)&&this.w(a)}D(P,Ce);P.prototype.e=H("ydn.db.con.Storage");
P.prototype.Xc=function(a){if(u(a)){var b=function(b){a(b.toJSON())};if(this.a)this.a.Q(b);else{var c=this;this.ua(function(a){c.a.Q(b,a)},null,J)}}return this.b?this.b.toJSON():null};function Pf(a,b){var c=b instanceof jg?b:Of(b),d=b.name,e=W(a.b,d);if(0==Qf(c,e).length)(new I).v(!1);else if(e=e?"update":"add",a.b instanceof pg)qg(a.b,c),a.a?(a.a.Ab(),a.a=null,jh(a)):(new I).v(!1);else throw new Gc("Cannot "+e+" store: "+d+". Not auto schema generation mode.");}
P.prototype.w=function(a){if(this.a)throw new Dc("Already connected with "+this.d);this.d=a;jh(this)};A("ydn.db.con.Storage.prototype.setName",P.prototype.w);P.prototype.getName=l("d");var ih="indexeddb websql localstorage sessionstorage userdata memory".split(" ");function kh(a,b){return"indexeddb"==b?new ch(a.tc,a.Uc):"websql"==b?new eh(a.tc):"localstorage"==b?new Zg:"sessionstorage"==b?new ah:"memory"==b?new Wg:"userdata"==b?new Xg:null}
function jh(a){function b(b,e){b?(G(a.e,a+": ready."),a.Rc=NaN,d.bb=function(b){a.dispatchEvent(new bg(a,b))},d.Cb=function(b){a.dispatchEvent(new cg(a,b));a.a=null},Ee(function(){lh(a,e);mh(a)}),c.v(e)):(E(a.e,a+": database connection fail "+e.name),Ee(function(){a.dispatchEvent(new cg(a,e));if(a.h){a.e.log(Rb,"Purging "+a.h.length+" transactions request.",void 0);for(var b;b=a.h.shift();)b.K&&b.K("error",e)}}),c.t(e))}for(var c=new I,d=null,e=a.Tc,f=0;f<e.length;f++){var g=e[f].toLowerCase();if("indexeddb"==
g&&pc){d=kh(a,g);break}else if("websql"==g&&fa(r.openDatabase)){d=kh(a,g);break}else if("localstorage"==g&&window.localStorage){d=kh(a,g);break}else if("sessionstorage"==g&&window.sessionStorage){d=kh(a,g);break}else if("memory"==g){d=kh(a,g);break}else if("userdata"==g){d=kh(a,g);break}}null===d?(e=new Fc("No storage mechanism found."),b(!1,new ag("ready",a,NaN,NaN,e))):d.Ia(a.d,a.b).ea(function(a){this.a=d;b(!0,new ag("ready",this,parseFloat(d.Bb()),parseFloat(a),null))},function(a){E(this.e,this+
": opening fail");b(!1,a)},a)}P.prototype.i=function(){if(this.a)return this.a.ta()};A("ydn.db.con.Storage.prototype.getType",P.prototype.i);function lh(a,b){Ee(function(){this.dispatchEvent(b)},1,a)}P.prototype.rc=function(){this.a&&(this.a.Ab(),this.a=null,G(this.e,this+" closed"))};A("ydn.db.con.Storage.prototype.close",P.prototype.rc);q=P.prototype;q.Rc=NaN;function mh(a){var b=a.h.shift();b&&(G(a.e,"pop tx queue["+(a.h.length+1)+"]"),a.ua(b.mb,b.Yc,b.mode,b.K));na()}
function nh(a,b,c,d,e){G(a.e,"push tx queue["+a.h.length+"]");a.h.push({mb:b,Yc:c,mode:d,K:e});100<a.h.length&&0==a.h.length%100&&E(a.e,"Transaction queue stack size is "+a.h.length+". It is too large, possibility due to incorrect usage.")}q.sb=!1;
q.ua=function(a,b,c,d){var e=b;if(x(b))e=[b];else if(null!=b)if(w(b)){if(0==b.length)throw new M("number of store names must more than 0");for(var f=0;f<b.length;f++)if(!x(b[f]))throw new M("store name at "+f+" must be string but found "+typeof b[f]);}else throw new M("store names must be an array");else e=null;if(this.a&&this.a.ab()&&!this.sb){var g=this,h=u(c)?c:J;h==nc&&(this.sb=!0);this.a.lb(function(b){a(b);a=null},e,h,function(a,b){fa(d)&&(d(a,b),d=void 0);h==nc&&(g.sb=!1);mh(g)})}else nh(this,
a,e,c,d)};q.Qb=function(a,b,c,d){if("ready"==a)te(this,a,b,c,d);else{var e="created error fail ready deleted updated".split(" "),f=function(a){if(!(0<=Ia(e,a)))throw new M('Invalid event type "'+a+'"');};if(w(a))for(var g=0;g<a.length;g++)f(a[g]);else f(a);P.u.Qb.call(this,a,b,c,d)}};q.toString=function(){return"Storage:"+this.a};function oh(a,b,c,d){this.d=a;this.e=b;this.a=Sa(c);this.b=d;this.c=[]}oh.prototype.d=null;function ph(a,b,c){if(a.d)c&&a.c.push(c),b(a.d);else throw new Ec("tx committed on ParallelTxExecutor");}oh.prototype.toString=function(){return"ParallelTxExecutor: txNo:"+this.e+" mode:"+this.b+" scopes:"+R(this.a)};function qh(a,b,c,d,e,f){this.j=a;this.e=b;this.a=this.Ma=0;this.vb=this.ha=null;this.c=d;this.d=e;this.b=c||"single";this.Hb=f||0}q=qh.prototype;q.Ma=0;q.Hb=0;q.ha=null;q.vb=null;q.la=H("ydn.db.tr.Parallel");q.gb=l("Ma");q.type=function(){return this.j.i()};
q.Gc=function(a,b){var c;if("multi"==this.b)a:if(c=this.ha,!c.a||!c.b||b!=c.b&&(c.b!=K||b!=J)||a.length>c.a.length)c=!1;else{for(var d=0;d<a.length;d++)if(-1==c.a.indexOf(a[d])){c=!1;break a}c=!0}else if("repeat"==this.b)a:if(c=this.ha,c.a&&c.b&&b==c.b&&c.a.length==a.length){for(d=0;d<a.length;d++)if(-1==c.a.indexOf(a[d])){c=!1;break a}c=!0}else c=!1;else c="all"==this.b?!0:!1;return c};
q.pa=function(a,b,c,d){function e(c){k.Ma++;n=new oh(c,k.Ma,b,h);g=k.F();$b(k.la,g+" BEGIN "+R(b)+" "+h);k.ha=n;ph(k.ha,a,d)}function f(a,b){$b(k.la,g+" "+a);if(n){for(var c=n,d=0;d<c.c.length;d++)c.c[d](a,b);c.c.length=0;c.d=null;c.a=null;c.c=null}k.a=0}var g;this.c&&(b=this.c);this.d&&(c=this.d);var h=u(c)?c:J,k=this,n;if(this.ha&&this.ha.d&&this.Gc(b,h))ph(this.ha,a,d);else{if(this.Hb&&this.Ma>=this.Hb)throw new Dc("Exceed maximum number of transactions of "+this.Hb);this.j.ua(e,b,h,f)}};
q.l=function(a,b,c,d){var e=new xf(a),f=this;this.pa(function(a){f.a++;yf(e,a,f.F()+"R"+f.a)},b,c||J,d);return e};q.ca=function(a,b,c,d,e){var f=this,g;this.pa(function(c){f.a++;g=f.F()+"R"+f.a;F(f.la,g+" BEGIN");b(c,g,function(b,d){f.vb=c;g=f.F()+"R"+f.a;d?(F(f.la,g+" ERROR"),a.t(b)):(F(f.la,g+" SUCCESS"),a.v(b));f.vb=null});b=null;F(f.la,g+" END")},c,d,e)};q.F=function(){return"B"+this.e+"T"+this.Ma};q.toString=function(){return"Parallel:"+this.b+":"+this.F()+(this.vb?"*":"")};function rh(a,b){qh.call(this,a,b,"single")}D(rh,qh);q=rh.prototype;q.la=H("ydn.db.tr.AtomicParallel");q.Gc=ba(!1);q.l=function(a,b,c){var d,e,f,g=this,h=rh.u.l.call(this,a,b,c,function(a,b){h.a=null;F(g.la,"transaction "+a);if(d)"complete"!=a&&(f=!0,e=b),d(e,f);else{var c=new od;T(h,c,!0)}});zf(h,function(a,b,c){f=b;e=a;d=c});return h};
q.ca=function(a,b,c,d,e){var f,g,h=new I;h.ea(function(a){g=!1;f=a},function(a){g=!0;f=a});rh.u.ca.call(this,h,b,c,d,function(b,c){if("complete"!=b)a.t(c);else if(!0===g)a.t(f);else if(!1===g)a.v(f);else{var d=new od;a.t(d)}e&&(e(b,c),e=void 0)})};q.toString=function(){return"Atomic"+rh.u.toString.call(this)};function sh(a,b,c){P.call(this,a,b,c);this.Ga=0;a=!0;b="single";c&&(u(c.isSerial)&&(a=!!c.isSerial),c.policy&&(b=c.policy));c=th(this,b,a);this.O=th(this,"atomic",!1);this.c=this.Fa(c,this.O)}D(sh,P);q=sh.prototype;q.Ga=0;q.Hc=function(a,b,c,d,e){var f;"readonly"==d?f=J:"readwrite"==d&&(f=K);a=th(this,a,b,c,f,e);return this.Fa(a,this.O)};q.Fa=function(a){return new If(this,this.b,a)};
function th(a,b,c,d,e,f){if(c){if("multi"==b||"repeat"==b||"all"==b||"single"==b)return new Df(a,a.Ga++,b,d,0,f);if("atomic"==b)return new Hf(a,a.Ga++);throw new M('Invalid requestType "'+b+'"');}if("multi"==b||"repeat"==b||"all"==b||"single"==b)return new qh(a,a.Ga++,b,d,e,f);if("atomic"==b)return new rh(a,a.Ga++);throw new M('Invalid requestType "'+b+'"');}
q.Wc=function(a,b,c){if(3<arguments.length)throw new M("too many input arguments, run accept not more than 3 input arguments, but "+arguments.length+" found.");this.Ga++;var d=b||Mf(this.b),e=J;if(c)if("readwrite"==c)e=K;else if("readonly"!=c)throw new M('Invalid transaction mode "'+c+'"');var f=th(this,"all",!1,d,e,1),g=this.Fa(f,this.O),h=new xf("run"),k=this;f.pa(function(b){G(k.e,"executing run in transaction on "+f);yf(h,b,f.F()+"R0");a(g)},d,e,function(a){h.a=null;T(h,f.gb(),"complete"!==a)});
return h};q.pd=function(){return this.c?this.c.d():NaN};sh.prototype.branch=sh.prototype.Hc;sh.prototype.run=sh.prototype.Wc;sh.prototype.getTxNo=sh.prototype.pd;If.prototype.getTxNo=If.prototype.d;function $(a,b,c){sh.call(this,a,b,c);a=this.b;for(b=0;b<a.a.length;b++){c=a.a[b];var d=W(a,c.getName());if(d){if(!Nf(d,"k"))throw new M('full text index store "'+d.getName()+'" must have "keyword" index');if(!Nf(d,"v"))throw new M('full text index store "'+d.getName()+'" must have "keyword" index');if("id"!=d.keyPath)throw new M('full text index store "'+d.getName()+'" must use "id" as key path.');}else throw new M('full text index store "'+c.getName()+'" required.');for(d=0;d<c.count();d++){var e=
c.index(d),f=W(a,e.a);if(f)E(this.e,"Full text indexer option for "+f.getName()+" ignored.");else throw new M('full text source store "'+e.a+'" does not exist for full text index "'+c.getName()+'"');}}}D($,sh);q=$.prototype;q.Fa=function(a){return new Jf(this,this.b,a)};
q.Xb=function(){var a=this.i();if("indexeddb"==a)return new Vd(this.d,this.b);if("websql"==a)return new mf(this.d,this.b);if("memory"==a||"localstorage"==a||"userdata"==a||"sessionstorage"==a)return new Pe(this.d,this.b);throw new hd("No executor for "+a);};q.Fb=function(a,b,c){return this.c.Fb(a,b,c)};q.count=function(a,b,c,d){return this.c.count(a,b,c,d)};q.Ka=function(a,b){return this.c.Ka(a,b)};q.keys=function(a,b,c,d,e,f){return this.c.keys(a,b,c,d,e,f)};
q.G=function(a,b,c,d,e,f){return this.c.G(a,b,c,d,e,f)};q.La=function(a,b,c){return this.c.La(a,b,c)};q.clear=function(a,b,c){return this.c.clear(a,b,c)};q.Gb=function(a,b,c){return this.c.Gb(a,b,c)};q.toString=function(){var a="Storage:"+this.getName();this.a&&this.a.ab()&&(a+=" ["+this.i()+"]");return a};function uh(a){this.a=a}uh.prototype.a=[];
uh.prototype.b=function(a,b){for(var c=[],d=0;d<this.a.length;d++){var e=this.a[d],f="'"===e[0]&&"'"===e[e.length-1];if('"'===e[0]&&'"'===e[e.length-1])e=Xa(a,Ba(e,'"').split(".")),c.push(e);else if(f)c.push(Ba(e,"'"));else if(x(e))if("true"===e)c.push(!0);else if("false"===e)c.push(!1);else if("Date"===e)c.push(new Date(parseInt(c.pop(),10)));else if("now"===e)c.push(new Date);else if("!"===e)c[c.length-1]=!c[c.length-1];else if("=="===e)c.push(c.pop()==c.pop());else if("==="===e)c.push(c.pop()===
c.pop());else if("!="===e)c.push(c.pop()!=c.pop());else if("!=="===e)c.push(c.pop()!==c.pop());else if("<="===e)c.push(c.pop()<=c.pop());else if("<"===e)c.push(c.pop()<c.pop());else if(">="===e)c.push(c.pop()>=c.pop());else if(">"===e)c.push(c.pop()>c.pop());else if("&"===e)c.push(c.pop()&c.pop());else if("|"===e)c.push(c.pop()|c.pop());else if("?"===e){var e=!!c.pop(),f=c.pop(),g=c.pop(),e=e?f:g;c.push(e)}else"+"===e?c.push(c.pop()+c.pop()):"-"===e?c.push(c.pop()-c.pop()):"*"===e?c.push(c.pop()*
c.pop()):"/"===e?c.push(c.pop()/c.pop()):"%"===e?c.push(c.pop()%c.pop()):"at"===e?(f=c.pop(),e=c.pop(),c.push(e[f])):"of"===e?(f=c.pop(),e=c.pop(),e=v(e)?e.indexOf(f):-1,c.push(e)):"in"===e?(f=c.pop(),e=c.pop(),e=v(e)?0<=e.indexOf(f):!1,c.push(e)):"abs"===e?c[c.length-1]=Math.abs(c[c.length-1]):"$"==e[0]&&/^\$\d$/.test(e)?(e=parseInt(e.match(/^\$(\d)$/)[1],10),c.push(arguments[e])):c.push(parseFloat(e));else c.push(e)}return c[0]};
uh.prototype.c=function(){return function(){var a=2<arguments.length?Array.prototype.slice(arguments,2):void 0;return uh.prototype.b.apply(null,a)}};uh.prototype.toJSON=function(){return{Tokens:Td(R(this.a))}};function vh(a,b,c){$.call(this,a,b,c)}D(vh,$);q=vh.prototype;q.Xb=function(){var a=this.i();if("indexeddb"==a)return new Xd(this.d,this.b);if("websql"==a)return new vf(this.d,this.b);if("memory"==a||"userdata"==a||"localstorage"==a||"sessionstorage"==a)return new Ze(this.d,this.b);throw new hd("No executor for "+a);};q.Fa=function(a){return new Zf(this,this.b,a)};q.md=function(a,b,c){return this.c.Bc(a,b,c)};q.nd=function(a,b){return this.c.Cc(a,b)};q.map=function(a,b){return this.c.map(a,b)};
q.Db=function(a,b,c){return this.c.Db(a,b,c)};function wh(a){if(!x(a))throw new ud;this.L=a;xh(this,a);this.Ya=""}q=wh.prototype;q.L="";q.Za=J;q.pc=NaN;q.uc=NaN;q.fc=!1;q.Ya="";
function xh(a,b){var c=b.split(/\sFROM\s/i);if(2!=c.length)throw new nd("FROM required.");var d=c[1],c=c[0].match(/\s*?(SELECT|INSERT|UPDATE|DELETE)\s+(.*)/i);if(3!=c.length)throw new nd("Unable to parse: "+b);a.c=c[1].toUpperCase();if("SELECT"==a.c)a.Za=J;else if("INSERT"==a.c)a.Za=K;else if("UPDATE"==a.c)a.Za=K;else if("DELETE"==a.c)a.Za=K;else throw new nd("Unknown SQL verb: "+a.c);var c=c[2].trim(),e=c.match(/^(MIN|MAX|COUNT|AVG|SUM)/i);e?(a.d=e[0].toUpperCase(),c=c.replace(/^(MIN|MAX|COUNT|AVG|SUM)/i,
"").trim()):a.d=void 0;"("==c.charAt(0)&&(")"==c.charAt(c.length-1)?c=c.substring(1,c.length-1):new nd("missing closing parentheses"));a.i=c;c=d.search(/(ORDER BY|LIMIT|OFFSET)/i);0<c?(a.a=d.substring(c),d=d.substring(0,c)):a.a="";c=d.search(/WHERE/i);0<c?(a.e=d.substring(c+6).trim(),d=d.substring(0,c)):a.e="";a.b=d.trim().split(",").map(function(a){a=Ba(a,'"');a=Ba(a,"'");return a.trim()})}
function yh(a,b){if(b){for(var c=0;c<b.length;c++)a.L=a.L.replace("?",b[c]);xh(a,a.L)}a.g=zh(a);if(!a.g)return a.Ya;var c=a.a.length,d=/OFFSET\s+(\d+)/i.exec(a.a);d&&(a.uc=parseInt(d[1],10),c=a.a.search(/OFFSET/i));if(d=/LIMIT\s+(\d+)/i.exec(a.a))a.pc=parseInt(d[1],10),d=a.a.search(/LIMIT/i),d<c&&(c=d);(c=/ORDER BY\s+(.+)/i.exec(a.a.substr(0,c)))?(c=c[1].trim(),(d=c.match(/(ASC|DESC)/i))?(a.fc="DESC"==d[0].toUpperCase(),c=c.replace(/\s+(ASC|DESC)/i,"")):a.fc=!1,a.h=Ba(Ba(c,'"'),"'")):a.h=void 0;return""}
function Ah(a){if("*"==a.i)return null;a=a.i.split(",");return a=a.map(function(a){return Ba(a.trim(),'"')})}q.toJSON=function(){return{sql:this.L}};
function zh(a){function b(a){return Pa(c,function(b){return b.sa==a})}var c=[],d=/(.+?)(<=|>=|=|>|<)(.+)/i;if(0<a.e.length)for(var e=a.e.split("AND"),f=0;f<e.length;f++){var g=e[f],h=d.exec(g);if(h){var k=h[1].trim(),k=Ba(k,'"'),k=Ba(k,"'");if(0<k.length){var n=h[3].trim(),n=0==n.lastIndexOf('"',0)?Ba(n,'"'):0==n.lastIndexOf("'",0)?Ba(n,"'"):parseFloat(n),h=new Xc(k,h[2],n),k=b(k);if(0<=k){if(c[k]=c[k].Lb(h),!c[k])return a.Ya='where clause "'+g+'" conflict',null}else c.push(h)}else return a.Ya='Invalid clause "'+
g+'"',null}else return a.Ya='Invalid clause "'+g+'"',null}return c}q.toString=function(){return"query:"+this.L};function Bh(a,b){this.sql=b;this.a=a}Bh.prototype.b=H("ydn.db.sql.req.nosql.Node");Bh.prototype.toJSON=function(){return{sql:this.sql}};Bh.prototype.toString=ba("idb.Node:");
Bh.prototype.ic=function(a,b){var c=Sa(this.sql.b)[0],d=this.sql.g,e=this.sql.pc,e=isNaN(e)?100:e,f=this.sql.uc,f=isNaN(f)?0:f,g=this.sql.h,h=Ah(this.sql),k=null,n=this.sql.fc;if(0==d.length)k=null;else if(1==d.length)k=Qc(d[0].a);else throw new Bc("too many conditions.");null===h||zf(a,function(a,b,c){var d=a;b||(d=a.map(function(a){var b=h.length;if(1==b)return qc(a,h[0]);for(var c={},d=0;d<b;d++)c[h[d]]=qc(a,h[d]);return c}));c(d,b)});var d=0<d.length?d[0].sa:void 0,m=V(a)+" executing on"+c;d&&
(m+=":"+d);m+=" "+Tc(k);F(this.b,m);g&&g!=this.a.keyPath?b.Ta(a,c,g,k,n,e,f,!1):u(d)&&d!=this.a.keyPath?b.Ta(a,c,d,k,n,e,f,!1):b.tb(a,c,k,n,e,f)};function Ch(a,b){Bh.call(this,a,b)}D(Ch,Bh);
Ch.prototype.ic=function(a,b){var c,d=Sa(this.sql.b)[0],e=this.sql.g,f=null;if(0==e.length)f=null;else if(1==e.length)f=Qc(e[0].a);else throw new Bc("too many conditions.");var g=this.sql.d,e=0<e.length?e[0].sa:void 0,h=V(a)+" executing "+g+" on "+d;e&&(h+=":"+e);h+=" "+Tc(f);F(this.b,h);if("COUNT"==g)f?b.za(a,d,f,e,!1):b.za(a,d,null,void 0,!1);else{var k,h=Ah(this.sql);if(!h||0==h.length)throw new dd("field name require for reduce operation: "+g);h=h[0];if("MIN"==g)k=Dh(h);else if("MAX"==g)k=Eh(h);
else if("AVG"==g)c=0,k=Fh(h);else if("SUM"==g)c=0,k=Gh(h);else throw new Kd(g);var n;n=u(e)?new ad(d,e,f):new $c(d,f);var m=bd(n,a.a,V(a),b);m.e=function(b){T(a,b,!0)};var p=0;m.d=function(b){null!=b?(c=k(n.b?m.T():m.ja(),c,p),m.advance(1),p++):T(a,c)}}};function Fh(a){return function(b,c,d){u(c)||(c=0);return(c*d+b[a])/(d+1)}}function Gh(a){return function(b,c){return c+b[a]}}function Dh(a){return function(b,c){var d=b[a];return u(c)?c<d?c:d:d}}
function Eh(a){return function(b,c){var d=b[a];return u(c)?c>d?c:d:d}};function Hh(a,b){qd.call(this,a,b)}D(Hh,Xd);Hh.prototype.f=H("ydn.db.sql.req.IndexedDb");Hh.prototype.executeSql=function(a,b,c){if(c=yh(b,c))throw new nd(c);c=Sa(b.b);if(1==c.length){var d=W(this.a,c[0]);if(!d)throw new kd(c[0]);var e=Ah(b);if(e)for(var f=0;f<e.length;f++)if(!Nf(d,e[f]))throw new kd('Index "'+e[f]+'" not found in '+c[0]);(b.d?new Ch(d,b):new Bh(d,b)).ic(a,this)}else throw new Kd(b.L);};function Ih(a,b){this.sql=b;this.c=a;this.a=Ah(b)}Ih.prototype.b=H("ydn.db.sql.req.websql.Node");Ih.prototype.toJSON=function(){return{sql:this.sql.L}};Ih.prototype.toString=ba("websql.Node:");function Jh(a,b){if(a.a){if(1==a.a.length){if(z(b))return Xa(b,a.a[0]);return}for(var c={},d=0;d<a.a.length;d++)c[a.a[d]]=Xa(b,a.a[d]);return c}return cf(b,a.c)}
Ih.prototype.Fc=function(a,b,c){var d=this,e=[];b.executeSql(this.sql.L,c,function(b,c){for(var h=c.rows.length,k=0;k<h;k++){var n=c.rows.item(k);if(z(n))var m=Jh(d,n);e.push(m)}a(e)},function(b,c){E(d.b,"Sqlite error: "+c.message);a(c,!0);return!0})};function Lh(a,b){Ih.call(this,a,b)}D(Lh,Ih);Lh.prototype.Fc=function(a,b,c){var d=this;b.executeSql(this.sql.L,c,function(b,c){var d=c.rows.length;if(1==d)d=uf(c.rows.item(0)),a(d);else if(0==d)a(void 0);else throw new hd;},function(b,c){E(d.b,"Sqlite error: "+c.message);a(c,!0);return!0})};function Mh(a,b){qd.call(this,a,b)}D(Mh,vf);Mh.prototype.f=H("ydn.db.sql.req.WebSql");Mh.prototype.executeSql=function(a,b,c){var d=Sa(b.b);if(1==d.length){var e=W(this.a,d[0]);if(!e)throw new kd(d[0]);var f=Ah(b);if(f)for(var g=0;g<f.length;g++)if(!Nf(e,f[g]))throw new kd('Index "'+f[g]+'" not found in '+d[0]);(b.d?new Lh(e,b):new Ih(e,b)).Fc(function(b,c){T(a,b,c)},a.a,c)}else throw new Kd(b.L);};function Nh(a,b){qd.call(this,a,b)}D(Nh,Ze);Nh.prototype.f=H("ydn.db.sql.req.SimpleStore");Nh.prototype.executeSql=function(a,b,c){if(c=yh(b,c))throw new nd(c);c=Sa(b.b);if(1==c.length){var d=W(this.a,c[0]);if(!d)throw new kd(c[0]);var e=Ah(b);if(e)for(var f=0;f<e.length;f++)if(!Nf(d,e[f]))throw new M('Index "'+e[f]+'" not found in '+c[0]);(b.d?new Ch(d,b):new Bh(d,b)).ic(a,this)}else throw new Bc(b.L);};function Oh(a,b,c){If.call(this,a,b,c)}D(Oh,Zf);Oh.prototype.executeSql=function(a,b){for(var c=new wh(a),d=Sa(c.b),e=0;e<d.length;e++){var f=W(this.b,d[e]);if(!f)throw new M("store: "+f+" not exists.");}F(this.k,"executeSql: "+a+" params: "+b);var g=this.a.l("sql",Sa(c.b),c.Za);Y(g,function(){Z(this).executeSql(g,c,b||[])},this);return g};function Ph(a,b,c){$.call(this,a,b,c)}D(Ph,vh);Ph.prototype.Xb=function(){var a=this.i();if("indexeddb"==a)return new Hh(this.d,this.b);if("websql"==a)return new Mh(this.d,this.b);if("memory"==a||"localstorage"==a||"userdata"==a||"sessionstorage"==a)return new Nh(this.d,this.b);throw new hd("No executor for "+a);};Ph.prototype.Fa=function(a){return new Oh(this,this.b,a)};Ph.prototype.executeSql=function(a,b){return this.c.executeSql(a,b)};function Qh(a,b,c){$.call(this,a,b,c)}D(Qh,Ph);P.prototype.getType=P.prototype.i;P.prototype.setName=P.prototype.w;P.prototype.getName=P.prototype.getName;P.prototype.getSchema=P.prototype.Xc;P.prototype.transaction=P.prototype.ua;P.prototype.close=P.prototype.rc;A("ydn.db.version","0.7.16");A("ydn.db.cmp",L);A("ydn.db.deleteDatabase",function(a,b){pc&&((!b||"indexeddb"==b)&&pc&&"deleteDatabase"in pc)&&pc.deleteDatabase(a);!fa(r.openDatabase)||b&&"websql"!=b||hh(a);b&&"localstorage"!=b||$g(a);b&&"sessionstorage"!=b||bh(a)});
ag.prototype.name=ag.prototype.name;ag.prototype.getVersion=ag.prototype.od;ag.prototype.getOldVersion=ag.prototype.Oc;ag.prototype.getOldSchema=ag.prototype.Nc;bg.prototype.getError=bg.prototype.g;xf.prototype.abort=xf.prototype.kd;xf.prototype.canAbort=xf.prototype.Lc;xf.prototype.progress=xf.prototype.ld;vh.prototype.scan=vh.prototype.nd;vh.prototype.map=vh.prototype.map;vh.prototype.reduce=vh.prototype.Db;vh.prototype.open=vh.prototype.md;Zf.prototype.scan=Zf.prototype.Cc;Zf.prototype.map=Zf.prototype.map;Zf.prototype.reduce=Zf.prototype.Db;Zf.prototype.open=Zf.prototype.Bc;Hc.prototype.getKey=Hc.prototype.zc;Hc.prototype.getPrimaryKey=Hc.prototype.T;Hc.prototype.getValue=Hc.prototype.ja;Hc.prototype.update=Hc.prototype.update;Hc.prototype.clear=Hc.prototype.clear;A("ydn.math.Expression",uh);
uh.prototype.evaluate=uh.prototype.b;uh.prototype.compile=uh.prototype.c;uh.parseRpn=function(a){return new uh(a.match(/[^\s"']+|"[^"]*"|'[^']*'/g))};uh.parseInfix=function(){throw new Cd("Too lazy to learn Dutch in Shunting Yard station, we speak Polish here.");};A("ydn.db.Iterator",O);A("ydn.db.KeyCursors",Yc);A("ydn.db.ValueCursors",$c);A("ydn.db.Cursors",Zc);A("ydn.db.IndexValueCursors",ad);O.prototype.count=O.prototype.count;O.prototype.getState=O.prototype.nc;O.prototype.getKeyRange=O.prototype.ad;
O.prototype.getIndexName=O.prototype.W;O.prototype.getStoreName=O.prototype.cd;O.prototype.isReversed=O.prototype.zb;O.prototype.isUnique=O.prototype.Wa;O.prototype.isKeyIterator=O.prototype.dd;O.prototype.isIndexIterator=O.prototype.Pc;O.prototype.getPrimaryKey=O.prototype.bd;O.prototype.getKey=O.prototype.$c;O.prototype.resume=O.prototype.Vc;O.prototype.reset=O.prototype.fd;O.prototype.reverse=O.prototype.gd;Yc.where=function(a,b,c,d,e){return new Yc(a,Wc(b,c,d,e))};
$c.where=function(a,b,c,d,e){return new $c(a,Wc(b,c,d,e))};Zc.where=function(a,b,c,d,e,f){return new Zc(a,b,Wc(c,d,e,f))};ad.where=function(a,b,c,d,e,f){return new ad(a,b,Wc(c,d,e,f))};A("ydn.db.Streamer",Ad);Ad.prototype.push=Ad.prototype.push;Ad.prototype.collect=Ad.prototype.fa;Ad.prototype.setSink=Ad.prototype.Zc;$.prototype.branch=$.prototype.Hc;$.prototype.add=$.prototype.Fb;$.prototype.get=$.prototype.Ka;$.prototype.values=$.prototype.G;$.prototype.put=$.prototype.La;$.prototype.clear=$.prototype.clear;$.prototype.remove=$.prototype.Gb;$.prototype.count=$.prototype.count;Jf.prototype.add=Jf.prototype.Fb;Jf.prototype.get=Jf.prototype.Ka;Jf.prototype.values=Jf.prototype.G;Jf.prototype.put=Jf.prototype.La;Jf.prototype.clear=Jf.prototype.clear;Jf.prototype.remove=Jf.prototype.Gb;Jf.prototype.count=Jf.prototype.count;
A("ydn.db.Key",pd);pd.prototype.id=pd.prototype.Mc;pd.prototype.parent=pd.prototype.hd;pd.prototype.storeName=pd.prototype.jd;A("ydn.db.KeyRange",N);N.upperBound=N.upperBound;N.lowerBound=N.lowerBound;N.bound=N.bound;N.only=N.only;N.starts=Pc;$f.prototype.store_name=$f.prototype.c;$f.prototype.getStoreName=$f.prototype.e;Vf.prototype.name=Vf.prototype.name;Vf.prototype.getKey=Vf.prototype.g;Vf.prototype.getValue=Vf.prototype.h;Sf.prototype.name=Sf.prototype.name;Sf.prototype.getKeys=Sf.prototype.na;
Sf.prototype.getValues=Sf.prototype.pb;Ph.prototype.executeSql=Ph.prototype.executeSql;Oh.prototype.executeSql=Oh.prototype.executeSql;A("ydn.db.Storage",Qh);var Rh=new function(){this.a=na()};function Sh(a){this.d=a||"";this.e=Rh}Sh.prototype.a=!0;Sh.prototype.b=!1;function Th(a){a=new Date(a.g);return Uh(a.getFullYear()-2E3)+Uh(a.getMonth()+1)+Uh(a.getDate())+" "+Uh(a.getHours())+":"+Uh(a.getMinutes())+":"+Uh(a.getSeconds())+"."+Uh(Math.floor(a.getMilliseconds()/10))}function Uh(a){return 10>a?"0"+a:String(a)}function Vh(a,b){var c=(a.g-b)/1E3,d=c.toFixed(3),e=0;if(1>c)e=2;else for(;100>c;)e++,c*=10;for(;0<e--;)d=" "+d;return d}function Wh(a){Sh.call(this,a)}D(Wh,Sh);Wh.prototype.b=!0;
Wh.prototype.c=function(a){var b;switch(a.e.value){case Ob.value:b="dbg-sh";break;case Pb.value:b="dbg-sev";break;case Qb.value:b="dbg-w";break;case Rb.value:b="dbg-i";break;default:b="dbg-f"}var c=[];c.push(this.d," ");this.a&&c.push("[",Th(a),"] ");c.push("[",Aa(Vh(a,this.e.a)),"s] ");c.push("[",sa(a.c),"] ");c.push('<span class="',b,'">',ra(Aa(sa(a.d))));this.b&&a.b&&c.push("<br>",ra(Aa(a.a||"")));c.push("</span><br>");return c.join("")};function Xh(a){Sh.call(this,a)}D(Xh,Sh);
Xh.prototype.c=function(a){var b=[];b.push(this.d," ");this.a&&b.push("[",Th(a),"] ");b.push("[",Vh(a,this.e.a),"s] ");b.push("[",a.c,"] ");b.push(a.d,"\n");this.b&&a.b&&b.push(a.a,"\n");return b.join("")};function Yh(){this.e=la(this.g,this);this.a=new Xh;this.a.a=!1;this.b=this.a.b=!1;this.c="";this.d={}}Yh.prototype.g=function(a){if(!this.d[a.c]){var b=this.a.c(a),c=Zh;if(c)switch(a.e){case Ob:$h(c,"info",b);break;case Pb:$h(c,"error",b);break;case Qb:$h(c,"warn",b);break;default:$h(c,"debug",b)}else window.opera?window.opera.postError(b):this.c+=b}};var Zh=window.console;function $h(a,b,c){if(a[b])a[b](c);else a.log(c)};var ai,bi=!pb||pb&&9<=Db;!qb&&!pb||pb&&pb&&9<=Db||qb&&Bb("1.9.1");pb&&Bb("9");function ci(a,b){var c;c=a.className;c=x(c)&&c.match(/\S+/g)||[];for(var d=Ta(arguments,1),e=c.length+d.length,f=c,g=0;g<d.length;g++)0<=Ia(f,d[g])||f.push(d[g]);a.className=c.join(" ");return c.length==e};function di(a,b){Wa(b,function(b,d){"style"==d?a.style.cssText=b:"class"==d?a.className=b:"for"==d?a.htmlFor=b:d in ei?a.setAttribute(ei[d],b):0==d.lastIndexOf("aria-",0)||0==d.lastIndexOf("data-",0)?a.setAttribute(d,b):a[d]=b})}var ei={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};
function fi(a,b,c){function d(c){c&&b.appendChild(x(c)?a.createTextNode(c):c)}for(var e=2;e<c.length;e++){var f=c[e];!w(f)||z(f)&&0<f.nodeType?d(f):Ja(gi(f)?Sa(f):f,d)}}function gi(a){if(a&&"number"==typeof a.length){if(z(a))return"function"==typeof a.item||"string"==typeof a.item;if(fa(a))return"function"==typeof a.item}return!1}function hi(a){this.a=a||r.document||document}
function ii(a,b){var c;c=a.a;var d=b&&"*"!=b?b.toUpperCase():"";c.querySelectorAll&&c.querySelector&&d?c=c.querySelectorAll(d+""):c=c.getElementsByTagName(d||"*");return c}
hi.prototype.b=function(a,b,c){var d=this.a,e=arguments,f=e[0],g=e[1];if(!bi&&g&&(g.name||g.type)){f=["<",f];g.name&&f.push(' name="',sa(g.name),'"');if(g.type){f.push(' type="',sa(g.type),'"');var h={};Za(h,g);delete h.type;g=h}f.push(">");f=f.join("")}f=d.createElement(f);g&&(x(g)?f.className=g:v(g)?ci.apply(null,[f].concat(g)):di(f,g));2<e.length&&fi(d,f,e);return f};
hi.prototype.contains=function(a,b){if(a.contains&&1==b.nodeType)return a==b||a.contains(b);if("undefined"!=typeof a.compareDocumentPosition)return a==b||Boolean(a.compareDocumentPosition(b)&16);for(;b&&a!=b;)b=b.parentNode;return b==a};function ji(a){this.e=la(this.g,this);this.b=new Wh;this.c=this.b.a=!1;this.a=a;this.d=this.a.ownerDocument||this.a.document;var b=(a=this.a)?new hi(9==a.nodeType?a:a.ownerDocument||a.document):ai||(ai=new hi),c=null;pb?(a=c=b.a.createStyleSheet(),pb?a.cssText=".dbg-sev{color:#F00}.dbg-w{color:#C40}.dbg-sh{font-weight:bold;color:#000}.dbg-i{color:#444}.dbg-f{color:#999}.dbg-ev{color:#0A0}.dbg-m{color:#990}.logmsg{border-bottom:1px solid #CCC;padding:2px}.logsep{background-color: #8C8;}.logdiv{border:1px solid #CCC;background-color:#FCFCFC;font:medium monospace}":
a.innerHTML=".dbg-sev{color:#F00}.dbg-w{color:#C40}.dbg-sh{font-weight:bold;color:#000}.dbg-i{color:#444}.dbg-f{color:#999}.dbg-ev{color:#0A0}.dbg-m{color:#990}.logmsg{border-bottom:1px solid #CCC;padding:2px}.logsep{background-color: #8C8;}.logdiv{border:1px solid #CCC;background-color:#FCFCFC;font:medium monospace}"):(a=ii(b,"head")[0],a||(c=ii(b,"body")[0],a=b.b("head"),c.parentNode.insertBefore(a,c)),b=c=b.b("style"),pb?b.cssText=".dbg-sev{color:#F00}.dbg-w{color:#C40}.dbg-sh{font-weight:bold;color:#000}.dbg-i{color:#444}.dbg-f{color:#999}.dbg-ev{color:#0A0}.dbg-m{color:#990}.logmsg{border-bottom:1px solid #CCC;padding:2px}.logsep{background-color: #8C8;}.logdiv{border:1px solid #CCC;background-color:#FCFCFC;font:medium monospace}":
b.innerHTML=".dbg-sev{color:#F00}.dbg-w{color:#C40}.dbg-sh{font-weight:bold;color:#000}.dbg-i{color:#444}.dbg-f{color:#999}.dbg-ev{color:#0A0}.dbg-m{color:#990}.logmsg{border-bottom:1px solid #CCC;padding:2px}.logsep{background-color: #8C8;}.logdiv{border:1px solid #CCC;background-color:#FCFCFC;font:medium monospace}",a.appendChild(c));this.a.className+=" logdiv"}
ji.prototype.g=function(a){var b=100>=this.a.scrollHeight-this.a.scrollTop-this.a.clientHeight,c=this.d.createElement("div");c.className="logmsg";c.innerHTML=this.b.c(a);this.a.appendChild(c);b&&(this.a.scrollTop=this.a.scrollHeight)};ji.prototype.clear=function(){this.a.innerHTML=""};var ki=null,li=null;H("ydn.debug");A("ydn.debug.log",function(a,b,c){if(y(b))b=new Nb("log",b);else if(x(b)){b=b.toUpperCase();if(!Xb){Xb={};for(var d=0,e;e=Wb[d];d++)Xb[e.value]=e,Xb[e.name]=e}b=Xb[b]||null}else b=Tb;H(a||"ydn").b=b;u(c)?li||(a=li=new ji(c),!0!=a.c&&(c=dc(),b=a.e,c.a||(c.a=[]),c.a.push(b),a.c=!0),dc().b=Qb):ki||li||(a=ki=new Yh,!0!=a.b&&(c=dc(),b=a.e,c.a||(c.a=[]),c.a.push(b),a.b=!0),dc().b=Qb)});function mi(a,b){Hd.call(this,a,b)}D(mi,Hd);mi.prototype.b=ba(!1);mi.prototype.c=function(a,b){function c(b){u(a[b])?(e=!1,d[b]=!0):(d[b]=!1,0<=b-1&&c(b-1))}var d=[],e=!0;c(a.length-1);e&&(d=[]);return Id(this,d,b)};function ni(a,b){Hd.call(this,a,b)}D(ni,Hd);ni.prototype.b=ba(!1);ni.prototype.c=function(a,b){var c=[],d=b[0];if(null==d)return[];for(var e=!0,f=!1,g=d,h=[],k=1;k<a.length;k++)if(null!=b[k]){var n=L(d,b[k]);h[k]=n;1===n?e=!1:-1===n&&(e=!1,f=!0,1===L(b[k],g)&&(g=b[k]))}else e=!1,f=!0;if(e)for(f=0;f<a.length;f++)null!=b[f]&&(c[f]=!0);else if(f)for(f=0;f<a.length;f++)null!=b[f]&&1===L(g,b[f])&&(c[f]=g);else for(f=1;f<a.length;f++)1===h[f]&&(c[f]=d);return e?(this.e++,this.a&&this.a.push(g),c):{continuePrimary:c}};function oi(a,b){Hd.call(this,a,b);this.d=a instanceof Ad&&!!a.Ha}D(oi,Hd);oi.prototype.h=H("ydn.db.algo.ZigzagMerge");oi.prototype.d=!1;oi.prototype.b=function(a,b){var c=oi.u.b.call(this,a,b);if(this.d){var d=a[0].W().split(", ");if(1<d.length){if(d[d.length-1]!=this.a.Ha)throw new dd("Output streamer projection field must be same as postfix field in the iterator");}else E(this.h,"Unable to check correctness of output streamer.")}return c};
oi.prototype.c=function(a,b){function c(a,b){var c=a.slice(0,a.length-1);c.push(b);return c}var d=[];if(0==a.length||null==a[0]||null==a[0])return[];for(var e=!0,f=0,g=a[f][a[f].length-1],h=[],k=1;k<a.length;k++)if(null!=a[k]){var n=a[k][a[k].length-1],m=L(g,n);h[k]=m;1===m?e=!1:-1===m&&(e=!1,g=n,f=1)}else return[];if(e){for(e=0;e<a.length;e++)null!=a[e]&&(d[e]=!0);this.a&&(this.d?this.a.push(b[0],g):this.a.push(b[0]));return d}if(0==f)for(e=1;e<a.length;e++)1===h[e]&&(d[e]=c(a[e],g));else for(e=
0;e<a.length;e++)e!=f&&null!=a[e]&&1===L(g,a[e][a[e].length-1])&&(d[e]=c(a[e],g));return{"continue":d}};A("ydn.db.algo.NestedLoop",mi);A("ydn.db.algo.ZigzagMerge",oi);A("ydn.db.algo.SortedMerge",ni);})();

            //# sourceMappingURL=zsj-ydn.db-dev.js.map
        

            })();
        